// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xbf16>, tensor<20x20xbf16>)
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.add %0#0, %0#1 : tensor<20x20xbf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xbf16>, tensor<20x20xbf16>) {
    %0 = stablehlo.constant dense<"0x814097BE733F06402EC024C02740D3BF1BC0173F40C0813F4E3F923E17C048C048C08F40303F14C0AF40F6BF3D40223FD0C01DBFE2BFB640873EA240A440F13F57BF4E40403D0F4077BFEC3FA23F6D40AFC07740C8BFE8C0FABFADBF63C02CC00AC03EC0DB3F02C1A740154088C029C08040B53FB83F5C3FBB3F0FC0F53EAFC08CBFD93F1B40FEBFB2BF71C053C025407FBFB7BFC6BE66C003BF60400BC007C079BECB3FFC3F92BF6EC0B43F24BFD8BF4ABFC6409B3F83C0B33F4D3F924056BE503E72C0713EE93F0F404E40DA3EB740B640EB3F0FC0A6C0A3BF1B40A9BF94402DC038BF86400B40933E8D40613FC73F1F40AFBF6BC075C0EFBE2E40633FACC017C01D406CC02C4096BF30C08F40D53FDC3FFDC032C082C094C03CBF8840044007BF604008BF04408C4007BF5A3F27C049C048BF47C0C9BF8E40D33F0C3DD5BF7640F8BFFC3F3240BB3F4240C54061C0733E1F4192BF52BF53BEA23D674006C096C092BFA54045C0184032409A3F20BE1F403BC067BFB640CEBF9CBF68BF5F40C4BF1A4016C0A7BF32BFA83FB3BE04C08540443FA13E25C0DA3F793D044188C00640174060C06C40E4409B4048BF6BC04E3D27401C3FC53F73BF094097BF0B3FD2BF963F17C1553FC33EF5BE19BF63BF7BC0E9BF3D4096C00CC014C0C23F8440303F16C02CC09940C6BF47C0283E6E4006407FC0DE409040254087C00240A63F9540CCC0894098405ABF1B3F95C0ED3E8AC006C08D3F8EBFE5BF0AC16BBD88406F404C4032C047C0BBBE5B40B93F1AC0063F314015C00C4007C0873EDF3F88BEF33E313F983C3B3FAC3F41BF2040CE40C44032BF673EBFC038BF51BE0B40194042404B40BFBF8740A840583F58407FC06340ACC0BD3F9640FEBF3FC0D4C01BC05FBF4940DBBF3C3F69405240DA3F47BF53C00F3FD93F5F40C74058C0FDBF4C405BC05B40ADC099C047C0DDC0FD3F43405640E03FD8C08840B9C014C04F3F36C058C0A8BFB83F2AC0C5BE8040CAC0B6408B3F4FBDB340C440963EE83FA53F983FE1BE1B41CCC058402FC0E1BF533F3AC097404640E53F8FC096C03C3FDBBF9340B13F943F0CC033401E3FBE3FAF3F6940AFC081C006403EC062C0C1BFBCBF1840"> : tensor<20x20xbf16>
    %1 = stablehlo.constant dense<"0xBDBF35BF683E84BF353E3A40F33EC83FCCC094BF84C0063FEC3FB2C0403E47BF25403CC09EBED6BF903F73C025BFAAC089BF1840BABF2A40673F29C084C07C3F78402AC004C0953FB7BDE7BF0F40A03FC2BF513F1EC0AA3FBBC04940A63F053F7EBFB1BC333F8EC0033F9740BB40CABF193E05C0AE3F3740B6BF4F3B6BC01C3F0DBF8F4052409FC0053F973E3C4067405D40B4BF9A3F3EC083C0C2C01840CABECDC0323FD8C03640B63ECD40A6408BBF0A40373E8BC0194070C07FC083BFA8BD79C002C03E4043403640E3BFFFBF3240ECBFAE3F4EC0663F9CC09FC02940FE3F88C0AAC025BF4F3F05C00D3FBC3FD3BE543FD2BEAD3E24C0AFBF7F3EF640C03FB83F9E3F85BFA7C03340E3BF784032C03ABFBD3F4440DBBEB4C013403BBFADBF85BEB23F26C047C027C03EC04B408F3EBBBE6BC006C0F1C08E3F1ABEB9BF5A403C40B2BFE53F124030BFF03F8540653F54C0DABE3340F33E8E4019C009403AC0014050C090404E4094BFE9BFDB3DC140514026C0894005C01EC0A94010BFBC3F064098C063C069BE82BF26BFDBC019C0C240C6BFCF3F4F40F6BF2CBF68BF564097C0BAC00BC09ABE47C08B40C54071BEA0BFAC40C1BF3BBF5EC0B8C0173F0940B83FC23FA03FF23FBE40F63F30401B40ABC05B3F88403840D23F9BC0023FF03DBABF3F40E43FA340F53E70C078C0873FC4404BC0E840044006BEA1BF8D40963F953FCCBFC43E353E4E402FBF4BC0E03F91C0373EE8BFA1C02DBF32BF2C4030C0AB3EA1C001402A3F80404A40753F1B40FD3E9DBFF3BF5640F2BFBCBFB03F6A405FBE08C0C23E94C0863FEE3D9E3F0D4060409F407AC06D3F22C0E8BFCD3F5AC0D6BF0440D83F53C097405D3F9B4095C0C03E6DBF9EBE38C0CCBFDC3F593E6DC078408EC0364014416C40A93F584001C04040AF3F913FA5BF1CC0E4C07ABEA340514074BF06C09E400EC0493FCEBE6140E6BF3EC001C175BF3C406C40D13FA43FA5BC17C05CC0B5BFA2402BC0A63F04C0804037409BC0CB3FADBED13FB5BF73BF6CC07BBE81402BC079408F400E4043402440E83FD03FE5BD7EC0A2C03E3E47C08540614057BF4E40683F7FBF27C0803DB9BFABBFEF4074BFC83F9E40953F11C0"> : tensor<20x20xbf16>
    return %0, %1 : tensor<20x20xbf16>, tensor<20x20xbf16>
  }
  func.func private @expected() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0x244080BF963F883F23C0B03E4540B0BD0DC111BFE4C0C43F2A40A9C00BC07AC00CBFC43FC23E7FC0D340B7C0144096C0F2C0E23F4EC00641953F1B40803F38404240103F01C05A4087BF203D60409E40E0C0964081C0BEC0FAC0E53F10C00BC04AC03FC01A4049C1B740E240CC3F87C085402ABF33406E40203D0FC04CC09CC0D2BFC540B640DEC05FBF5EC0B8BEC6401D4036C0513FD2C093C024C0503E20C0D5C0124099C0DA3F57C0FA40924032C0AF3FCC4048C0DABF16C04CC0624095BE6CC0BAC04D409C40A240B93FC8BF084176404C40AEC089C0C5C023C0A93FD440DEC0C1C063403F40E5BF9F401640923F5440E4BF55C0CCC0EBBF3E40094178C06CBF6C4097C022C0D03F91C006418FBF7E3FCEC0903E90C024C1C83F6140363F4ABF9C4048C086BFE23F60C0814015C060C08EC0A6C012C1B240C03FB5BFDF3FD94055C07040A240463F9D40254128C045C01841D43FB1BE874014C0B840A0C02BC08CC01A41103E9C3F763FA83FBC40B840B0C05840674082C08240BCBF9E40103F16C0BCC0C4BFDBBF2A3FE6C08EC0244148BFF73F283F60BE1CBFEB4068BF28C05DC0B6C0594080401341AC407AC09ABF004166BF4F3F8DC067C017BF2C4050BE2C4003C12E40CA40B93F0A40C43F14C177BFE640E8BF0CBFE5C00240884044BF243F68BF1E4189BFDCC06EC099400441E5C06341D2401D40AFC0CE401E40BA40FFC095409E401840A0BDFAC00E400EC1F5BF36BFC4C01EC015C12840C03F8240ECBF44BF1CC06940D2401A40803C823FC53F87C0B14080C09ABF48405940843EB8BFCC3E79C0194023BF6F400A411A4189406CC0A1C050C001C0724082BFAE3FA840483E6C3F2041DA3F04410AC17B40CAC0963FE83F65C0A2BFCDC0C4C04040A6BF913F2041EA409340A24033C098BEF63F35400C40724028C10EC0044120BE1E40F0C0203EAAC0C4C0CA3FD240C63F9CBF6DC1534036C0B03F1C40C8BF59C06BC000C082C09640AA3FA0C06840A3403440403FF74038BD5C4000BE743E84C0174116C0343F943F2E404340103EE9409D405A4093C00AC18AC0C3BFBE3FB140964042C0C040C33FFA3E9FBF6D40DDC0ACC019417BC0FCBF5C409CBEE03D"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
}
