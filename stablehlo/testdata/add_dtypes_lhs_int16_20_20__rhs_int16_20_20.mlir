// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.add %0#0, %0#1 : tensor<20x20xi16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xi16>, tensor<20x20xi16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xi16>, tensor<20x20xi16>) {
    %0 = stablehlo.constant dense<"0x01000300FDFF02000100000003000000020000000400FFFF02000100FCFF0000FDFFFDFF0200FEFF01000000FDFFFEFF00000200FEFF0600F8FF00000100FFFFFEFF00000000FDFF0000FFFF0100FCFF00000500FCFFFDFF03000200010003000000FEFFFBFF0000FEFF050000000000FBFF000000000000000000000300FAFF0000FFFFFDFF020007000300FEFF0100FCFF000002000000FFFF060004000000FBFF02000100FEFF0000050002000000FDFFFFFF02000100020000000200010004000000010001000000FBFF0200FEFF0000FFFFF7FFFCFFFEFF02000100FEFF0000FDFF010003000100FFFFFEFF00000000050000000800FCFF0200FEFFFDFFFFFFFDFF02000300000000000000FAFFFEFF05000000FEFF0100000004000000FCFF0000FAFFFBFFFEFF00000300FAFF0300FCFF01000500FFFF0000FBFF0000FFFF040002000000FDFF05000200030000000300FEFFFFFFFFFFF9FF020000000000FCFF01000200FEFF0000010000000300FAFFFEFFFDFF0200FFFF0500FFFFFCFFFEFFFEFFFDFF060000000100FEFFFFFFFFFF0300FBFF020002000100FEFF06000400FBFF00000000FDFFFAFFFCFF00000000FCFFFDFF0000FCFFFDFFFCFF04000200FEFF0000FFFF03000000FFFF0600FDFF0000FDFFFEFFFBFF02000000000005000100FFFF040001000000FFFFFFFFFDFF00000600FDFF0000FDFF0600000000000000FFFFFEFF0100010000000100030002000000FEFF00000400FFFF00000200FDFFFFFFFEFF0100020007000000010001000100FFFF0400FAFF00000000FFFF0100010002000500000006000100FCFF00000300FFFF040003000100F8FF0000FFFFFEFFFDFFFEFF01000200050005000000FDFFFFFF020001000600FDFF0300020000000300FEFFFFFF0000FFFF0400FCFF05000100010006000000FEFF0000FFFFFDFFFEFF010002000000000000000200FFFF00000500020004000300FAFF00000200000006000000FDFFF8FF010004000400FDFFFEFF00000300FFFFFFFFFFFFFFFF0000FDFF00000000FDFF00000200000001000100000003000100FAFF00000200030000000300FFFF0100FEFF0000FAFF0600040000000000"> : tensor<20x20xi16>
    %1 = stablehlo.constant dense<"0x0300FCFF00000200FFFF010001000000FDFF0200FFFFFFFF00000200030000000200050004000300FBFFFBFF04000100FEFF0000FDFF0000000003000200FDFFFFFFFFFFFBFF0000070000000000FFFF0300FFFF030000000300050002000400020000000300FFFF01000300FFFF02000400FEFFFBFF01000300FDFF0500FCFF03000400FDFF040000000700FFFF0000000000000200FFFFFAFFFEFF0000FDFF0400040002000000000000000100010003000200FBFF04000000000000000200020000000000FEFF0200000000000300FDFF000008000000FDFFFDFFFDFF0100000002000200FDFFFEFF000002000000FDFFFFFFFDFF0100000000000200FFFFFEFF010003000000FCFFFBFF0300FCFF03000400FCFFFEFF0100FCFF0500FBFF01000000000000000700030006000100FDFF07000500000002000300FFFF030000000600000000000600FEFF0100020001000400000002000300FEFFFEFFFDFFFBFF0100FFFF00000100000002000100F9FF00000000FEFF00000000FFFF00000200FFFF0400030005000300010003000300FCFF0400000002000000020000000000FCFF080003000000FFFFFEFFFBFF0000FFFFFFFFFFFF0200010004000000FCFF00000600000002000200020009000000000001000000FFFF020000000500FFFFFDFF0300FFFF0200FFFF0000FDFF0300FFFF0200000000000400FFFF0400040000000100FFFF000001000100FEFF00000200FFFF0200FEFFFEFF0300FEFFFEFF00000100FDFF000001000000FEFF0200FCFFFEFF05000000FFFF0500FFFF020000000000000000000000000001000200070000000200FDFF0000FFFF0000010000000000FBFF00000200010002000400FDFFFEFFFEFF030003000500FEFF0400010004000000FFFFFCFF03000400FBFF0100FEFF000001000600FFFFFFFF000003000200FDFFFDFF0300FEFFFEFF00000300030001000000FEFFFDFFFDFFFCFF0000FEFFFEFFFEFFFBFF040002000000020003000100FFFFFDFF0100FFFF0300FFFFFEFFFDFF01000000FDFFFFFFFFFF0100FDFFFDFF00000200000001000200FFFFFBFF0000000002000400FEFF000003000100FEFF0000FBFF00000100"> : tensor<20x20xi16>
    return %0, %1 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> tensor<20x20xi16> {
    %0 = stablehlo.constant dense<"0x0400FFFFFDFF04000000010004000000FFFF02000300FEFF02000300FFFF0000FFFF020006000100FCFFFBFF0100FFFFFEFF0200FBFF0600F8FF03000300FCFFFDFFFFFFFBFFFDFF0700FFFF0100FBFF03000400FFFFFDFF06000700030007000200FEFFFEFFFFFFFFFF0800FFFF0200FFFFFEFFFBFF01000300FDFF0800F6FF03000300FAFF060007000A00FDFF0100FCFF00000400FFFFF9FF04000400FDFFFFFF06000300FEFF000005000300010000000100FDFF05000200000002000300060000000100FFFF0200FBFF02000100FDFFFFFFFFFFFCFFFBFFFFFFFEFFFFFF0000FFFF03000000FFFFFFFF00000000FDFF0400FDFF0900FCFF02000000FCFFFDFFFEFF05000300FCFFFBFF0300F6FF01000900FCFFFCFF0200FCFF0900FBFFFDFF0000FAFFFBFF050003000900FBFF000003000600050001000300FAFF0300FFFF0A0002000000030003000300050001000700FEFF01000200F7FF0000FDFFFBFFFDFF00000200FFFF000003000100FCFFFAFFFEFFFBFF0200FFFF0400FFFFFEFFFDFF020000000B000300020001000200FBFF0700FBFF040002000300FEFF06000000030003000000FCFFF8FFF7FF0000FFFFFBFFFCFF0200FDFF0100FCFF000002000400000001000500020008000600FDFF0100FDFFFDFFFDFF02000500FFFF02000400FEFF060000000000FCFF0200FCFF02000600FDFF0400FCFF0A00040000000100FEFFFEFF02000200FEFF0100050001000200FCFFFEFF0700FDFFFEFF0200FEFFFCFFFEFF0200020005000200FDFFFFFF0600FFFF0300FFFFFFFF0200FFFF0100010002000500000007000300030000000500FCFF040002000100F9FF0000FFFFF9FFFDFF00000200040009000200FEFFFBFF020005000600040001000400060000000200FAFF02000400FAFF0500FAFF0500020007000500FFFFFEFF03000100FAFFFBFF04000000FEFF000003000500000000000300FFFF0100FFFFFAFFFEFF0000FEFF01000400FFFFF8FF030007000500FCFFFBFF010002000200FEFFFDFFFCFF0100FDFFFDFFFFFFFCFF0100FFFFFDFF01000300000004000300F9FFFBFF0200030002000700FDFF010001000100F8FF0600FFFF00000100"> : tensor<20x20xi16>
    return %0 : tensor<20x20xi16>
  }
}
