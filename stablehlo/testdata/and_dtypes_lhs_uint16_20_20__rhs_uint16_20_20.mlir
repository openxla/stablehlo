// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xui16>, tensor<20x20xui16>)
    %1 = call @expected() : () -> tensor<20x20xui16>
    %2 = stablehlo.and %0#0, %0#1 : tensor<20x20xui16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xui16>, tensor<20x20xui16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xui16>, tensor<20x20xui16>) {
    %0 = stablehlo.constant dense<"0x0100020000000400020002000000000006000200040004000200010007000200060001000300000001000000020003000300010000000100030002000000000000000200040002000700000000000000020001000100010004000100020003000100030006000300010001000200020000000300050002000700030003000000010000000200030001000100000002000200000001000100020005000200040000000300020004000100050005000300000000000200050004000500020003000100040001000100030000000100000002000300040002000000010008000400000002000200020000000200010002000200040000000100080003000500010003000300000002000100020005000100000001000100040000000000030001000300050002000100050001000200020001000300020002000000010002000300010002000000080000000000000000000500000000000200070007000200000000000100040000000200010002000000000004000300040002000000030000000200050000000100000004000000020000000100020002000100000000000100030001000200030004000000030002000100030003000100010001000500020000000200070001000100020000000300000000000100020006000100020004000100020000000400000000000000000008000100050000000100030001000300000000000200000004000400010000000000020001000300000001000200010002000000000000000000010001000300000004000100020001000000000002000000050000000200000003000100040002000500000001000000030002000400030002000100040005000200010007000100060000000100020005000100010000000500020003000000010000000100030001000100030005000000030002000200000002000300040000000300020003000200000000000600000003000100000000000300030002000000050001000500000002000100020000000300000002000000000003000100010004000300010000000100000005000200040002000300010002000300030004000000060003000000030002000500010003000000"> : tensor<20x20xui16>
    %1 = stablehlo.constant dense<"0x0300040001000000010000000100010002000400010000000000050000000100030001000000040002000000000001000200010002000100020002000100000002000300020000000100030000000400020004000200010002000300040007000300000000000100000004000400000001000100020000000100010000000200040001000200040001000300020003000400000001000200050002000300020003000100010001000300010003000000060001000600030000000200040007000100040000000400000007000000030000000000010003000100030000000100040003000200020001000000020005000400000001000000050004000300040001000000000004000200020003000100020004000000030006000400000003000200000003000200030001000300050003000100040002000200000002000800040002000000020001000200010001000700050003000100020001000100080001000100010000000400010000000300000002000500060005000100010000000200040000000000020000000100000002000000020001000200060003000300010001000400000001000500000001000600000000000200020000000100090000000100010000000000030000000100030000000200000001000000010001000100030000000000030001000200020002000000020001000100000000000000000003000100000003000200010001000300000003000100010000000300020000000300000000000300000000000000030000000100010002000300030000000000000002000000040002000000010000000500020005000000000002000500010000000000020002000000030002000100000005000000030004000200030000000400000003000200040000000200000001000300020000000200020001000200020000000200000000000800010001000500030004000400020000000200030002000000000000000100020000000200020001000000010004000300020006000200010001000100070004000100010002000200000001000400000002000000000000000100040000000000040002000400030001000100000002000200"> : tensor<20x20xui16>
    return %0, %1 : tensor<20x20xui16>, tensor<20x20xui16>
  }
  func.func private @expected() -> tensor<20x20xui16> {
    %0 = stablehlo.constant dense<"0x0100000000000000000000000000000002000000000000000000010000000000020001000000000000000000000001000200010000000100020002000000000000000200000000000100000000000000020000000000010000000100000003000100000000000100000000000000000000000100000000000100010000000000000000000200000001000100000002000000000001000000000000000200000000000100000000000100010001000000000000000200010000000000000003000100040000000000000000000000000000000000000002000000010000000000000002000200020000000000000000000000000000000000000000000100000001000000000000000000020001000100000000000000000000000000000001000200000002000000010001000200000001000100000002000000000002000000000002000000000000000000000000000500000000000000020001000000000000000100000000000000010000000000000000000100040000000000010000000200040000000000000000000000000000000000020000000000000000000100010001000000000000000000000000000000000000000000000000000100000000000000010000000000020000000100000000000000000000000000000000000100020000000000000000000000000000000000000000000100000000000000000000000000000000000000010000000000000001000100000000000200000000000000000000000000000000000000000000000100000000000000000000000000000000000000000002000000000000000500000001000000000002000400010000000000000000000000010002000100000000000000020004000000010000000400000003000000000000000000000001000100020000000000020000000200000000000200000000000000000001000000000000000400000000000000000000000000000000000000000000000000000000000000000000000300000002000000000001000100010004000100010000000000000001000000000002000000000000000100000000000000040002000000030000000100000002000000"> : tensor<20x20xui16>
    return %0 : tensor<20x20xui16>
  }
}
