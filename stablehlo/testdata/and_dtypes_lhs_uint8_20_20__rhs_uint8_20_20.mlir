// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xui8>, tensor<20x20xui8>)
    %1 = call @expected() : () -> tensor<20x20xui8>
    %2 = stablehlo.and %0#0, %0#1 : tensor<20x20xui8>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xui8>, tensor<20x20xui8>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xui8>, tensor<20x20xui8>) {
    %0 = stablehlo.constant dense<"0x01030200000203000002030601000002000300020002000100060000000001040202030100040100050100000204010301080202020003030000010000030901060000010506020602040005040102000401040301020200000202000203010002010002020002000303030103000600030103000003040001010101010001030201060200080101050003010101070104030001000105010303040504010102010402060101020202000303040302030201020002010605000502000100010200000101010401020007000100000004060200010104010002020003000000000302060303010303010000040205030101060001000202030000030302020201000500000305040300020601010303040303000200020301030406000301040600030502000201000200030102000100040000020401000000020201030003060003010304060104030100050101000405040300020201030201060502040001000106030106030200060102000401000200030000000300000000020203000605000200010301000201070301030000"> : tensor<20x20xui8>
    %1 = stablehlo.constant dense<"0x00030500060401020004050101000100010003000103010207060101000002000101000203010200030000020500010006010202040304000201040206000001010401010302050602060502090303040000000101050301050402040501020204010201030305020101000000020402020201020300010704010506020301010300010003000005000301010002000103000401080301000300060101000002040000020405040003020105030601040000040201030505010200060006000004050000060404010204050401010101010005030005060500000000000301000401050702050100040007020100010200040302010102030202030005000101010003030500040304040101000401000202010703020000060001010303000100000303020203020404000500020200010604020203040405010203000300020000030103010101000101010001000000020002030101000105010002040001040201030301000804000403000305020300000002020200000503010001060203000000010202000705000001010302"> : tensor<20x20xui8>
    return %0, %1 : tensor<20x20xui8>, tensor<20x20xui8>
  }
  func.func private @expected() -> tensor<20x20xui8> {
    %0 = stablehlo.constant dense<"0x00030000000001000000010001000000000000000002000000060000000000000000000000000000010000000000010000000202000000000000000000000001000000010102000602040000000102000000000101000200000002000001000000010000020000000101000000000400020001000000000000010100000001010200000000000001000001010000000100000001000101000300040100000002000000020001000002000101000200000000000000010405000000000000000000000000000400000004000000000000000000010004000000000000000000000000040302010100000000000000010000040000000002030000030000000001000000000100040300000001000001000202000200020000020000000301000000000102000201000000000100000000000000020001000000000201000000020000010100000100000100010001000000000000020001000001000002040001000000030100000000000002000001000200000000000200000000000001000201000000010200000201000001010000"> : tensor<20x20xui8>
    return %0 : tensor<20x20xui8>
  }
}
