// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.sign %0 : tensor<20x20xbf16>
    %3 = stablehlo.abs %0 : tensor<20x20xbf16>
    %4 = stablehlo.constant dense<3.389530e+38> : tensor<20x20xbf16>
    %5 = stablehlo.constant dense<1.837470e+19> : tensor<20x20xbf16>
    %6 = stablehlo.compare  GE, %3, %5 : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<20x20xi1>
    %7 = stablehlo.abs %0 : tensor<20x20xbf16>
    %8 = stablehlo.log %7 : tensor<20x20xbf16>
    %9 = stablehlo.constant dense<2.000000e+00> : tensor<20x20xbf16>
    %10 = stablehlo.constant dense<6.914060e-01> : tensor<20x20xbf16>
    %11 = stablehlo.add %8, %10 : tensor<20x20xbf16>
    %12 = stablehlo.abs %0 : tensor<20x20xbf16>
    %13 = stablehlo.constant dense<1.000000e+00> : tensor<20x20xbf16>
    %14 = stablehlo.compare  LE, %12, %13 : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<20x20xi1>
    %15 = stablehlo.abs %0 : tensor<20x20xbf16>
    %16 = stablehlo.abs %0 : tensor<20x20xbf16>
    %17 = stablehlo.abs %0 : tensor<20x20xbf16>
    %18 = stablehlo.constant dense<1.000000e+00> : tensor<20x20xbf16>
    %19 = stablehlo.abs %0 : tensor<20x20xbf16>
    %20 = stablehlo.abs %0 : tensor<20x20xbf16>
    %21 = stablehlo.multiply %19, %20 : tensor<20x20xbf16>
    %22 = stablehlo.constant dense<1.000000e+00> : tensor<20x20xbf16>
    %23 = stablehlo.add %21, %22 : tensor<20x20xbf16>
    %24 = stablehlo.sqrt %23 : tensor<20x20xbf16>
    %25 = stablehlo.add %18, %24 : tensor<20x20xbf16>
    %26 = stablehlo.divide %17, %25 : tensor<20x20xbf16>
    %27 = stablehlo.multiply %16, %26 : tensor<20x20xbf16>
    %28 = stablehlo.add %15, %27 : tensor<20x20xbf16>
    %29 = stablehlo.log_plus_one %28 : tensor<20x20xbf16>
    %30 = stablehlo.abs %0 : tensor<20x20xbf16>
    %31 = stablehlo.abs %0 : tensor<20x20xbf16>
    %32 = stablehlo.abs %0 : tensor<20x20xbf16>
    %33 = stablehlo.multiply %31, %32 : tensor<20x20xbf16>
    %34 = stablehlo.constant dense<1.000000e+00> : tensor<20x20xbf16>
    %35 = stablehlo.add %33, %34 : tensor<20x20xbf16>
    %36 = stablehlo.sqrt %35 : tensor<20x20xbf16>
    %37 = stablehlo.add %30, %36 : tensor<20x20xbf16>
    %38 = stablehlo.log %37 : tensor<20x20xbf16>
    %39 = stablehlo.select %14, %29, %38 : tensor<20x20xi1>, tensor<20x20xbf16>
    %40 = stablehlo.select %6, %11, %39 : tensor<20x20xi1>, tensor<20x20xbf16>
    %41 = stablehlo.multiply %2, %40 : tensor<20x20xbf16>
    %42 = stablehlo.custom_call @check.eq(%41, %1) : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<i1>
    return %42 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0x1F403040483F98409BBE164041C095C04E3F64BF0A403840D0BF1B3F584073C017C09B3E883FBCBF89BEA1BF803F96C02EC03BC089C0A9BF97C0AD4003C1163EA8BF124014C04BBF10C022BFCDBF1EC0563E1C3E3BC096C0813F8FC0524076BF3AC0D33E79BF953F0EC02AC0A3BDD8408B3FF13F8CBFCCBE394070BF48402840923F4440C2BD1340A4BE0D4036C022BF9C3E05BFBCC06FC04240214085C0813FDEBF0B403C40B04067409F4016C0BC40013F5DC07C3FA63F4E3F16C0F3BE31C0B7C061402AC036404AC0BD3FCFBF3DC02DBF883DC4BF324073C0514087C0D6BFFF3FF0BE0CC0703FD03E9C3F8C402BC0D140BD3EA73F1040B7BF06C0A6BFA5409A3ECFC04B402F402B40B43E35C0273F9B3DAEC07B408F40A9C001401EC0B14031C0B63F06C0D5BF4BBF8ABF0D407FC091BEBB4082C003BF86BF20C0C9BD8BC0CB4035402DC049BF943F9F3F6540FF3E8E40053EA93E71C042C05CC0C4BF6040F7BF65C086C0743E4F40BFC088C08640C03F6D40A83FEDBE934025C0DFBFEABEBF3F14C0573F0240463FDF3F013FACBF2A403D40143F42C0A140C040C4BF783FC8409BBFBB409140A43EFCBF9F40E1BF053F0E40663F0F3F533E84BFA940BAC001C0AEC09F3E54C0E5BFE4BF433E2BC023C009BF0BBE13C064BFAFC0403F66BFC4BFEC400B40C3408940A53FC1BFC03F23C0C9BE774041C02EBF74C0E0BE4C409A3F10BF00C032C0BE3FE840B8C008C026405D4043409E3F284066C0903F70BF85BF4D40D43FD43F104090C01FC08DC019C077C0C13E35C011C045C0A1BF50C02DC0124068C0823F2A3FA2BDA63F4E400EBF0CC0BA40833E0B40853DD23FEC3F684087408F3E38C010C053403DC0A4C0244008BE55C08E4099C0C0BD73BF0740C7BF9EC079C0D33E2040EB3FDCBFE5C081C01940C8BE9CC0B53FE23E5D3F693F4DBE51BFE53F02C036BF17BF81402EBFA4C0F53FFE3F743F8BBDAC4056BF9D4031C0353F19BF54C0464018C098C0CD4067BF643FB3C023BEC43F98BFA240AB3EBDC0F83D6E40953E773FEA3AF0C0923FD8C03EC03A40F73FA6C0D83F543F25BF173F2E407BC0EBBF623FC4C09C401740E6BEEBBE5D3FA2BFD040C4BF67C093C0"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
  func.func private @expected() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0xD33FDE3F373F114099BECB3FE9BF0FC03D3F4EBFC13FE43FA1BF133FF73F03C0CCBF993E6E3F97BF87BE87BF623F10C0DDBFE5BF0AC08BBF10C0194033C0163E8BBFC83FC9BF3ABFC7BF19BFA0BFD1BF543E1C3EE5BF10C0643F0DC0F33F5BBFE5BFCD3E5DBF7D3FC5BFDABFA3BD2740713FB23F71BFC7BEE43F56BFEE3FD93F7A3FEB3FC2BDC93FA2BEC43FE3BF19BF9A3E00BF1EC002C0EA3FD33F08C0643FA9BFC23FE73F1A40FF3F1340CBBF1E40F93EFABF5F3F8A3F3D3FCBBFEBBEDEBF1CC0FC3FDABFE33FEFBF973FA1BFE7BF22BF873D9BBFE03F03C0F33F09C0A5BFB83FE8BEC3BF563FCA3E843F0C40DABF2540B93E8A3FC73F94BFBEBF8ABF1640973E24C0F03FDE3FDA3FB13EE1BF1D3F9B3D19C005400D4017C0B93FD1BF1A40DEBF933FBEBFA4BF3ABF6FBFC43F06C08FBE1E4007C0FCBE6BBFD3BFC9BD0BC02340E13FDCBF38BF7D3F863FFF3FF53E0D40053EA63E02C0EABFF9BF9BBFFB3FB4BFFFBF09C0713EF23F1FC00AC00940993F01408B3FE6BE0F40D7BFA9BFE3BE983FC9BF433FBB3F363FA93FF93E8EBFDA3FE73F0D3FEABF144020409BBF5C3F224083BF1E400E40A23EB7BF1340AABF003FC53F4F3F083F513E67BF17401EC0B9BF19C09C3EF5BFACBFACBF423EDABFD5BF04BF0ABEC9BF4EBF19C0313F4FBF9BBF2D40C23F20400A40893F99BF993FD5BFC4BE0440E9BF23BF03C0D9BEF03F823F09BFB9BFE0BF983F2B401DC0C0BFD73FFA3FEB3F853FD93FFFBF773F56BF69BFF13FA43FA43FC73F0EC0D3BF0CC0CEBF04C0BD3EE1BFC7BFECBF87BFF3BFDCBFC83F00C0643F203FA1BD8A3FF13F07BFC3BF1E40823EC23F853DA33FAF3F004009408E3EE4BFC7BFF43FE7BF16C0D63F08BEF6BF0D4011C0C0BD58BFBF3F9DBF13C004C0CD3ED33FAF3FA8BF2BC007C0CE3FC3BE13C0933FDB3E483F513F4BBE3FBFAC3FBBBF29BF0FBF074023BF16C0B33FB73F593F8BBD194043BF1340DEBF283F12BFF5BFEC3FCCBF11C0244050BF4E3F1BC022BE9B3F81BF1540A83E1EC0F83D0140933E5C3FEA3A2EC07A3F27C0E7BFE53FB43F16C0A63F413F1CBF0F3FDD3F05C0AFBF4C3F21C01340CC3FDFBEE3BE483F87BF24409BBFFFBF0FC0"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
}

