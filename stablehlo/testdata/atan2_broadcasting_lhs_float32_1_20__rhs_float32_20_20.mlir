// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<1x20xf32>, tensor<20x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.broadcast_in_dim %0#0, dims = [0, 1] : (tensor<1x20xf32>) -> tensor<20x20xf32>
    %3 = stablehlo.atan2 %2, %0#1 : tensor<20x20xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %1) : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<1x20xf32>, tensor<20x20xf32>) {
    %0 = stablehlo.constant dense<[[0.131478548, -2.77793312, 2.29106331, 3.4928062, 0.858757734, 5.65312386, 2.51136136, -0.550005853, 0.95770663, -0.369706362, -4.32866192, 1.30702746, 1.4765718, 0.388277352, -6.452340e-03, -7.11806583, -1.31964219, 4.52829218, -0.216322049, 3.51166534]]> : tensor<1x20xf32>
    %1 = stablehlo.constant dense<"0xCA1ADCBF6728AB3F73124240BE8A3B40D6F4A83D43508CC0E1BD5D3DEAB3BDBF9695F8BFE77904C078EAB93FF1F835406FF5C53F0382824004102E404200D0BFCE2AA5C0BB6F56BFF0AE2BC016C94FBFE62595BF80441E3F2A2C4140346C6440A7A164C076E6DABF17638040F1F8023F856AF13F322E06C1440D13BFF4A57240842B234048F9E840DE0DD8C0077D103F43EF97BFA4753B4062FD1B40316333C0DC226AC09B92824026802B4027E81FBF219F2B40E6DD82C05F8133404D5FE0BF24CCAEC0CB010540C478C3BEAADC573F8D63A8BF91B5793F715A0840EF67B8400C465DBF2FF7F9BE41443440BC70FABE72F38A40CA2072C084AB843FFBEC43C0C8D6D93FCD9009C13E49983FFCBD5ABEBE424BC08355663F05AB514036F7E23F2BE65BC0856E493E1827FFBF12AADEBF51B090C0C67AFDC0F55D99BEF2C3E83FC85F6640B59538405CE5AEBE18E501414E8BCDBF9501B9BE8F705EBFC1F58E3F492459C0D4A84A4007088DC06A726540724B6A3D6C6B0D40BBB4F5BF9B78063FABE01C4014251FC07D1D3C3FB295E4BFE46E913F97FC0140F6DCBC40833E84C066C351C0F06AA5C00CFC4940F4E9013F4519753EAD505B3F7E0484BEEF5E1CC087B99DBF46A7D83E04387EC0EF4DDFBF9660963F7C4BFF3FF53EBC3F63402EC0E24F09BFBEEA6C40E739F7BFCC8DF3BF70A3AEC0DFBF01C0479106C0F4B34E40C8AF8D3E8DAF1E3E1C22BD409D2DC7C0A4F46DC0D7A05D3F98EBC7BFAFD6843F9B20A8BEDD335DC023B0E33D7E8395C076EA0EC02F9E9ABF0D1AF6BF97202940CE2606C05E1A93BF21C186BE46D14D402C023040C42871BF652104C048A3ADBFC5804F40ED6C393D44F68240F94966401FF9A4401E4D5ABFD331EBBFFB98833F5F50993F0D61463F6E350C3F45708E40941F6A3F2F2BAE3F2BE6463F0A2FC83F4BE8003ECCDC41BF9707B33FE7A900C024566340485B97C09DF4F6BFC8DD99403AE300417C75D3BE6B06D63C24C6ADBE2738ACBFE1081DC0C2D396BFB3B55F3F45B1964095F703C03FD3B6BF2D14953F614A354095A196BF327197401EE72EBF950928C05C7827BE055BF1BFE8BE563F2B02AC3FEA58AE409FBCC0BFD467DCBFB60DD7406ED9A23FE1E6DF3FCF60113E6510A13F1C3C39C001EA4B40E56196C0F00C30C0C71EFCBFF8158F40674E3D3F5C6F26405BB7AC3F43D0AF3F859895BF3BD9B03FE134B93F1D96BBBE8CAF13C0324106BE4B31F7BF8DADA03FECEC0BC00C5DA33FC47893BFCB6B45BF8E3EB7C0DAF6914003DB593F46EFC8BF8EF19940071DF6BF3FA274BEFDED533EC3F2DC3FE283C8BF977ECB3F904AF0BFECBDB0C03C449B40483A60BFF02352BE38507CBE47DC73C099D94D40E4FFC13E6CD80D40D6490C3FFC31313FE8E494BF8A27C9BF0FFFFABEA48CC1BFFF6D2CC08A3CD43CFEA6084086BC93BE998A203FA5A5A4BFE73613C0ADE1C33F7D9766C095C8A6BD58C58CBF134F79C0DCF3D63FA5E39E3F3EC3B33E9871D1BEA1250DC03B06E7BE7D4D65BF0C65D8C07E21E53F7FA9873F486BD23FA9B575C0906984C02DAA113E5FCCE2BD441F0140EF60D9BFBD12C540D5883B40263275C0DC19A540386736400629C23EF46AD8BFFE3463C0AC5E28C02A6AA1C01EB526C00D71F7BFBC840A40C39A0840DB1C60C0EA27B73F8CCC2C40553EA4BF7C73C73F87DD8E4015161EBF266081C02A8C63C07ADF00C0967D0540AE2AB7BF374D85404ED7884095B37240FBB9A23F00A12F4091AD9A40DCE920C0F8D431C026641D40EFCA5A4048CAB43E5A223540EF9737BE27DF9F40FD98B83F137E69BE438AB040EE0498BF462F68C01D231BBF48920BC0E8AB95C05A1584C069FC4FC0DF5F43BFAE1BA0C02183C7C0840A72BF4B55544099168D402923223FEEA8BC3FD0E3C13F21D475C01AF8FABFB7028CC00F4136C01F9031C08ECAF340849091407008353F978682C06C451740AB939D4051E72CBF8F23BC40029C364018E189BF8CEF6B3F493BA8BF1EE341409D50E23F93ACA74091870E40993680C0E210DCBEC2D0FF3F2E569B3FCC4692C09842D13F1FC1A0BF8AC1C63E46DCDAC053D59540E035C03BD6563A40806342BF8935453E1708BF3F79FC424097B55ABFC52529C0C20A82BF1D1AA23FAF2147C0F7E2A5406983D0BD13E63CC0048D363F4E182E402F7DFE3FF5A254BF670200409A4C444041962B407D0E4D4024191040D862A6C0EB8A294090AE71BFFA7D91C0"> : tensor<20x20xf32>
    return %0, %1 : tensor<1x20xf32>, tensor<20x20xf32>
  }
  func.func private @expected() -> tensor<20x20xf32> {
    %0 = stablehlo.constant dense<"0x902D444078A38FBFFDA3253F1E6C5F3F90CDBC3FA1C00E409A4DC63FB15132C0A3BD2B4016C03DC0809F9FBFFE9BDC3E1123433F5964C23D8E7A1BBB88CAE5BFC90A39C08579E03F7FE943C0EB22E63FF0DE41403C08ADBF8636263FD24B463FA9F63940E2A9EE3FFF2C0F3F055152BF8D90F03E0A3E46C0F7F2D9BF0DF9A93E2C63063F5C3D5A3D320049C007EFBEBFA56913C06F247F3FB24AB5BDA6A40F4048C34640660419BF6616353F9FB6DF3F30AE9E3EC69C0C406FF23A3F799A35C035F43D402A4734BE7A52D4BFF5727F3FFF1B134043F6C13E1D7A46BB9AE663BF95A409C01DCFD63FD3FA9CBDF1C6DA3F89F8F73CE88620C05AAE923FDE9612406844EF3E63D623409D6E903FF17AF8BF57513640FD9CC7BEAB456CBFA69C223FDE152F40DD098D3FD2DA48C0FDBDE7BF49E336C040D327407C0821C0BDE68B3F2E8B153DBB4244BFC701DC3FB505D03EF2A129407F3BD13FCCB2F33F3D49EABE5E7437409608EEBD3E5F17C04FFEB23E171BC43F841D323EC8D848C01DA2BFBFDEDBFCBE9CAB0440AF9592BEDEA30240FBF0EB3DB48170BF6B95BD3E68271C406DA93840EDEF134038112C3F285A53BFBAB6A93F2297D0BE73ADD0BFDA9F2940F5091140F5103E3F3DF548C0B5D3E7BF5FE857BFE9F4933F6A8C15BE62BD0E4065AD394030CE24BFEA5B114089740440B7123F400923F53F3D24114080B92CBE840EA53FC04196BF22D321BFB2D03B4023DE304017DCD73E2BCC48C0C387B6BF6347E8BF45410E40C04B8CBF0DD01F404E4C45407390FDBF1F371140C94F6C3F3E2D3040CFBBE23F786DD63F1F742DBE0A93AB3E712031C0610301C073FC1740ABCDDA3E8D34BA3FEFA5CEBAE2268DBF8E4D80BE16E3E03FD28F41C0379BA43F89E9DF3DAA3DA6BFCD06AB3F58532A3FD402413FE8D3AA3F54A8A23FC924ADBE3455B83FC4FE2BC0E80EA1BFE12A244080B4C93EE6D1434010D948C0C9087ABF264626BE3CB4D43F67ADB9BF1365D53FE1D34240ACD512C0EFEE024086AEA93FF1B4383EA5D4F53F6CA0054004E4E1BE43EDA63E9C9435C082A83DBF755B034062462840EE16FC3FCAD748C0F00BBABF0EBD46BF1285313F12EE3FC042B50140813FA03CC01692BF88306B3FADDCC33F064F193F9ED00240F8E12A3F049B41C0B19E3340FC2F3DC0B7E844BF9528873FDC32043F22748F3EF0ED99BB75E4DDBF3D3043BF7979A13F62ED26C003BD0940C6B416400E690BC051E7883F405308409A9F173FD8CBE23F9532EF3F06EF42C0A5EB533E47D6D1BEE997F5BF92D3873E32261F4006D507406950FFBCFC9BAABFFA411CC020D89D3F2FB841C016D1244062EDDD3C6128F0BF237FD43FA513D23FF6DF3A407FD9863FF1E4B53F8E1579BE6089863FB02CFBBE53AAEABF1AA91C40BF17F23FC0F938409EE848C09798C8BF82B70DBF0C35D13FCF11AABE4101F63F61684540689C88BF3CD02440B90BCC3F01A21E405D250B40BF3C7B3F288CD5BE86159C3F52071AC048B002C06F9CF33FA46D07402864454007396CBB6024B6BFA0292DBFAD8911401BB845C036E1C33F9E541140DB5171BF025B0D40EC12043FC2F6913E67A60A40ECEEE73E823643BE89CD983FCE483BC01F7E10C02A8D2B402ED6364079973F402BD948C05847A3BFC2C10DBFB9A80E40ACA419BE3E536A3FE78642401CA187BFC7C0F23EF275DF3FBFAA3B4042760840F8C80F40610184BE9F5023404D49B5BDC79E4ABF31F0A93E70265C3F33EE0F3EC0F6AEBA0B86F4BF61AF2CC03861893F5B6B81BDFF3BBC3FD3243E3DCD4FD1BF9024DC3EBCF0963F4748EA3F312F4C3F70CD0040BA6E3FC033A3084079503EC0B84519C0716F354080C42D4004F12A40BAFA48C0A49112C0AD510CC08440703FBECD48BDD038B23F3A35B63D8C2989BF48A42640A24405407DA83C40506502409CFA1940BA9893BD657C543E8FA4F6BE60E514C00650013F7628953E96AB2740A0D88FBA704398BF1F5810C0965CAF3F2D9F3EC017E65B3F8A03983D4997F9BEB2B04C3FC22C1B40013B0240B6909D3F95718F3FF16541C0CEA8073F46BD36C00E9DBDBF20FA3C400F689C3EDC20C73F3D3C11BB43AAD6BF4183B6BF8C4FA03FAA2B91BDE09BE73F77E14540B9F0F5BF2F6D883FD01A1340211B283EF15DCB3F36F11B40CA3028BFF051AD3E67433CBE1454E1BFBF2C143F90B7E53E6146133E78FA03BB3AD9A1BF9A2739C0E84E853F5FA53AC0B4F81E40"> : tensor<20x20xf32>
    return %0 : tensor<20x20xf32>
  }
}
