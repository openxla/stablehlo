// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xf32>, tensor<1x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.broadcast_in_dim %0#1, dims = [0, 1] : (tensor<1x20xf32>) -> tensor<20x20xf32>
    %3 = stablehlo.atan2 %0#0, %2 : tensor<20x20xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %1) : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xf32>, tensor<1x20xf32>) {
    %0 = stablehlo.constant dense<"0x7BEDE0BF9D6FB4BF80CD0FC0A0FE634047CF0EC0AA706140604F56C05E2C3CC02883B3BFBC97CBBF5CD541408EFE4A3F6B4B71BF069D5540E10AD4BF06C912BF9E401EC0F9DFFEBF01A4B63FE7D5B63FCD178BBDC156C13EC61E4EBFB901AAC0199A3040F94EE4BD318A843F4CAF67BE2E00753F670C9D3E29C39DC0F5C108C0AEC9C9BF40083A40F487013F86523D3FE78C48C0A263D3BE414E0BC05618F13FBBFA034081508AC0F6FB633DF3BB684047BAB6C0018D4EBFA7C1A4BE9B323FC0FF0C573F751B993E298985BEDA122EC0E1E403BFD271A93F6521293F8F4A764049B72E3FD11B0EBF989FCD3F717991BF54009440FD3B0FBF4019EA3E043DBEC00A75CFBE7E209FBF6968FB3F7F8EB2BF138459405A3403C0B13BC3BDD634C83FB054B03FA08A8B3FA11181BD78EFF1BFBD0085C0175B0340EBDEBB3F7334D0BE25DD23C04C85E63F2F36FD3FA299C340B479CFBF56FAA1BF610499BFF8E962BFEDA83D3FDF36F2BFFE8CCEC030708F40AB0644C067A39240402B38C07A26863FE24B5EBF151105C0134468402B534DBF986F2540E5035B40457B56C077A9823F0C82A53E9322F2BF136C0440E76224C03F8540C05B2DD33F28B559C0E117DAC0E5E513BEEAABA73F29E4BD3EABECA3C0EE3708407A1C0140A9BD96402811E0406ED50C3DB69152C09D8CAEC096FD84BFD40AD13FE19E79C0A5C944C0924A09C0A74884C04666CF40EDA29C40AB5F7EBE7F20D83FE5501CBD76B229C1DC1904403D00A1BFC2A74A3E77C462BF367F0FC00959AE3FA9B50F40252F47C025BCCFBFAA6F923FBEF3FC3FB72311C0CAC5A640D782CB3F18D39BBFD24899C02224C8C0D60304C03CEA08C0B21A62BE574D38C04C79CDBEAE808CC09C70A3BFBE7176407F4612C0721C71C065CE1CBDB0745D40969A6CC0A94569C062C3D0BD64BEC6BFFBA45D3EA4670CC0A267A73F8A60393FD12C323F02521C40BDEBB0C0C1569C3F15C8E240582D4740B04CEDBFE0F1C63F791B5EBE14DA1E3EAF75EE407B10C040B8FE5140D49B6140910AEC3EFF263A40C843C53FB583BDBFDCD0E3BF0C314BC00A559CC079BB593F32317640EED472BAF89099BA11AD32407E7534C0257D57403A6C8640CC22643E879F9A3E128DC04031EBA4C0FFE081C0361C9DC06EC2D53F552457408F830240C9C958BE9D20DBBE81E2EB3FDC8E0640F3224B40EBA3C24035B398408FA7E53F373023BF6637C93FA37F2B407BE77F3FF0BB813FA338EABF27718F401CB64BC0138C9640C43B17C0460633C0DB90D2BFC1976340D5BD9FBF353B5340CD2CBEC0C46005C075709CBFF46DE6BE67817940AF940FC0351C5FC0EC64A93F95A8C23FD3A3E93F786BBABD561D8FC016ED2940C7A4A5BF442B3F40A0D0AEBEFA53F0C053714B40AE21193F6D77453F1D88463F974EA33F9F1F7F402C125EBEFE6903408BDC97BF852B66BFC355A03FE006954080D66C3E0D163FC02E0FCFBEA9621FBF2A41A8BF7BB390C0CA1706C0437AFC3D287A76BFF25B0FBE083964BF829048406F681F3F115E5D3EBF3A82403F407940029BAFC0F88F9F3E39F52A403850BFBE0ACD8B40FE67E9BF97A794C0A2C2E13FB4C80D40E44AAAC0717A7E400AB8E2C01F2258C0FBA81840CA33B93FC84F5A40B51AA2C0A07186BF109379BEA48DD0C06F10B93E4707AEC0647E414085FD9540C21E9EC03AE409BF57C0B9407C867EC0A1573E3F1C6EB5C0818D4740DC5105C01B610F40EEBBB540D9DA493F5B3B3840F1364EC0953F6B3F504214C0709E0A4079C73F40B8C76DC06C221E3F1734AF405CDAFF3F06B869BF96015F3FCE95234096F7813F0B089D3FB7F30BC18AFC783E3C36E53FEA6D48BF9C9CD63F3D8D923FB65F96406F982D408A57853E7533CDBF10EA083F70D9CB40F133B83FC9EA28BFAFBE5DBEFBB80F3D178F56BE02CFAABF74AE5C3F106465C01EC2D9BE7C90C1BEEA25F73F6083183FE7910EC0688AAABF819113400CCEAE3FF0CE88C0AB6E13C0371E163DC8F0F83E84ABE93E6791B63F2CC61CC089843CC0E2C032C0FB9966C06F098DC0451ADC40DC1BC6C0C12E114002B8CAC02426033ECFF17C40E78DB7C02EB9E2BFE8526CC0618F6140E5BDCAC03918CA40B0CC0241E996CC40EFD0C5C057CB8A3E5DE88F407A0448C06D5065BF4250973F76F51240347EAF3E0B5D063F70C9493E6CF65CC0ACB059C0F2F9274067B0DEBFA695B0BF21997FC0CAFCC1BFD1260ABF50A10B40"> : tensor<20x20xf32>
    %1 = stablehlo.constant dense<[[-2.928870e+00, 2.77713609, -0.590381265, 0.876826525, 3.34466958, 3.3872118, -7.1321063, 3.239150e+00, 1.05203331, 1.62670135, 0.679149747, -0.596761942, -0.227141321, -3.7520113, 0.0176864862, -1.58060241, 0.923746824, 1.2836045, 2.00980401, -2.75558352]]> : tensor<1x20xf32>
    return %0, %1 : tensor<20x20xf32>, tensor<1x20xf32>
  }
  func.func private @expected() -> tensor<20x20xf32> {
    %0 = stablehlo.constant dense<"0xEE7926C0087DF0BE63F3E9BFC62BAA3F549D16BFDC124E3FF1F72CC0DBAF3CBF245D6DBFD92F46BF78D3AC3F26D20D40AD54E7BF3C881A4005B2C7BF45CA32C07F4C9BBF248A7FBF8F0C1E3F7D742A40009447C031630A3EFE050DC00A20B4BF5A97303FECC106BDAAD53F4022D28EBD46F73C3FEED83E3E158AB7BFB8EBEBBFE160DBBF99E01E40EB96C43FC50D2D40505EA4BF4C559FBE594253BF1AB02240DECC2140A9EC7FBFC00B4340D2C6AA3F543D85BFBE746FBE222D46C043B83EBF977F2C3F042A3A3E0DBBBBBE33B5E4BF4D36FEBFA55A3340D7A2C53F31F2FA3F1EE5223F56FCD0BEC69F2C3FA90630C004A9084071944BBE4CE31E407651B6BFD5E6F6BD8C19B4BEF9DC37401E35D0BE54A3A23F096966BFF2CC0EBE5BB7F73F96FADD3FF4F63640740AA6BFA01A11C0A411ADBF1D86813FF479213F57AF3FC01E161BC0AD47133F6E2FEE3F33D3B63FDB0CE7BE7E0FB7BEF26E3EC053C288BE9D111D3FDA585CBFB8A4BBBFDB00DA3F7289D2BFC87010407546C8BFE49623407E2641BF354482BF6553883F47EF36C08DC81A40D999633FD761DFBF7A725C3FD552C53D556302BFAFFD3640C7A12BBF96FF9DBF4ADE4A3F96D6AFBFBE3DD4BF5BD024C08090334068F6C23FCE5EEFBF2DA6943F4387803F9071953F500DF93F864F4840FAA75EBFB8DCD6BFE4AD5EBFC790E83E990E5BBFD6022FC03CBF15BF072AA9BFFB95A93F3E6AB73F30D12FC09B2DDA3F366948C036D9C8BF215B0E404FF66FBF7BA51C3EFE8BD4BE3A591DC0D2332D4033102E3FD10EE1BF60A889BFA4BDA83E6F34073FDA5B35C0C3E1813FE87A7C3F337824BFBE08B7BFF63CD5BFAD19D7BFADE527C0BAD4BEBF56A804C0DBD6D1BEFDA7A4BF96E410BF6C480C4011A71EC03B816FBFEFEA44C09F4BA93FA6DB55BF1B7052BFB42548C008DCE4BE52C84F3E96C96EBF5CC18B3FEEA41040B970F13F2D21244008A7C8BFDCF41E40A678B83F3CFD963FE7BC3EBFBA312840B95444C0E08F643D852ED33F717EB63FD19B463F582B4E3F44EE4440DD4F3B3F1AC9783F4E083DBFE3669ABF08D8E0BF4602CFBF9ACB3A403279C83F410649C0243EA6BA66E6913F729873BF1E6D1040967F0B40DAF1A33D02CD2A404A8AB63F43C17EBF351660BF0C7A22C043B9F33E4A3DA23F88C0653F09B79ABE603E21C06BC2D83F8D5F28404359C83FB29AE93F1496B03F7A25733FEC409DBEE5E1274068A31940AEE6B03E9549064067DD8FBFF3046E3F741B41BF05BE2340FE5821BF3A049BBF4D7F4ABF4BE8B03FDE1301C06ADBD13F759208C0C5F9C7BFC5EF1EC01F1FE8BE2F59A03F5C1C57BF07570FC0B5E62D40A241003F631AF13F3AD9D3BD25BD6DBFB4312A3F0A933DC05DB33E3F6DADA0BE5BC2ADBFA81EAE3F95B81640D8B7ED3F6C043C40A249C73F8761F93F55206CBEA38C813F3F8408BF77E034C075322F40173C843F5E2A3140EC7FA4BFC66EF6BD75243ABEB3653DC0B1FE72BFA47F8DBF85E99A3DBCDA74BF79503AC0C7FEE8BFDE861C40616DC53FD55C4040FF7DAC3F3E4FA03F0B209CBFBBDA41402ABD194078F408BE5741DA3FD8B08FBF4A6072BFB3CCF53E77C935402C1383BF46F4A73F862CACBFC6A8AFBFEB70E83F50FEDC3F04D71940739DC8BF648623C0071484BEA22BB0BFAD36363ECC8B02C0E0C71540D698843F8148D8BFE8050DBFEB26863F03855DBFF7694240699F86BFCC689F3F716668BFC162A33F7B76D63F79F6EC3FA42D1F40FD5BC8BFB85B2740767E98BF5E95843F71E17A3F7C5F0DC04CC23B4015FA8C3FA7D2ED3FEA3A4EBFBA73823E5A7D253FE7024040785EB93E92BDB9BFF3EF173E6AA99A3F6D360EC02B4CDA3F4A1B36408694C83F784C064076B28C3E854865BF1929853ED251FD3F4AD52B4029DE6EBEF58F32C026D3233DB02180BD6326C0BE215D41406BFF55BFE4B3C4BE3BD569BE03C59D3FBBD916408311D6BF6A3933C08214C83F0B751B40EFD2ADBFDDFD87BF835E953C6AE23D40362B3F4097ECF23E8855E7BF5B07A4BF5C1D32BFA8F750BFE5A225C0F0B9903F3484B3BF8BDD723F4664BBBF1D883B400169D03F7C9A09C0ACC8C7BFEDD4FCBF3B40A83FBD79AFBFFA9FA13F37ADF23F160600404C0493BF5E832D40106AB03F606240BFA55E84BEB28C3E4056DE1D3FA442A13E5ECC9F3E9196903E4CF8DEBFCF98D1BFEEFE2140BEC2C7BFE1221BC09BF7ABBF7A395EBF484F86BEB2331E40"> : tensor<20x20xf32>
    return %0 : tensor<20x20xf32>
  }
}
