// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xf32>, tensor<4x5x3x3xf32>)
    %1 = call @expected() : () -> tensor<2x6x6x3xf32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[0, 1, i, o]->[b, 0, 1, f], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x3x9x10xf32>, tensor<4x5x3x3xf32>) -> tensor<2x6x6x3xf32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x6x6x3xf32>, tensor<2x6x6x3xf32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xf32>, tensor<4x5x3x3xf32>) {
    %0 = stablehlo.constant dense<"0x411A0A4096AD02C13C10D53FB88E8A3D57816FC040800CC1702E22C03918DE3CAE8B5940EDD86AC069DAF23F893EEEBFE53FB63E132999C038BBC140E1FCB33F1CFE07C0636E92BF1C8EEC3FD5E6723F57DD3040DCB082C05816DA3EFA76A240D03D4C405A6B6940A4AA2E3F95D866C01C0BAEC093790F3F391B3B3F5C691EC03616033FAB9906BF6C6EC1BE42DB84C0651C9B40D939EDC06686C4BE516A9B3F56AB4CC03265823EF8EF74C00BC0913F6A2F0E4089B0A040F32AD63F6CE70E40F3E2A0C0BE7703C00E2D9EBEBDCD1540EE7487BE6C7E23C0E1D0CA4002E683BFEC50DCBFAA8FBFBF1CBA853EEB1159405333483E65195DC072740B40B1F04E40E988F83EDD0422403087023FC7CF0D3FA7060CC0F2ACE7BF02A3D23EE2AF0A40AA0E8FBE6FD227C00445883FFB00193F89BC50BF5BE09CC0B2DDA0BF72A46BBF8E7D843F3D97C6BF417F79C003252CBF57A8BABF87ACFBBF2DC559C03AD0D5C09B771ABEE0B011BF5CC9F73F7E20B33FE5B993C004C00B40EA5ACFBFE4DB8B408A0D513F1F75EEBD3193F13FCFEB5E3F036713C0596FCCC0B8982640A308853C341094C0C7EE58C0CEB041402670ABC0342A57C04FEA083F38DF9940D0BCD13F256390BF2AFEABC0A48CFAC07652124074691AC07EAB513E64C8A8405FADBC3FC2F72F4097AD37C0702D22C0FDBDD03EA90F80C0EEE16CBF2CD50940CEC03540B538BABFC678893FFDF1A34067B5883ECDF08A3FAFE11340938D9BC03056BAC0637700403C0052BD97DF1640DA7C354093E7C64098FDB0BF552D22C08895A3BFCB98803C1A885F409C06113E9ABE8040FDBD40C0AD43124006C6C6BFD47BADC05C8D5FC05AF51840ABD705BF87A70DBD15081841CE167DBF62F8ADC083BE19C0DAC9833FA8C07C4030818FC0885F50BF1C9E87402907D03FB44BA0BFA16BEDC0CA9152BDB4948BBF2FBC22BEFFDB0EBE14C63C3FBB46713FFC297540EBD7EA3FE7292340BB892BC0838B13C0E3F7A8404BD8B8BE6364B6BFA0BB68405700454088685ABE3C7C23C00F3C8E4044305540C2B567C0F26E2AC054760BC02E3A1FC0C56036C0127D0040E0905440093B7D40DC2D0F40C55BB73E7A064440F0F7073F16220E3F311EAE4017F218BE79CE0ABF5B50073CED2D7C3F970F6D3F099BCA401A830FC0A371B9BFEA5499C08D09E1BFED997B40C5A2AAC07AD3874002F575BFB83BBD4055A79CBFCA132DC0604CAD4017971B407C6CD93E4530133EEC5E9D4093EC2AC0F1AF39C0537501C023CCC0BF1F8FF6BDFC748B402E1B17403310403F54A910C0637BEBC0A6188C3FF129B0BFAAA1FF3F8E9D8EBF273D8740F025B7C0B3986CBF001E9EC09145EEBFB53E143FBF09963F76BE96BE9A52A6BF6A4AC7BFA56E8E3F016F4FC0FD0B01407D26D3BF0E270ABF34E2B8BE089521C013E4C2BE53EA81C0805D5DBF82FFBCBF74094DC03440D33F71C4EB3E95808C3E9E457D404BF2BC40D3116C40E905D93F195406BF4B7B0E409A9C0F4096A55940490436BFFCBE1F40A85B62403FE33240D50A7A40BC5D53405AE7FB3EB4566A3E2D3086C07BC063405BB21C404C7B9D40935381403E576440F6994BC045E174408315D8C023D1EFBF4DEE1A40CDB59CBF6A2A4F3EE8B862405FEFD040B61B77C04E5F0AC184A278BF63AB323FECE024C045D2E0BFB11322C0DF492EBF993B1FC0F58664C0675A873E4BF999BF1669D2BD2A05C3BF171BA93FB08D943F74D59D40CF6F12C0420D2DBF51671EC076618ABDA65BC2C0608D493F0414C83F8F85694009186BBFCBDA72C0BC6AB3BFCE5F9BC0373FEF3E567A55C022441B40524272C04343C5BFA16EBDBB5D6974C0960151C0634027405B6AD7BFAD5385BFCF179A3F3E67C53E8D45B9C059C04A3FEE7A39C0A3441DC0BFFF59C0DCBDC540F2D4123F32236B40000E1DC01F1C8DBE7B0C0EC0CF2331409B69D6406AF6C8406E32874030AEEB3F27CFEEBFE8B84B3F460833C089E4D7BE50E0A23FD19701BF6573E33F14FEE940541B7240F09A93BE8CD8BCBF48C14640033E973F4E9CB8BFACDB5B3F443B9E40D6C17D3EE1ED51C0F9F750C0A91D8BBFD90D87BECCE48F40065877C0942A95406224D040BA0C6B3F738E5B407C718F409BEF26C03C0D493F3934D0BE49E599BFB4FD3FC0D43F10C1581351C0140BA640E29B2E40F4F605402D3AEF3E50B0973FEAF5ABBF84EF413FD03A3C40D14E3FBFA16AD53D756A86C0928692BE30A09BC024A66C3F28F2A1BFBDED5F40DD2455C06CD783BE47F67A40B05851C0D93A10401F09FC3FC6771D3F7FD345C0D2CEE8C00A48E4BEEFB511BF37B822BFE3A185BFBEC872C0D171BA3F9A0F0DBF45A49740C411D2BF372AB2C0AAD8B4BF92D19EBF772B1D40AAEF4DC0019E1640FBC73A3FFFBF3D40BB67DE3E1E9519C098CE16C0D8C367C0A9318DBF11A927C099FD01C0DA5552400A749C407DB3124007B76740827B5CC0B9F96840E4041EBF1F05C73F51AA3540021C7DC02429AA3F2E9C3F3E71D63940FE2A0FC0B2A144BE3B41BFC06D4F67C08F0BB53F67C0C03E7DA9EABF046B1840F7C248404D273340B529AE40C4C706C0BB92A43F9FD947406BC9F6C0041212C06AD7D3BF18E0F5BF19336A3FFB7EB7404AB8B5BF614DFABFEF5EFE3F7CBA483B42D2553FD82DFEBFAF58C4BFDFAECCC0D64541BF058E2740292790C092C43B40998C7BC0E7834B403DCB8FBD7E07963F1159B1BFA10BADC067E826403E6AAAC0FA8323C06CCF1B3F1D399F3F4B310240E28695BDD9F6FE3F2C516540CFE9704068E14FC09AAFC74005A43DC098C1D0BE0E7AAB3DC5C0E0C0406155C01EB4A6403F0DA53F83B291BD161AA1BF8E47E33E6BBE79405717263FB5B293BD0B724C40DBDEBEBF277DF7BF38C7DABF0EE90740B4A419C089305A3D90A82ABEEB031BC0D42F7A40710D25C09B0CAB3FF4A0BE3FFBAFD23E31F531BFEA8138BF7D1C4A408F5E983F61BEB7C0E6500D406E2235BFCCC511BE182B824070EEF33FA16C8BBF72FB2EC027158140645D973F"> : tensor<2x3x9x10xf32>
    %1 = stablehlo.constant dense<"0x39D09BBF636E423F0CEF28BF230FCF3F7EF40BC0D696C5BF36309DBF0CBA53C060D72BC094FF38BFC445864067AE92BD2E1FCA3FE6DB2AC08C28BB3FDAC23740DBAC7AC006AB4540B0A749400A3561BF3610AFBE070C673FD56C2D3F585680C04617C4C09F7E864015F09C40683181BEE69CFBC04CE54DC0FF580040F30DC9BFBBF23DC04035E0BF7C3DBABE39BDB53FEA9FE0BF0DA605C0239E1140CCB709C0C1F03140A337463F28952DC0AE7ADA3EA4564A40005D5BC0B65700BEF8C9EDBD1910623FD2591D40C4C627C0B742243F0051623E5532C03FA8C854BF824B984090F2373D9AFC69BF2DE1E6C0EDF730BF51843ABE4D0731C0697501C09F6A983EDAADF6BEDA37B54079B8DD3F080D07C09C874A3ED99D273F18B53440E3FA9F3E905997BF4A32EF3FFCD57FBFC99EC3BE16224840F1FD56BE26990C40328FBA3F96F020C068B316BFAEF256C0490E3BC031C2C2BF51867FC028D48C3FE44796C0FEDAD73F4BD70DBFEA96A3BF4511404085FE5CBFC53D7D4039709DC0C12103C0A2B3E23F908B1440174A2E3F51F3DABF03F1123FE2EF6EBECA51BD4035D25CBFB8A536C00D287240352F833F2F3F6E40E3AED23F6BDFB73FC4660ABF2FFE1B4034A35740F63AECBF222F40BFECD713C06F5FAEBF4C633E4001599BBFB74A9DC02F66973F688139BE6B4FDABDE433D93F79A812BF889A3A40C365E4BE1A4285C073AA443EE09BA4BF812242BECB787540E8CA32BFD0B6DB3F8EAC4DC0E3E242BFB51FEDBFA7F345C0E2B2B1BFA3F27C3FFBAABEBFC70A014065355C403A80F93F15B265BFCE84C8BF8C3453C034DC76C078BD2240FEEDBCC0EAC984BD703A273F6245CCBFB72EBF3F2F8ACEBFCC503C40CED5F13E3C33BBBFA5DBEBBDD3857B40EFC536C0A085B4BF340F83BF3F32AEC0778AB13ECB18993FB991BCBF18601C407491C03F9AA1FA40D2A20DC0119296C0D945C83F26A401C0FF8D663E676630C06FA0C340A51EDDBFCAB44DC0B0303E40"> : tensor<4x5x3x3xf32>
    return %0, %1 : tensor<2x3x9x10xf32>, tensor<4x5x3x3xf32>
  }
  func.func private @expected() -> tensor<2x6x6x3xf32> {
    %0 = stablehlo.constant dense<"0x63B07442276CD3C2B6E400C206ED394199EDB442F45D74C158C581C2B9330442172DA5428801F0C12AC92B4350BF4F40C9B98DC1FA558742D83BFA42EB9353C27F76E4C2069707C15EC343C2D01284424E310EC35F8790C2ECE8E740AE9247426E15FEC264818542E9797042B26106C2FCBBB242A3B61C43C01A0AC2A0172DC24A1D15438917ACC18C1AD7C10E2C4A42C054E7BF3E9AFEC264E31A4120A51241397CBAC221648A411B8192419AC9B5C215D0BA4241D177C24168AE42A20BFCC145E590C244B9E042B8D6764261EAF6C2E8B72243639D50C25DCC0742C8CE1EC17CC9FF41D22652425C1F36C22EAE9241C9C104C3AA77DAC15EDF544268D612C12E8FC5414E53804252FE7BC1940FE5422CCF39C10B2955C21AF66441EC7B1341F39F92C28011F1C14E0876C2B97A97C2896F8FC2FD1B3A42C42BD141CF010FC2B0BDF4426D854442E49404C283F2CDC29D934FC2E07F2743447A0FC3BAB194426B315A4290A22CC29C10BF4019A7E54118CE9F421A9E244230BAFDC1C8088AC1ACA88141575B35429CB9914140D88D42921F2F43DAA691C2C69D09C190C2954206F9FF400B4417C2FE97B4C2FB248C41BA2BE741C7BBA7410EE590C10C628EC03CCDF54130F667C0B37292C200879EBE9076FE42F63507C35A92FF41C41F90C08899F2C2D818FD41FC464842B91470C29DDE1341999C02C25CF47B41833DF2C1586B6D402072DB42CCFA1642A4FA2142CA286642AC29C64228BC4D4002A8CB40CE44184224B51FC39CC016C182731D421A9BAE424F11DF41199624420BFD31427745E141F7496FC2FC058A42B62C9B426061FB420090873D94846D42EDC28E41DCE6174263BB3CC28C8CD44136C86F429A0ECE4234BB3EC20B1B6FC27C1BAE4256407542E8EA9A422926A7C2EC91534270CA7E42E4F82FC2E01299C159645C417BC803421EC99EC182A76DC162FD5C42D1162641138193C0A2CA47C16E9A04C3F9AA8C4050BD9C41E1DFCE42FD0FB5419023C9C2387206420F57274228CE8F41D45A86416B237642E9C25B41B285E842FCEC31C0BF993DC21B7133C23CA6F1425DE592C2E4F381C24F88A442200AED3F240D68C298691B40F6236CC09357C3C04AF0FAC1910379C276C3E74280976C3E9C1892C250027F42EA968B423CC157C0AB8F654138D9A0429EE9ABC12066BA4044866042747CEBC01064C3C0B0B346C2"> : tensor<2x6x6x3xf32>
    return %0 : tensor<2x6x6x3xf32>
  }
}

