// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x9x10x3xf32>, tensor<4x5x3x3xf32>)
    %1 = call @expected() : () -> tensor<2x6x6x3xf32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, 0, 1, f]x[0, 1, i, o]->[b, 0, 1, f], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x9x10x3xf32>, tensor<4x5x3x3xf32>) -> tensor<2x6x6x3xf32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x6x6x3xf32>, tensor<2x6x6x3xf32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x9x10x3xf32>, tensor<4x5x3x3xf32>) {
    %0 = stablehlo.constant dense<"0x836AA43F9F2D7F3F589301403D4BC8BE9FE63540A933D5BD4CFDAEC031EBEA3FD83038BF7D5621C077E29BBF138CE33FCC53233EC175994098DF043F0F878A3FD16B03C0C76E663D42BC1C4076A40440C7C2C6BFC379C2BE413294C040659AC06A3F7D3FF8B042C0A2A16E3FB25A03BF197EA8BF005A993F42306F40FB2590BD4C67B93FE733D93F4B2D3FC01E28D4BEFD5BD5BF1A970BC015266140278C0440F12C2A3F3796B2C0BD13B93FFC8C84C018DA51BFE6250B40AA1ACBBFBB4084C0081D4EBE93D830C017EAB7BFBC86214013B22EC0539FEDC0A6F9EBBF44B3E33EABF4803EF3BD214069784D3F4DB650C00C2A984063B92340AA54A2C006748E4066DC0940DD7D79408A54ADC0936981C0569D9A3EE2E5A13C336382400B2E2AC0AA1739C04B84D83DE5CDB73EA1187740D67D74BE8F47FFBF0B63C63FCA592BC057939340BB06FD3FB23E403DDA1F5640006F93C0419EE4C02E2B87BF7B9C33405EEE9A3F44640E40CBF291BF08CFB54099B35EC04FBBD33F635B353F394182BF2DCED43F2735583F0D99833E2C0A81BF5A8DDFC0131308C017183040DF5547C0B9C20A3E3B43883FF6BF83BD0B30B8BFDD8D59C0BB4948C011DEBABE422205C0D3F701BF1369DFBF781E793F35891FBF36DB53BF9B598F3F51B0EFBF775E3ABE3FC150C0AA5291BFC781A0400F533CBFBB17973EE66FD1BFB2DFB33E96EAAFBF3C4E8FC04F07A53FFD705BBFBB0BD34035DBDE3FC89BF6BDF135413F3B0103C0283726C01786503F8FCDA0401B6985C0699E45C035AADCBFD8C878C0BA2DFC3FCE8DCF40E27DD0C04E8C3FC046E404C1CA8F61C0F11AE4405D850A3F0AA47FBF6602883F1199823FA43061C0B4EE4CC0F615C43E7D8BAEBEDE13754087F538C04E993BC017845C4060C5C83FD555243E0E9AACBF1E4D4D40B6A9244015AE44C09DD12540549FAA40462E31C0FF21F9C01392F7407176BE3F24868340517F854091F91E3D6CB7A33FF30EFBBF008714C0913B96402610373F8B76EE3EB4C147BF21A377406FA51BBC6337B1C0C9D9134004F552BDA99EA13F56081EBF54C39E3FF0D4BC40647C3340566FEE3FC814B140551E5B402DD51CC02CC034C0AFC45E3F30D6AC3FAE7E8ABF8741973F26591D40BBC969BFDF814CBEE76240407B5858403BB619BEEDDFE5C0ACD087C0A25A3940FFCA23C087ED86C070A1BFBF01110BC0004B813F33801DBF3993D5BF15CCD8BF10B929C02A54B0C0616886C090334E40E2DE394030E93A3FD0D9F73FCB01C0BFB72A1CBF8F92A640F8BEA740A46D52BF63FA4C407CF4263E79DD0440F333DA3F5605023F8571233E71866AC0370A3DC07579893F4A972C40388E3740681E163FBFFE9ABEC0E406408A6FC8BF849B8E3F35F28F3F2BEDDE3B0B660C40032F4D40DA02F73F637E69C006D89540B4581A40C646CABE92813AC0131D04C066009CC051B8E53F1C818BBFDF1214BF150E013EFE11294169AF01401F8BD9BD0CD14D3D2910413F754FDEBFCBBA3B40B1385CBF801869BFF79DB9C0F18C04C09D2FE13DF0285ABE64BFFB3F1884F43FBA3C9C3FACBCA5BFDDC3713E6708BC3FD127DABE6D0585408B96C2BEE151A73FEF9E10BF4628C2BE39018CC0D02D933EE5A56C40AD4793BF75091F400353C33DDD51EFBEBDBA0AC0A359A340866AD5C0D23A15C047345640185595BF62028B40B1120B40D9CB263EF94927C0A479B23F8F9CE5C066CE92BF12E43C3F095B3CC0386D96BF2084C1BF2CD1ABC004377140BAB29440D3FFED3FD97EBA3F95E0B03FAB18683FD05B1D40C6B19240D87C61BFA0F6603FA7088EC0F9F0E2BFFEE7A33F399AE9BFEF0608C0AE170EC00C9D1B40401DC23FEDE42B40DA441A40741926BFC6455EBD71229CC04AA94C3FA33EBF3F46815F4089FFD63F25EDB0BF2CC723BFF3F928C035422240BBABDE3F64BE164009C2A240B6CC813FE1C8F53E3325B94046261AC0DFF75840E2DD8C3E5339903F10E76FC02E966D40046AC6C00F7A98BFA93203C0E6DBE03F426187402A9C58C09D4C1A40ABA4A5C03E9C13BD6C56053F6161FF407E134540BEF4CE3E2E77EE3F47BD8040F0995BBF266EB13EEB10E0BF540159BE781F86C0B74C553F26EDA540520C1CBF5C3A4D406BBC50C06DA964BFE3379740921270C09CE1A7C07EAD34BF210679C0FDE47DBFAE9D9F40562FA53F4B4B9E40598E954063980E40DCD3C1BEB2CAC1BF6D5CA340A04182BEACA0F3BF4CD435C0C014C93CCC87DDBFE4DB864034097F3EB82B9CBFAC15833F57D22DC062442340BE5A2340B5C7B4C07D105D3F67EBBC3F7A3C79BF59A18440F139C4C03DE6B5C0A32C2C40459CFDBF167A593E8E4921C00BA59FC003FA1640FF9E3AC010CB903FE8E0A54094FBD0C0DD92AD3F63893CC0AA29EE3F5261684067F9C33FD1EA4AC085618A3F0A4119BE2008E23E60AABCBFED72EFBFE89484BFDAC6AF3FCDA48A4070F716C0FC62B63F4CCFA53F5865C13BFA4C9B3FAB07C7BF9E76F4BF8F9FE43E09A7F33F527B36C03A78DA40F5805A4083FCC6BF7F729A3EDBC625BF8B643DC0B4FEAAC0820558C0689668408881CCC04AFBD140EABDB63F57D385C0B733053D3AF88F3F000E2AC06A338F3F6A2D28BE02F4CEC08AFE22406FF3D940EEF646C02CFE514019297D3F81618A4044F7A63F2ECA843F1C83F4405E1215C0477F33404CAC77C0F8B3A43F46B3244086FF20C036098A40948F9B40AA186CBF27E6C540CDDAC9C03C37053F60B021C0460FBFBFF40E14C0B4CA22C0B6136F3F2834413E39457C40AC9C8C3F13A888BF600333C04BB8FEBE08440340251A23C05A9E2A40AD9562BFA9D58B3F4B6128400C2A2D4084D20AC0B422593F2EE4863E9445543E4A92CF3F2B0A48C09125DCC041E551BF1B412DC077E976C041D61CC0E01904C03BA5434042AEE33FC899A8BF4E92D14030897C401033B4C0B66C69C0B448733F93B33F40009C35406480C73F038A383F6B587D401BAEE5C0DB97BE3FF9538FC0A6C12BBC2C52DBBFABC185BF3B4A0EC0"> : tensor<2x9x10x3xf32>
    %1 = stablehlo.constant dense<"0x0D7298C09F2CC840C834E2BFC46582C0D79238404956A0BF1EF80EC0A014BFBDC155A03F393A48BE9B9EE640C5D0FEC03D8F2EC095FD5EC0B81A813F09909C3F721D713FAA2F57C01B9B5040C6D238BF79BF14C0D113ACBDB2908EC0461DCBBF699355C09C52444037D516BF711786405EF89AC01DD167C0AD445BC06B2D8FBF071FA34049C03DBF8EB312C0462059BFB070AEBFE8C35BC06B39E7BF5273D4BF331AAD4049A083BF29C6BD4034BB8DBFB19D5AC0A802023EFB91D83FE07E234047EF67403DC3143F78B05BC00C552940045E6440C6A427BFF050B8C0CB2BA83F365812BEDAC8A6402FA9E2C0E84917BFE9A55EBCE332E7BF03D38040DBD591BF5A0C8CC0FCAA20BF1A58843E8EF84DBF71386DBF3167DA3E8AF1E1BE1CCA9EC0A518A8C0A044C23DF8320140A38319C05926793FDCA604C0F8BBBF3F59C936400C0DD3BF4A881AC0D5DED740199285C090C0343F3E07C7C01066343F40ED90C07D5CCFBF1D72994094A5C8BFF1A992BFBA3701C0B8A3ECBFA0B4564099541140C09D0140123EB83DAB6E444068834440ADFA633F567B71BFED36C2C0CA6509C0262D0F409996B2C04E7E09BF8EA05A40F7AB48BE9BD91EBFA42C5B4078CC2C40C84763C01308CFBF6B187440C0D042C01AE3A53FF69B6B3F9736A7BF2CCC08BFD888FB3F9B0FF1BEF1298CBF85D8C44099E98C3F20A7BA3E13BD9AC0E5D65A3F79559DC007684EC036EB0AC038CE08C0D7BBEC3D35C1314004D486BF94DB36C094F256BFED76C53F4D98E63F175B0B405665894009F60940DF431740D4B935C03F7507C07223404093140B40495D2F40EB58FF3EC7C2033F304AAABEB66C3FBFB3442F3F31EAAB3FA1F239BFAC17A6C082C06ABFB21AD73F93047D401048C7BF3C4E1B3FA35038C0D217D53EBEDC1AC01D6AA540F35777409D17EEBFDE7CA7BF2AF774403880D2BF4AE5593FEC8A8A3F12449B40EBEADA3F3EF494C04EFBEF3FC3C688C03167C43F15B84C40347610C0"> : tensor<4x5x3x3xf32>
    return %0, %1 : tensor<2x9x10x3xf32>, tensor<4x5x3x3xf32>
  }
  func.func private @expected() -> tensor<2x6x6x3xf32> {
    %0 = stablehlo.constant dense<"0x50E417C31D310B434E86304236D58DC2FB6806C2D003E542CCF2A2C0177599C2686136C2C98CB0C204BB01414AEFB5C010C35C4228CF184153562E42E003F4C1681176417841814156F5B4C1F9FB4E4250ADD5412CCC2442A6D65242AA8638C2B0550542BFA51141FC42894264B8EF4177163641A8976C40A8FD3C4278628142A6E681C26E7D12C2D49F1E419887774103B093C1E3651443D9967CC2CB46A6C1B3E593C13C10854256B7F4C1974068C288748EC07A448C407DCE60C220B518C2003BDF3EDCE4DC42EBE7C2C1783CC242088B2043CC08AC426F829C4209F8B6424622ADC18659C1C182C510419F3F91C2AF1982C1AE661542384D49C175036A42961D5542A252C741BA53AAC1E3A91743F375BEC167C695C2DDA5B5C28561CF42DAD03CC2DA5AD2C1942F02C33E9A39C2639730C11B72F1C125C13FC180E4C63F48802EC17D0B1142DD1E1BC3DB2D5A41B8609242166AAB407ED990C22332FD42EA096641FAD779C280E04740AEB5CD42F6A1EB41DFA85341B1EB7642E5B480C20C210241D081B7C27F0988C2B35BAAC098A43BC266CDEB416B2344C290B29C4236E420C1FDFD94C2EF9297C2ECF2F0415CC63A41F05FC140B68BBA4239D20BC290A76141B7DBBBC079DCC0C178380943812C934224CE7042A889A840301F65C2F8C2D0C1A782A2C2C7D61E420F201B423B228EC19E008A4193FEC2426A61E3429BD22EC2803B443F87CF7EC1F9E58142000049C2F0272B42D7AA37415F999F42A2F5B140964BA1C0F4AF0B43383D4BC200FA32C158572EC0AE36834214E0CEC1592214C22BED994218D345C2B13883424329B4C254B95A4107DD8D41D6D64642A1408FC2E41604C2B82A8842BE058641898F87429C3F0A42A686444204D6F640702EFA4054F514421AF9EFC1725940427A3BD3C27CE0F1C2F878724140EF4842F0FD5C412841B540287119C3071962C0C0B470BF0D7486C25C11E541FEFD4742CAB9D241C21EA34268C2C242B28FA4C14E2EBF41D43F2E4199BF00C21EB12C4228047141FAD8C1C25453C6411F32CCC26BC18342264643428B435842FF75D7C11F906B4200A758420961A4C2AE252EC217DF3C425F047DC2A630A3C1560E94C124CEC3C1F7ED9742262BCEC1786C20C2B0F53342816AB44138D7C4C03548BF42F7E80AC17AA0EAC19D9B5442ACF51840642816C270E0E34136FE344238A60D42"> : tensor<2x6x6x3xf32>
    return %0 : tensor<2x6x6x3xf32>
  }
}

