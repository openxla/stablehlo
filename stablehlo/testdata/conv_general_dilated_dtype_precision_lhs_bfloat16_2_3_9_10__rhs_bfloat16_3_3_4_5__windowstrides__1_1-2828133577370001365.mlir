// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>)
    %1 = call @expected() : () -> tensor<2x3x6x6xbf16>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64, precision_config = [#stablehlo<precision HIGHEST>, #stablehlo<precision HIGHEST>]} : (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>) -> tensor<2x3x6x6xbf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x6x6xbf16>, tensor<2x3x6x6xbf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>) {
    %0 = stablehlo.constant dense<"0xA33CAEC073BF6CC0FBC0903FB73FC3BF2D4062401C3F80C03A40A33F6B4009C0A7BF05C0EB3FC940DDBF043D543F97C073C00BC043BFBD4094409FBC56C0ACBF7C4004C07D3FC63FA8BC69C09BBF91C00F408F3EBA40A4C0F63E0AC0D1BE31C0963F5B3F38C044C08D3FBBBFC94088C030C0E8BFF7BEB73F104040C06140F03F1440EDC08E4079C01F3FAD3FDB3F584013C0E3C07140E83F0040A23FD6BE4B3FD5BF7D3FA9BF43C028C033BE5AC0CABF92C0E1C013C068BFA140AD3F18C03BC04540A440F43E5240D0408ABD9F404D3F8D40023F89C0BE3FD03F8B40A1C0903EB13EA43F4CC0294095400F40DF3FE63D4640E4BE7B40A8401440283F91BE82C0244019C067C08E4029401340A5BFC8BFA6BE84C0C1BFF53DB4BF47C0BB3F8DC053BEED3E923FFFBF9E3F91C084C0E5BF39C022C02B3F0F409DC01A3F98BF06C048C0FB40B7BFD2C00E3FBCBF2A40E2BF28C02EC03C3F21C0624036BF56C08C3F8740993F2BBE69C0D7BF74BF86BF0BC16ABE31BFDD3F4E4046BF4C4091BFEABE3BC0283F4DC02EBE4E4044409CC06BC015404EBF903FCE3F7BBF98BFE13ED9BEA53FB6BF6C40654035C04F3FBB40A240173F1B401AC00A3F9E406B40A4C0173F2A3E2BC0C83FF6BFF2BFD63F7D3F1C3FF63FF03FE73F833EA5BFDDBE2A405DBFE73F42C052400FC0BA40F4BF18409C3F80C072C00BC085C0DB3FF6BFACC034406CBE59C026BF94C08F3D57C09840C03F7A3E8A40E0BFB8404C40DD407CBF33C034BF4C40923F24402B4017C0833F0D4037403C4031BFCF3F0CBFB6BF89C0BE40C9409CC057C048C0773F44BEC3BF81BD9BBF37406AC0BB405ABFC2BF94BF6E4073C06DC0963F9540EBBFFEBD85C0F1BF80406640C0BFFFC0D84096C0693F5640E2BF36C0AC3F603FCDBF663F9F40FB3FC93F94BF6DBFFABEE3BF0BC0CBC0B84028C0A6BD533FD2BFEDBF4FC0ABBEBE4016C0AE3F66C08DC095BFBCBF873F093FA1404FC0F93F813FD4BF25BFFD3F3C3F78C04F3EBE3F42BFA140113F8ABF15C03540363F663F4CBF6DC0DB3EAA4068C0F2BDDC3FB63FD7BF344074C05D40B83FE23F9BBFEC3E2F40803F81C061C0B93F9CC0274026BF0C3FCFBFC4BFE23D3D40A840E03FD7C0883F03401E403E4034BE0C4039C0853FCF3F2A406E3F5BC02E407E3FE1BF013F5BBF29404B3F4440C03F53C07C40583F1AC02F40E1BF07BCC7BE0D40D03CA4406BBE4640DC40C13FC9C04DC0463D6A4082C0B4BF37C09ABF533E4A40DC40E3BF94BF933E62C0EFBF4CBFEF3F6440AD4094406D4006C044C093BF3340A4BE74BE00C00C40A6BFAD4006BE28BF8DC0FBC0B8C009C0ADBEDCBFA3BE0CC0FE3FEC3DD73F4BC01440AC408D40D340C4BFFA3F7A4094C0E1BFBC3E7ABF7CC06A4072BF9AC0A3406CC08B3FC3BF9340BF3FBD3F173F01C021C01CBF3140893FCD4042C028C078C099401BC00CBF273D2AC07CC01F4049C07DC01940D23FCDBFAE3F12C036C1A440E73FF63F09406F3FB8404B3D1DC0"> : tensor<2x3x9x10xbf16>
    %1 = stablehlo.constant dense<"0x5B40EC3E23409C3F08416DC08CBEAFBF993F8E3FB540944008BC8D40A2C0F640C33F1340F1BFB33EF1409E404340044057C0693E253FFCBF5DBFC3BEAABFC13F25C091C001C0893F154162C0A03F3B40CDC0B63FCC3F9540DF3F21C0E1402F40DC3F09BE174048C0BBC0314001C0623FCD3E24BF3CBE1FBF563EDBC0F1BF814042C04B3EBCC0F7BF743F3D409BBF0EBE3CC0A340D63F82C0633FF0BF80BF0EC049C057C0E8BE2FC007BFDCBF4A40E33F3EC03D3F02BE38C09440EC3F1540963F05C032C0E53F34C048BFD940F7BFABC0CBBD1EBEB4BF6BC099C01340A640A0C0ECBD35C011C0683E7FC0E2BFC83F8D3E2B404F3F46C02DC08E404BC0ECBEBBC0E1BD96BF17BF40400840873F0EC09840E640C43E883FEEBF9EC034C054BEB040404052C01AC0FAC009C07A3F8B3F47406E40F63F54404A40893F24402A3F48BF94C04BBFDE3E1AC0BFC0673FABBF1DC01940F7C09AC0B3401740D8BEAEBDAFBF3E408A4073BE26BF"> : tensor<3x3x4x5xbf16>
    return %0, %1 : tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>
  }
  func.func private @expected() -> tensor<2x3x6x6xbf16> {
    %0 = stablehlo.constant dense<"0x03C3CEC10C41CAC28140C2429B42E8411543A1C2AB421141E8C2963E0CC29B42BE42084269C2AD41DD428642164231C3E042DF42A5C24BBF8CC215C108C2EF3F88C2B4C259C22143CB429DC191C2E1422CC2244284C21F4284C216C245C07C4284C28D4253C229C23BC2A8C196C1C4C2E9C123C27A41924273C008C3D1C019400C41A1422842B5C22B423B42C441B0C182C21E4185C24A420643CA426642A942474253C1613F04C207C37EC2C0C149C153C189C22EC30A4131C25E41BDC2C14067C2AF4228C36A417BC187421DC25E411CC30F4289426A41DBC272C2D542C542704269C180C1C3C210C20841F1BCFDC268C2EBC193C1E5BF58421D4311C2C1C288C2C8C02241EE427CC22CC31642D2429B4275412E421A420B43AD4191C270C220437EC06D41A741C9C19AC2C7C1A74203C1394229C2C142584175429140A93F9CC28AC2E84218C393C01942F04293C22B42C2C19AC2BC42CC411FC30B4049C158C2D2423AC0A2C21C42A7418CC295C265C24141A440A8427D41234296C1BBC1A6424AC027428C42F7BF06433B42A341FEBFD6C2FCC2AF4211C323C27D43F7C2FC3F4D4297C261423A43CFC2A142A7BD"> : tensor<2x3x6x6xbf16>
    return %0 : tensor<2x3x6x6xbf16>
  }
}

