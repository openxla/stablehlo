// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>)
    %1 = call @expected() : () -> tensor<2x3x6x6xbf16>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64, precision_config = [#stablehlo<precision HIGH>, #stablehlo<precision HIGH>]} : (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>) -> tensor<2x3x6x6xbf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x6x6xbf16>, tensor<2x3x6x6xbf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>) {
    %0 = stablehlo.constant dense<"0x134089C02D40D7BF0C3F53404ABE08C0174011C0AA40EC40F03E56C0454094C0EFBFA0C01F40313E1B40AF3EF73F223E284079406AC0D43E483F774083C0B2BEEBBD69C05FC021C0043F01400CC085C06DC0BAC08540893FD93E573F244099C0343FFABFCABE42BFD73F9F3F2ABF88C09140E43F83407440FC3E09C1CA3F0940B84037C08F3F91BF3F400FBE184004C0F7BFF63E6AC07940C8BF2D3F3F40544066BF11BFCCBF883EE7C06E40E33FBFC08AC0AEC004C184408D3F23BFF43E1340D93DA2404DC0F6BF97C0E0BF4DBEE540F63E54C02141BD3FAFBFA2BFA13FCFBE5240A93F10C0703FA0C0D5BF0EBF64BE5440B13F31C005BF91BF5B3E3DC0ADBF3EC0803FFF3F58409D3F7C40F0BF283FBE3F7CBF8BC059C07C405BBF0E40BC3FA94004C003412DC09E3F70C07EBF57C080C03F40AF3F98405F3F80C063C007C0D9C065C074C07BBF5CBF9BC086C0CD3E8B3F2CC08F40EABF21C003400C404040CB3FDDBF07402E3F1BC0703FC0C0DF3F95C09CBF16409C404040173DCDBF5C406F407EC0FA3FEEBF4C40CABF43403CC06AC0A7C0AFC0F9BFC7BF79C0E33FDB3F6EC05C40D24038400EC09D3E7640E1BECBC0BAC065C0E53FF040B43FB9BF9FC0A140D7BEC9BF0A3F23C0BBBF34403D3D3DBF7C40C9C0DD3CBBC0A33F84BD5240A53FBEBE3040CF3EC13E4EC00DBC10BEA73F41400E408E408C4055408E3E043F9ABF5A3F97BDCABF0A40BE4075BFA0C09DBF593F1540133F52C0F3BFF5BFB9C0343F613DA9BFA33EA3BFBB3E7E4007C0D73F5A40F73F403FD43F5740F43F38BD934003400BC081BEC0C008BE0D3F5840AAC0D3BE6B4059C04540B8403AC01940AC3EDF40CC3E66C0A4404EC0E43F8FC0673E3A3F2F40E93EEA3FB93FCB3E32C0674033C095BF34C038C01C40A3BE953E5E402B4067BF8F3F37C040BFF2BF7FC096BF243E81BF3CC0DDBF543F1ABE0ABEA8C0A440E4BF86C05FBFB23F253E053F314030402BBF42C0CCC05BC0E6BFA73E12C0353D06C088C0C03F7040B440BB40D83EC13FC6C0863F80406CBF76C0BE3F703F63C03940983FD8BFC4BF0140864049C0C73F323FB93ED1400A4051BD99403C3FDA3FF1BF744011BB4BC0A0BFFABE35402AC08C40ECBCA7BF9CC04A408EC02FBE6FC023BF3CC06340E73D1A40244019C0A23D9E40DAC08A40443F94C0AEBF7D3F99C047C0BC3F62C080BFDE408EC06840824099BFC9C0234041C0E8BF3A4014C01D4069404040BCC0EA3F3940B3BF1441453F1CBFB93F83C0BCC0E53F7ABFCA403DC011401AC010BE29BF8C4011C0553FB03E0E40573FB4407E3F05C0C53F893E91BEBDBF4CC0423FCDBF9F3FC7BE4D3F3240AC3FA13F97BF2ABF184074C02EC0B2C06EC043C0BF3F054019C002C0AC4010C007C1923F31407840F03FEF40D8BE5C3FDB3EE93DF03E1B406EC00C400DC063BF893F713FAFBF164084BF573FEABFC9405FC04540CFBFACC01FC1C73F0340A83F2DC099C07FC0AD40394027C0D13ECFBF6DC001C0"> : tensor<2x3x9x10xbf16>
    %1 = stablehlo.constant dense<"0xE53F81C0D73F30C0A4BF49409EBF37C0B2400F41843F68408A40C5C04440A2C0F0C0EC3F0540BFBFC340573F00C0853FA8BF9D3F26BF8AC012C09240DD3E9CBD2D4065C02FBFC4BE0B400BC072C0ABBF95BF7BC01BC0844013BF353ED64053407540B0BE4540D83D56C0F1BE0ABFCCC09B3F40C05B3E35BF7A40A54053406ABE86C010C1A33F0FC078408440AEC0E53FC33E70C0CC40C33FC7BF90400741483F414082C048C01C40F6BCBABF4D402B3F9F3E493F08C15FC0734003C1D740393EBE3E86BE8EC0643D44409640B7BF404002406A40B8C02EC056BF40C061406D3F37C07E4071C0BFBFF1BF25C0483FA9BF49BFF3BF1AC0E03E16C02040A5C00C40F1C063C018400B4060408C402AC0A6400340C74077BF364095BFBBBF9740204087BF91C05FC012C077C057BE13BFEE4093405F3FEA40883F3CC064BFF5C085C03B4031C009C01BC0E2BE943BDC3F594034C003C1D7BEA2C0C5BF3CBF31400F40D73EA23FBAC00CBF"> : tensor<3x3x4x5xbf16>
    return %0, %1 : tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>
  }
  func.func private @expected() -> tensor<2x3x6x6xbf16> {
    %0 = stablehlo.constant dense<"0x4B4238C299C1EA42B5410542B6C2BAC0D1C230420441984237C1663F3C4106C2C542FCC27D4164416C4227C38DC15242ABC103C30243F241FF41A5C2B0424BC29AC2AA428B4230C246C3F6C230C362422C4179426842254362C2D84243C210C38DC230C254C24BC2434309422543F84179429BC38242D04031C04B42BB40E8421EC28F4290419D42FC410A4265C2D0C2154238423542C2C16E416CC293C235C2DAC29BC2E8429E42FEBE4D421C43E1400BC11BC269C1DFC2804282425043EA42A23FBD42934274C11EC1C3C23FC2D3C216C3C2C298C20CC30BC3C3420DC14842DBC1174271C2FA4288C24CC23542C3410CC20442AD42A3C11BC26342AE4184C1C041F54295C09FC188427CC20C432942384113C2514296C1BDC2A2C14842F0C194C2BA423EC2C63F23C19CC2BAC1BF42A342364116439EC29EC24EC347429BC1DA41A4C2584278428CC2EC42F2C1DCC252C302C32043EC42E2C1A142FB400942B7C17EC367426D414CC28242EBC18A41FC420141D441DD413042D1414A4156C196C20FC2E4C2B541E4C121422AC29AC1AFC2ADC0BD42E84041C12D41E7C21C421DC30EC3CEC2B341B442BE41DDC2D541"> : tensor<2x3x6x6xbf16>
    return %0 : tensor<2x3x6x6xbf16>
  }
}

