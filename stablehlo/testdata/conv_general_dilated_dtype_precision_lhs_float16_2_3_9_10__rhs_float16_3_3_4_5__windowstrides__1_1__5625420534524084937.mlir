// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xf16>, tensor<3x3x4x5xf16>)
    %1 = call @expected() : () -> tensor<2x3x6x6xf16>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64, precision_config = [#stablehlo<precision HIGH>, #stablehlo<precision HIGH>]} : (tensor<2x3x9x10xf16>, tensor<3x3x4x5xf16>) -> tensor<2x3x6x6xf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x6x6xf16>, tensor<2x3x6x6xf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xf16>, tensor<3x3x4x5xf16>) {
    %0 = stablehlo.constant dense<"0xC8BBC6C47540993EF8BB083FA33CD93B2839A640BF413EBEC4420BBFBB3E9EB2EB3D2E3FFCC072C43CBFA0C4F344294304A41D3BC342A1457ABB253CF83C71449740ED3C7BC0E641E43AE13C18C20CA74C421C40C7C2CF42CFBE47400E4290BEBBC4803DEEC2B140E7440FC16440264631C6483832452045E438A23DEFC4663AC2C479445AC0A6B9DCC071B9E0391BC1273F4AC61EC339431B3BC8C3B0BD5DB3B041A3B5ED4025B0A3386BC03042ECC6DA3D5CBA264388C281B9CDC351BDAB332BBC5640D0C49EBE1843F9C021356C3826399644FC2F0B41E4C4933D5E413D3C3EC40A3B053C203C742DB9C62EC668BEF142F4C43FBD0CC527C07444C2C671BF64C019BB594111B5203D923E5FB5A4407DC2CC3B4C3A76BC95C3E0C0E1C6FB384C41A1BC88C56C44FC3521C284C0C9C00D442BC24F3D513903C35A3FA7406C3F17C366C333415D3F00BCC6BD4346BB3886C4994511C3A8C425C5704267C2FBB6B92D693BBA36A14566449EBF94BF4DBDE1C4F6BD5EC2BE45583EAE3C43BB1CC586BD54C1E9BBE33DAABF513DC6BE364800C291C5B4BA03C1314122C0EFC36044C941DB4126B83BC48D44F24034C3A93EB344A3BD7F41DE42753FB0B554AB2E32AB3F23B8233DABB93BB80BBE42C0E9C56EC07BBAA43441C449C4983CEFBCA143483B433FB3314A461DB1FF3AC4B8C9404ABE0E41543D8DB831B55733F83C2FB4C7473C432D470A4234449FBD4D421FBE1A3863BEAD3D7BBB913C47BFB7C29B40B4C1E3C4199F4240B0B2C44197351C442F34D138FEC0EE3AC9C2243D64340DC65837E64404BEF9B83BBDA0BE4FC0EF3F723C02C409A4483DBC396E409BB6C5C06BB294C1D33F7439C0424239E8C4B844F044523E08BFCE4423BC6E40B2B8E53E41AE01C0D13CF641603C07BB193E7C44D8C06FC4B6C46638AC36ACC3F341DCBB4339293CDCC58EBE773C5943CD42D4BC36C029B899BBD842AA4627BEC4C2604364C36D38FFC38BC59140414402B06B45883A88C02D439F3BE24095BC94BCBFAF2942E4420CC686BE63C51FBA30C07EB512BF1BC14DC45041A1C04342C93E4AC4F43CCABF18468EC19FBCA8C4C63F38C19E43B4381D36563E77C1E329BDC0E8BFD93E23BFB1C2053B33453ABC81BB35BF2839B8C563BA313ACCBE5645B0406BBEB8B850453640EAB99D40B5C5A8C2C13828B65842FC425DC1054125BE5FB017349DB98DC5F1C037417934FFC2164015BCB3C3073F23C1833C5742672B72C462C0E03E2EC0EBC081441F373940E83B84BE0A4208BB66BB0C3CCFC23641F8BF13AEEE41ABC4A93D4131513F034476BC4B3B4E3A32B027C1FAC569B6A1279CAB3BA4A8C0AE3EF242B1BE8AB58BC1F7B8C9B426B67BBC5EC0BD34E7B8193D1DBD944114C426BA3A3C0840CB3BA34486C4784425BC01BCF3C0E6378CBFFEBC91B122C2ECC48B425A40DA3CE941873D043C0E4279B4ABC16EBC0D37F640AF40803AE940C1BC273D853FBABE464047B8BF3D9E3682C02C42AFC0FFC1"> : tensor<2x3x9x10xf16>
    %1 = stablehlo.constant dense<"0xD3BA7837892E21C3443E493935C6EF41CD3F30BD3039B5420DC244445BC417C268352E34253A84C30EB302C739BB63C51343C03D32C5ACC025C5A73C16468F44A4446ABC2144363B1F42AFBE873CD7C0CEC207441644963F14BECA43193DD7C181C0474033C5ACC0DC461DC603C102464DBEC3358AC1C1B130BFF4BEFF3777C20EBD65BC3E445C44F144613DB4C064C121C06B4657C10643C3BC17461241E645D844EA4141B51F3CF4C0B53E2FC468C240C1E24253C252C409BA48BD91B73142A0BCBEBB07C47A38D7443D4529405E3912B43BBC273900BE36C5503CAB3FE13C42BF89B161BD393C5835F62D572AC6B8F0C4D8420C3B06B69DBC0646E43E6FBC5B43B3B1F1C3A63ADDC7D5BEE63410B5B7B24336FA40843CF7BA41BDEFBBC3B8C1C46BC1903FD54583BF98C1802EAEC43DC03FBFC3B37DC4AFC2224188317F3E443FAF3EA83E284060441947D5430E4088B78FC294C37AC10EB089BE8CC476B373C0E3BCE34330C4"> : tensor<3x3x4x5xf16>
    return %0, %1 : tensor<2x3x9x10xf16>, tensor<3x3x4x5xf16>
  }
  func.func private @expected() -> tensor<2x3x6x6xf16> {
    %0 = stablehlo.constant dense<"0x44525ED58B4F6DD538D58651B05612D43FDA76D3EE543DD5D944E9D16D534C4C78D4DA50E1D0065681D01D56CFC62D4F7CCFC0D5E7C78543AED2665111D0A7CB7C49E65046D5414CDB55CA4EE1D682CCA0D2003C104D21BDDF4D9354324BF1539150BA44A1D4E34C17B8B9500CD50DD01A5247D1ACD2E4528854E5D3B0555850DC4091C23DD6E4D9FDCCEDCD64D4C5D9DCD23CCBA0CF5F4A67D07CD214D7D7D4BBCD564BCD4B26D100379E4F3D52F933E7BDAF564D58E650884E2B4F6B564A4A3DD537D49458B9D86147E9CC4553B854E3D101C77FD62DD3A955E44934528ACC1D521451DD53CE4EA150285200D3C150404223CB68513DD20D54A7D557D2CAD3A8D4F453554DD256BAD3C1CCE4D769D31A5450D23D50A6D4D6CBA4D8B5D08CC8A34E9BD0F0561A521ED11FC920D5F449434B0C54B640FACDF24A98D01BCCCB3F48CE4ECAB857A8B1F2CC94D4EA548DD5BCC4834950D46054E854B6D133D344D289D1D94DD64B524DE044B44F694C034E1EC73DCE24550AD04554AACE42C6244DD64F7A4E0DD476D5764DB1D1D2D64B4E675590C515D2C7D1E252A855BDCEBC4615CF2DD189D8934AE0CF3ED3CB5069D3"> : tensor<2x3x6x6xf16>
    return %0 : tensor<2x3x6x6xf16>
  }
}

