// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>)
    %1 = call @expected() : () -> tensor<2x3x6x6xf32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>) -> tensor<2x3x6x6xf32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x6x6xf32>, tensor<2x3x6x6xf32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>) {
    %0 = stablehlo.constant dense<"0xE6CB973FD749BB3F89AD48BF087AE2C0EA8F1C40DE5D37BFBCA39CBFDDC400C08D250BBF69A450402A3F6A406DF090406C0306C0935C3DBF64BBD33ED0CFAD3E64BFB93E59812BBF66AF9F3F1AF1ADBFE9D3D23D70B467BF0970FDBE6BD108C0FCF2704021FF9C3FE7C6864078C9E4BFEECAB1C0754184409F298FC0C35BBA40390228C0B13FDDC0B6E4A0BFA9C2F43FBE1F97C0DBC356BE03C31940AA26DF3EF71791C07794AD3F2CE5793FF43A9F3F7398223EBD671EC092ED4EBFA326B33F8A3BDBBDD2649CBF0099913FFD5A884045089DBF34572DC0C6F4FD3F1AF9CDBF0BAC04409C89ECBFC7828540FC78F53EAC562B405DA432BF9E27003FF238223FA7A60EBF617B8FC0475177C043CD224005FB474078D192C06D05A5401810BAC0EBF0BE4079EF5F407EB3F8BF466BEB3E2AA00940D05D6F404DD3D1BF236F39BF76A21B3FF80485C067C1FEBFA4177E40BB67044035B591407800C1BE0CA5AE3D26F8EEBF970BE5BF5E378DC0E3F0953F0502904053CF8CC02B4BA63F70FF12C18DD250C0B9A076C0B278AA3E5B618BBEF1FDB1BD744A1E4090902440530BE3BF8F4EB2C05CD9013FF324BEBE41749C40E1C08D3F811581C093FD75C04C513140F98C803E66105AC0ACF810BFB5BFFB3F0BB36D3F238843BFD5F892C0CCB75F407B9FAC3F06BFBC3F3452E2BF5A402CBFF13FDC3E4BBF1540C7C487C0324B1D3FCC0A21C0ED16A940E2F36F400A7B3FBE578AF7C05C1C0440764A1EBD5ECB9A40CA4EB63F72DBE73D0AAFC53E812D883ECAC3E240947032BFCC6742C06659AC3F1E3DF83FEF9BEF3FFCC54E3F245B1BC02F0941C073F6A8BF1DD80CC05FAC2C40317718C052498DBFA6B5B83F450EE0BF19395DBFFC8961C0862A91C0F274063FCE9B4040BA9CC03F3CE1BABE4D321DC0A01324C08E767F4023370F40B3D4F2BFD5F96540D93C86BF40FD88C0B6FC9EC0F9E15F401C0143BDE3FD854055EC80C03FCC45C0FC5F7C409172F73E35D9993F58496EBE4C31D3BF4D13E1BEDEA1FA3F78E32DC0B4796C40BAC5013FF05A4C3EED199ABF3102A6407CEF2DC0AEAA91BEB3A2DA3FE18727BE6A208140D9C73F3FA32B6DBF417F6240E70C30C0F38DE64070289AC0FDB75040355E44403EB912C0DA7B9C3F777D95406ECC1AC1B849AB3F8BA7134017B967C069CF44C0FAA74FC0005A63C07686F73FB084D23E3F80BABE3853A03F4B8662C0809B86BFDF431FBF361F253FF8142CC0ED81963F01BF8B4046C37A40F12DBEBFCC205840B7CE883CA1546EC0E5A3A0BF3CCD8D3FE80CD6BE1077CEBFDDDB4540F56B14C053D42D3FBEE863C0311084C08CF31D3FE5F98C40F5792940DA220DBF41840CC03BD0C4C03F538CC0147D09C0C05236C0AC155DBFAEB092C0278552C0150A3B3D592134BF305B1AC0C7BA6F3FB770FE40DFC0983F787338BE71250340A206A73FE3D041C0960B7CC0687C28C0933524C062C129BFE4DE95C077189B3E8F120440EBE005BF5700AEBFB00DDEBFDE0546C0C73357C03C28E8BFDFE9B9BFB7032640051FA3C05E0C83C025AC70C04E1F58409DBFC6BF522171C0DAFDC73F2F0986BF45A9A6BFB610493F985E45C0F6104A409DA2C23FCFBC2CC0B74BD83F4734FE3F3D74AD3D80AD513FA6CF25C0F17EBD4020AD454042D15CC09B1CBBBF568780C0E8D0B63E45BCB8BFDA870741ECB64A3F43335D3E70629F3FB186CCBF69A303BFBCB0323FBAEBEABE5AA121403D372EC05C22BC3BBAD559402DA6D63E128990C00EE15F3E732681C05DE0C3BF8E53A6C05E1386C0D86F94BF8AA004BF0970CCBFF8233D3F64F3F4406BF8A5BD2B426D3F0D94DCC0C36E06C006909D404398AB403B4D27C01DD84FC0034A13BF4A8406C06EC28EBF231136C047C09B40DDA857C0AD081A40E1D153409D160C408B3E254089E80440EA5B8440F95DA63E77F4A6BF24C483BFA7E4A63F1A85E63E0F6015BF8DDB8AC09CDD4C40488E0F405EB0BF4084BF93C0100C60C0C9A9B4BFF71AC840628A30406BD7AF400D3B77BF7415A83F2D89F3BFF4FE743F2DC19ABC665D64C03D3B4EC063B8C6408C9A02C0BE76A63F5C8570C02B9E57BDE57FA2BFD270B03E057315C0FC4FBB3E11B741BF7E458C3EF2EC9A40459FCFBF5712603FFD0B5C3FA00BAD3F9C9607C06F24CCBF686709407A8DF6BFDF54624084DD6640C6A65BC00C0F4DBE740743C03470CE3F2DFD7FBFD8EDF5BECD243840A78B76C0B66AB33F7457FD3FBDE05E40424705C0B9A4A3409A273E3E23B2C83FCFD43FBF8887C23ED3E4FEBFC0CAEFBF340F6ABF94A7953FAC6A964069D8F4BF406688409A2D00BF90C6653F2C03A4BFA94704C06BA0A4BE759654BF9552B6C0918313BF0B3B8CBFABB292BEF9740BC06C1C6DBF2ECB3340834612BC8DD545C080590FC03FE72A3F7B91E13F338CBBBFB870B5BE5D9785C0DF8920C01DAAF2BF991217C07B8C694055B451403A9FD5BF93FB92BFBFA26FC0FA0AC13EE3A536403153F7BF41F810C092744FC0DB4E1FC0DA8D49404B58AC408180B33F687F57C00228A23FEB8C04C016C3FEBFA2267E401A219940EC93D7C0C75C28C05C7E983E89D078BEDCE1B53F9EC38640CE98A33FF40EC93F2E757EBF0E931FC0F3888BBF85978D3F887A3DC02E6210403D6AA5BFFE42F4BFF8E5DC40ED3F71BF950CA5C07FECE240CF72A73F32ACC3BE513599C097F5C6BFC24AC53EDBE1593FDA5ED3BFFD27504037791BC0D8B901BFEEE3CCBF07388FBFEB8171C0F2D8A0C03FBD5D40C8BFFB3E8BFB19C00C4AC7BDED2645403B5F813EC35C6FBF8E1DDA3EC44C82BFC0548CC0565BF33F8155A3BF5991CEBF336A4240AF7CF8BF76D2DABF93E39FBF1AEA6D3E7E0AFE3F4FF98E3F4BF93DC064246DBF2A452DC057F834402ECE87BF82F2B5BD8033583FB7264F3FCD92FD3E3A2EA9403F02CF3F3C1F5040F285C640F68E193E31F49DC0E87680C095197140D2C5AEC0F75656C018642B41C9651DBEAEF3A9BF663FC13F471D7DC00B8F0F4086FB3A40073FF5BF993AE3BE"> : tensor<2x3x9x10xf32>
    %1 = stablehlo.constant dense<"0xF2C811C0ADBBB6BF67BB6F3D4B7D65C03509F53F9EA62A407C5B6540955D26C02AF546BFF64180BF6188B1C04D623CBF4A83A23F880AE63FBB7301C07C9B61403B5AD9BE142D1EC022961F40A7D746C0DC7A3E40C037AFBEF0549DC0CB9884BED539B7BF98D200C069F5694070AF494095C7343F2FA66540D3E8A9BE4524A9C0804D983FB8E64F3E17FE87C0D38720C020509740C54C0F4084092C400B56FD3F088B56BF92D169C06E5A9340F2F9983DE2FF7DC0C37BEBBEBDB39540A0059240F7AC063F8DA86EBF1F8093BFB4CEF83E169FBDBFD21437C0BE28D93FA635F7BFE1A8F7BF574AA53EA62F3C40308276BFCFC0273F0908BF3EC55906400B1967BF368DF4BFF0C02440AB133240AD5AEF40BF1CA9BF854AFDBFAAAC11404461AC3FEE4E38C09045893F13E3AE40C149EE3F9B8FB53E7EC8A240C8FE7DBEC1A7D8BD4E3436C03C701740F993B7BEA60768C0F30637C0CC8E973F2B0313BECEDAA33F9F7FAB3F411E9F3F61BD6B40C1461640262BC2BF3699323F6BD344C0827135BE1617AEBF215FB83FA3EB8CC017FD83C09A12A2C014C604408801F43EBC0B00C00F5BB5BE831C94BF0B1871C0ACA10FBFCD1C443F983BB7C07DA82BC0AF4A78BFCED97BC0C4A7CBBFCC3B99C05AA07E40097BA0BE28D80940A98C95BF71A4D63FF7171DC0D287C43E4D49A7BFD5934D40A0D0053F8608B3BFCBC55DBFF05785BF533E97BF708C2F4082E3543D754707402E5205BF219619C036C501BF1D08BC3FA3569440FBF0E5BFA6960440F3544D3F4E13C13FCA38EA3F91C54140F79BD4C073601CC07BB85B4014E944C02F6C9D4027E70CC0B60A2FC0091B81BFEF2F4A3ED1A61340CB0A37C0B5B9E3C0F432C1BFFC8AAE3EF669834084FE40C0606F953FC1191BC08881EB3F63E0DEC036A35FC0431A6F40251F1540072E02C01079C5405357183FF3AF073FBD551240C148A9BF36F04DBFC62F273F8C3E523F8EAC24401AC1E9C0EFE1B13F65B931C0BC2A94C0"> : tensor<3x3x4x5xf32>
    return %0, %1 : tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>
  }
  func.func private @expected() -> tensor<2x3x6x6xf32> {
    %0 = stablehlo.constant dense<"0x34365541141C864275438DC18AB8E54214FB3942424FCEC2BA731CC1E4946EC26C98F44277E7A8413A68A3C0A6877FC2386456C148E699416893D5418A404FC27CD41BC3E49C7E42D04A5AC27C27104242B994424A9AAC42101F6E427091C0C1BA27E741E46E474298FC8141285348C2CC0624422B2055411C1FA142019DAFC2C48CDCC2CB03D64185D1AEC27536A4C2F10509C2F64309C23C9FE241369451C1686A8A407804FBC1E1BFD040CE978CC1B41FBA4141413EC2EE0C5942B62646429B490B42E819FCC2686B30C36E85844237A3D741CE310CC2107C4942F89805C1406B064187AAACC153D3484284713B412A82B142800C6E400EF6D241F57D8B42B0DBCD42591406C285D8BAC2F08C86C102FDBC426127BAC1E02FA1C20ADB0B42904AF84183BD0B42708BCB40D5B1C5C16869F541D78769429CF899415B809FC152B46CC246889341627CBFC20EBC4B40437328C162473D42A8CE0CC32CF80A430C117242418C86C290772E426958AFC19695E241A6DEA6420F667A42DD498642C8CCD2C27CB82BC255A436C230662BC0745367406EB12CC19B92B0C111A79EC2F38027C22A7CFC4178588C42EEC56A42971A3D41FB923D423E8150416C3D314265736A41CE3208C2B2E81B42609B38C1402AE03EB03339424BB74E415CDF31C11AA3E241ED088DC100A184425CFC38C2FA9F8BC149C7BE41A0E70140006AF6416F368C40DE64AE40603950C222A4A8C0527F60C18800E64018828DC2F01E1DC07C86B8426836DC41642CDB4080DE01C3CDDD05C2B637C2413714C9C1FBBE39C2E1809CC2555A104282599DC1E5F23EC23C0216C27FC3C2C1F0C90CC2EB50E9C1594E83422B1CBEC1A063FF3FBA7AA24148C529C1455057C111D0A342CEAE1E427AE171C2DD827FC2F94A354375934B42B2A59DC24470A8C1E095304054DA554212815342A28C9D426EDA98422656D1427E397A4262C3C0C2AAC05BC2F46D47C1451A83420C385041531821401A60EBC150A1D94202C07541BE2BA941044F8F422ADA80C21CB5A8C287801242E5A4FDC1D0CB2DC1BC143CC205818DC192CE54C2FDCBA641347D804190E4B5C27B761E43CE8BF3C1EFFFCAC2091B934170C682C2AD18B3C1902DC140A2949B42A359F2C1136F55C29C325442499298C0E0C77CC18020903FDAC4AA423B9028C39E8B30438D5CDFC1A641344220152E41F3A2D5C1"> : tensor<2x3x6x6xf32>
    return %0 : tensor<2x3x6x6xf32>
  }
}

