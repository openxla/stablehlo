// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>)
    %1 = call @expected() : () -> tensor<2x3x6x6xf32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64, precision_config = [#stablehlo<precision HIGH>, #stablehlo<precision HIGH>]} : (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>) -> tensor<2x3x6x6xf32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x6x6xf32>, tensor<2x3x6x6xf32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>) {
    %0 = stablehlo.constant dense<"0x01D6933FACBB84BFD0717AC0C22C893E2D45F23FB891274076FC463F7855D0BE911D08BC809411C03BFED83EBCD0F340B07A1640414256C0A7B3E03F35FF1CBF63667EBF0C06EC3E494EC740ED4998C0D1A74240191741BFA9AB02BF1BEB2CBF044A0140D3FE58BFAAD7CDBF91968AC07B75C9401D0828C100F3DCBF80405F40B6798D3D0B7537BFA0958CC0AF8CED3F7C9DD84063471CBED4C7DABF699BE2BEA2F4E4BF0F7D413F3A48B4BE5ECA55C0881088BFBE77873F294FB3BEA1D913BFF93C973FD8D293BEE2D8AD3F625943C0D4046B40606BEEBF1D7A90BF2A053DC0FA2F7EC0AFA7C2C07F84663F7A71103FC1141DC0DE657F4001408CBFC5D81A403ECD453FD8B3EC40EDF54CBF684C02BFE1EF3CBFC8FFA73E6CA88C404C6FDCBFC952C63F32AE9440114814C098FAC7BE15898E40C61A59C02EEAD540AD1248BFABAFFABE71875E40185AADBFDE6C053FF1D482407D2F4140F37562BF4948DA3FA6292C3FCA13C23D3CF3104059964040E9E8DB3F10F6993F8F278FBFBCFBEC3F9B7E76C08059FF3EE5588BC0123FD83EB2C9EBBEB3326440399249C0B801993F8D09E6BE8EED1D40D8360A3C1EF27EC0154B0E4050CCA6BF8B9F8540AE9A413EA6829ABF4665EC3FCCDC7540DDEE9D3F5A9105BFDFB507C00196AE3F7CF6E03F52739BBE78CBB4C0A9347740EDFB12C00BB48ABF35C3B2BF03759CBFA4BC114062A88140715D63BF4729003FCF558CC00B9F30BFD0CDD83F68531BBF8B1746BFE75CAABF53C01D404603B7BE461C0140F6C4CA40D1FBBA407C8F73BFBF6FB03FFA9535BFE6799FC017862240E914EB3F1AEF91BF10971DBF6BA696C014768FC0EA2245C0BFDA57C0D25197BF318CCCBFA272B73F5E8264403931C53F5A2C3A40864B393FF416ECBFC5963ABF50B5C5BFC37BFA3F956F65C0E3AA3DC0C42A0F3E7D54F23FE5E557C0EA96BABF7C9ED5BF70B65E407BEA8EC04078903FC43C0CC02D084440F857613D14568ABF267FA4BF3626A6BF2AB196C0123A2B3FA2253CC09D85B8BED0C917C054C55540E573AE3FB688A23E4341A6409918D240D05983C0E9664B3FEC79A6BEA2C8A9C068EACDBFB865C740C3866640EFCBC5C0E54526C0BDB6DCBEE8B383BF8D05AABE3C6B51C043152CC0B40FB43E653130C0EB6C8BC0B4DA0F3EB1A9CDBE94A0A73FB4509DC00B2AE5BF7D4233BFA34C2DC0DCEE1D3F56FA8140C4B7C840259F513F35A68BC08AFB653E1ABEE340E41420C0982E27BF3C189EBE54D574BEE818493FB8F1D440582ED33FE196F1BFE67FF9C078ADEABF7A4E5FC0665854C04841283FD8A6873E9D06183FCE4D20BF265B604052D57FC09B1583C0AD2370C0D9539F4009C19540E06526C0030CE73FC67CC8BE9360213FBFBB63BE92FF683FA8996AC01F7BB34013FD123CB94E6A3E6C0C92C05250643FEA4E9DBFE60EB2403AF566C02A716FC083DEEA3F83FED8BE32B6963F28B5853C67419440E6D543C0284AA8C09169FBBFA5CE1F405003A3404F4651406329B33F5D441EC04FE21C4031FC15BF067C95C0158DC93EFA064540DE2231C047425B408DE051C0C138D2BF0EDC81BFAEED90BEF6E8E7BF4ED2CDC007428DBFF94994C0DDFC05408DC7F33FA05D04C07B11A93F9A86FABF8E9E18BEAC408EC0F135BDBF00FFBF3F20FA5EC0BE72C3C0656AB2BF36BFA2BF17879CC081D388C0F4B33F40F0B4A6BF483A2840FCB1F13FB2A993BFEB1319C0C0D680C05E874D3EB95ED240B3871A3FCE1E11408CCA9FBF23D833C0A3C7AEBE9C941240472319405EF40CC0717F5EC08E0501C1ED8C4EC0443B894007DD30C0C502E63F6FE973C0038F6440604511BE8019003F7AD61440EEC2FBBF4EB8103F8B48B040CB4B65C0EA5A5BBF0D8A42C0F12E16BFD79E6EC0F3243FBF446EB8C03273C5C0D8DA943FD35CFF3FD1CE3F407D0FA9C0344B2640047944C08C7106408B9990BF9C8A17BEBB898EBF3AA1DBBF7C72033F37742D3F7B085A3CF3CE9DBF59FF163EC1F68BBE8DD994BFAA98A4BF453548401023E2BF6E42BEBE72863CBF706D823EAEC4BD3F8ECF453F15AF51C0BF089E4041903D3FE2D438C0644DFFC0B1F061BF6FEE7EC0A169BBBFFE91B53FA15E81BEA8076EC011FC6440348B9EBF31CBEEBE0FD658C0633833400DBB57BF07080C3F80A33DC007E000C1470ACAC0280C0B40CE8406BF78C676BFECB5A8C08E1CD4C025D2AF409D1DC43FE5577AC0E3A4963FB66AF8BEA73E7FC0C58FA8BF7CE0B5BFFD54A0C074C9FF3F42C731C07B9396C0D0830840E3CDDEBE7299CA3EC24D5B40B688E63FA24BAC4055045AC05F093BC0E5CC4DC01065E5BD9857F13F2987E5BF7DE218BE3418E93E114908BE606FE83F90ED903EAEFA9EC03D893ABFBBA6473DF2BE84BF9626613F624230405A359040A6F11240450B55BF5D83273F566FB340E02BA0403F02FCBF89F3EC3F8C226B4028A82EBFF3B3923FEBCF07BF1DDC094044718DBE056BC4BF16B116409501D33FAEC1A3C025D196BFE42C424029684440D3F096C036938A3F32D350408F7FFF40C89CAEBF2DCADC3DCF143D40BC6D7640203F27C0D80098BF39854E40274ED740F3220E4044CC12403C72843F16B61BC1E3C81A40600E1DC09E7597C023BFC43FA99619406CCD3F4021D5E7BFCFC6DD3E82E9DB3E05CA6B4079F1AEC017EE7A408B90FC3F2842B7BF55A7EBBFAB81EFBF2FEA0D40AD35A0BF54B530BFC804A24024E1A24013C789404B7F7ABF50E5323EEAB81B4061F495BE123E5840B20580BE135B6BC0E62C04C091145BC0A05A813EEE8C8C3F7670EF3E73200F40D2702340BAE98E402034BB3F0A3B0AC05D6ADDBFA4C735BE727275408A8174404DE014BE0FA7EB404A7CB1C0003CBB3FE4B17EBD89D146BF2D220140A7524FBF987A23404B0F823FBFA9243F772D3DC09130AD3F142B3BBFC10FBE4077EF10C0D5D70640D59A5BBF243B943FA78E57C08A7CEBBE50F53B40185B983F0B1E1C406C9DCA4024A13D3F4B0781C01B20933F92591EC032E90AC0DEB43DC0"> : tensor<2x3x9x10xf32>
    %1 = stablehlo.constant dense<"0xAD01C43FC78D8CC0C6CC1740065D15C0C1B3493FCD1ADE3F694BAC40F6F6F4C0CF3025407A3A13C01E46D5C0FB045F3E1236D43F1881453ECE3AA03F2EE04C405E40A73F6FF433C071FD694077721B3FB860B4BFA2360CC0397CA73FFFA606C03618073EC97E3240FD0D01405A9352BFC03B9AC0FC98F83E215802C07F2D0B40579A87C0A1B2293FDA4085404917B8BE6B3CD3BF5BF74040F2E0BAC0413CF23CA3C105C0C59540BF4CBD05C041C5ECBE1FBF4FC0E45B923FA6D5FBBF05040140226D9940229C6DBFB41B6E40EB8C584005197E409999EABCAF9038C0297C7E3DF6ED663FC89B3CC03A39A63FDBD18940A4E8694030669AC0B63A1B40F5E2AF406549BCBE3C0B3EC0FA62C13F045BF2BE01321C408825C2BFA328A93F5AF16EBF13180AC0EAD291C063C71140D5C98DC0C8AE07C08C010B404E164F3FEF64F53F65A4C23F49773A4005A292C0D01A663FC084303E2FD582C0ACD8D7C0D2F31C40440016C000403A3FD3462640C49380C0F39721C0445B8D3FF61957BFE185CD3FD0DC23C09F91CFBF565659C0CAB36ABD42C1A33FDBC05A3FDCCE2140A51827407EF16540F82CC0BE1F2C64C0818582402DF188C04311633EE0FA3DBF7EDEC43FBB9E0EBF18FE85C09022803DEAC77A40CF9A50C021134840ED83F1402DC3E1C06321873F70A331BEA0CB6D4048431F3ECAF696BFFB58D4C0622BBB40482A5140F0C4284043863DBF088539C0CBD4933F733E4D3F0F8842402359B240D94508405FD473C0CB80F33F3304D6BD178BBBBFB4E4104032EE4CC01A67773FA11B89402A73ED3ED2AA863EFB94A5C0596B04C05E93EBBF3A6F963FB73F3640D657623FE37F6E3E0EB0063F579BEDBFD1333340491D11BEDF511DC0C527823F3E1804C086C732C0B5A2E8BE187142C0A6ED2D4053C976C0C32651BFB8B3D23F0BBAFABEEA4BE4BFA6142BC0B4CE34C0CB48F3BF06CB4E3F4756D63F7846B8BE06B6A5C0FD41DEBF7156243E85DBF4BED6F564BE"> : tensor<3x3x4x5xf32>
    return %0, %1 : tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>
  }
  func.func private @expected() -> tensor<2x3x6x6xf32> {
    %0 = stablehlo.constant dense<"0x959229423BC61E4206DB73C26A589642D4EE31C2A113A9C26D70A5C2C04E08C28A7D56C2CCECE741C7408A42528D7742BBF19A414D9C04C17EE06B42CEDD21C2CCD11D415C37E1412ACB8EC2BC32B2C0B49FB6C0DE97EEC1EE7483C192A8384228849EC0BC3D8441A3291543286B9B42AE8DC4C2B44445C188361743590A51C21B4997C100D501C3AC2CF74219DD884260CA3F426C810FC2625F43C2FCC0AA40BCAC1A43A0D6C2BF13B5B2C2D7CD0342077C6A424A4CB0C254CF21C21701D5421C9B8042F237DFC11C7C82C2CAAF01C286A46CC2E4819C429CD080418A1564C11A84E341CEED1543C8E0EE40A89BA7C2D9310EC32C91BC40F8062BC130E258C22B820643057D0741643ABA4205ECF1411C2BDF421D979FC244B14AC25615A0C27A2682C09D0C2D42FDA769C21A41D641512ECEC0CA931EC2FA8042C254ED19C2CCAE7442B7860242F58A83C1F0F633C0011B0C43645614C226FB5D427041134295887742A3DCBB411000B642E23C6AC1464205C3E5E542C2F2660CC14CEB7A4036614442AC1117C1FE8DC0C2C39355C1160406414AD2BFC226A3214256EBB441228498422E1C63C15C096342F4995EC294EB2D42291782C2380E13C1CA5683C197BF9EC2B7025B42009E83C1C084D0424828E041083BA740EEB72443363897422EE83242806455C3C3844A42007391BF00D08D42DBE8CC41AA9A17436083E741EC2A8B420EB135C24BEFC2C246204AC2968B5AC255E031C21D7B0A42E84EB2C29033AB4226169A4154FFEE42A4AD63C276CE004254887D4225AC80C209F6054118088E4270D9EF427410284255E0FF41929301437DBEFD41ECCB8942C0C689C1FEF0CAC230B1D9C2ABE2A6C2DF860E42F9EBDB42B330D0428C2C2042EA707742023473C20EF659C1AE29BA421055B4422680F5C13D2386428A0919423C5A8E416CA258C190B1B2C0B92AC4C080B9254011DEB441CC275FC1AEC61E43000DAFC1552C75C20CB93B4213F459429FD8C141DE15EA4145AA6442087F64C294B662C29C4927C23114F7C10AFDE7C1E03C43413EB1DEC2F8E0EC419CD53142647D6BC263B51142EC079BC14D4282C2A86FBBC2820AAC40A8E1ACC00E6FFD405898BA42F4D250C2CC3284C23356254209971D40D1D207C2DE45BA428C4D2DC1443DF7C260237142B030DCC2CAC44FC25ABA3D4240C754C04C47FFC2B0142941EFC58841"> : tensor<2x3x6x6xf32>
    return %0 : tensor<2x3x6x6xf32>
  }
}

