// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>)
    %1 = call @expected() : () -> tensor<2x3x6x6xf32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>) -> tensor<2x3x6x6xf32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x6x6xf32>, tensor<2x3x6x6xf32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>) {
    %0 = stablehlo.constant dense<"0xC93FE5BF91405940A8BF62C099BF274090C08740464023BF5340CCC0C0BE323FC13E1B40D03E06BF2DBFBA3EE33DA03FC640F0BF44C0E040D5BFBE3FCC3FF54021C00AC042C0EFBE53409FBF32C0864033BF87C0903FC7C086BFD6BF3840B03F9FBF7440EAC007BF3BC09A3FB740F5BF87BD483F96C0584007C1B1BD283F2BBF084044C023402940BFBF934061C0204059C0A5BF903E5CC012C08FC0FFBDB3BF304054BF37C0D5C032BF81403C4039C04AC0E5BF1BC0B9BE97BF9FC0553F0DC016402E40BCC0334085BEA23F40BF8A3F644038C0B2BF504088404BBFB1BF59BF08BE32C0ACBF3340C0BF2340DEC077BF2D4063BE2540E640A1C0D4C059BF0DC089406FBF734014C09D3E58C0353F793F0D40DDBFFCBF0F3FCC4089BFCDC0D5BF9DC0FA3EF2BFF53F69BF47BF03C0574050C08BC053BFCF40704093BF884089408440DB3E7940084059400BC0EABF29C0564028401940BB3F83C038C0EABF844015C0053F9AC020BE0CC0BEBF97BE5BC036C078BF8B40ECBF1540953F10C0A240AEBF88C0E93F66409D3ED1BEC8C096BF7F40AE3E943ED8BF15408E3E03C09FBF4340D23FADBF0A41F8BFB440B8BF9DBE913FE7BF5FBFC13E71C0133E163E19C0994001C02AC01D417F4003C00FC07CC05AC0AD3F24BFB140C93FF2C0A2BF68C0F13E02C0EF3E4AC034BFBE400840AD3FBF3F95C09240D1C05F3F5DBF8BBF67C0A43FBD3FFABFFFBF4140D63E7DBFFEBE1EC09A40C9BE85BE0F400E41F5BF16C0A2BE4C3ED8BF18C010C0C33F0340973F40C040C03F401C3F24C012BF0ABDB4C0CABF88C0A34036403EC0043E24BFBCBF3FC08D400BC0B6C0FBBE97C0493D8740B73E5640DAC078403CC02F4038C0143FD53FBD4030C0EF3E51C002BFF33F944059C0DF3F233F7F4037BF28BD8340844006BF4CC0D9BFD6C0FFBC53BE083FC53FEBBE124082409B3F23C01EC010C070C0003FF6BFC04003C02A3F5AC0F43D0840B4C0B6C0463F62BF14C07CC0423F10414BC01C40FF3FC4BF3740993E944045C0CEC014C0CB3FA340F8BF693FA1C0ABC070C023C02340614095C0F1402A3FB53F58C0ADBF7AC030C0823FEBBF6940A8C0B03DB0BDA2BF4B4040C06D3FA140693F0140C24062C070C061BFB53FFCBF34400D40C03E38BFAB3F5440D9BF0B40DEBF0F401CC075403DC08440973FF63F52C0CBBF45C0D6BF524077C0BFC033C0904088BFA2BE9A3F6CBF3BBF8F4001BFFBBF8B3F81C0EBBF01C0A7BFEEBF86C0D53F60C056C024C080BEC33F0CC0973EFABF3140943F09406EBE3940B23F88C01EBFAC4084BDA2BEA8BF1040713E9FBF1F406740C53E883D93C0D3BF2FBEB7BE48BEB3C07DBF73402EC03940BABFB94032C0653FE93E2140F23F1240703FCFBFD8BF6BBFDCBC8040F2BD18C08EBE1340DBC0273F2BC0ADC010C0C0C0B43B604008406C405840423F7FC0A7BEA2BE6A4059C0AE3FD2C0F8BF68C0D0C00EBFD5BF7AC0ECC0A04085C0483FEEBF2DC0483F6EC019406AC07040EF3E"> : tensor<2x3x9x10xbf16>
    %1 = stablehlo.constant dense<"0xB44091C0BBBFFCC05D40663F71C078C034C03FC05EBE6DC00BC099C0283F30C0363F4D3FD43F66BF83C012401E40B63F8C3E2AC03A3FB3BF99400AC16F4013BEA4C0E33FB83FE23F873CB8C01EC06ABEA84061C0E5C00D40EABF0C40943F53C03BC01AC05640573D21BFB23F00C1B1BFB940B440D0C0E7BF79C027C057C05FBD52C00FC10A4046BF7DC0C1404E40DF405B40A0408CBEEFBF413F9A3F3F3F583F84BE53BF79BF6A4053C0B4C0144034C03B40B2BF24C053408040E83FDBBE32BF0940194098C0C240B1BEA73FED3F893F18BF5A4035C092C02ABF32BF15409D3E05BF8E3E58C00A40914041BFD73F9640674056C04FC082C0984029BF1C3F9EC06BC0B3BF34BF92408640B44034C0C7BE28BA1AC0A6C0B93E4F4011BFCDBF983F77C09A3FD4BF4040933F6E3E073F56C0C2C007407840BD409040CAC02D40FE3F383F873E8A403B40AC3FDBC09EC097C02EBF8140C6BF1BC0163F07C0CE3F45C03140ED3E53BF9ABF"> : tensor<3x3x4x5xbf16>
    return %0, %1 : tensor<2x3x9x10xbf16>, tensor<3x3x4x5xbf16>
  }
  func.func private @expected() -> tensor<2x3x6x6xf32> {
    %0 = stablehlo.constant dense<"0xD61E8CC22ED013C261DB0843022F0E420213D8C28CE26F423E5F2942D8782AC1B0FFC74240F3C7C1862F5EC280F295C0121EC1427239B24202DEC941EDD222C23CE3FB41A3D7014233DA9C426A998E42B4E009C318E1B1C14FA158C256ED5142F485E6C17D7A8AC2406D3B42CC9546C30EBBA5429041F542803948C062460CC3722EA5C2586D4EC168AD6142CC678442D05F98C2D13C9D4212F1BFC1BC16D5416B87CD42BA6B76C20120D0426071C64160E4D1C21A735B422214A0C16064D5C07E9B4EC39605C5C2C444A5C15C91FAC248CF474163F5A1420CDA61C27C89504239862FC251700443BE79DB42E08BD5417A6F5C4258BD02C33E96864242C44742348B2DC21250BF42FEFCFD42883198C1001A49BFA6D5CEC1F71C0DC328EF2842D0374DC1E89838C167B31643789F8C4071A1ADC2142257C22642FBC13496D9C2B15C0DC2B8110D42F3561AC2E43047C1EA4888427EFC35C390558BC2D83F89C2880C30C0BCC34441901CE5420C505C43200D2C4250ED02422E6871C26408B9C144CD9A421C301F4394089B4231A349C2379377C1A6BDB5428097B342A2F1524147AB90C262069DC2FA8755C2358CA8C2422170426A615742AD597D42F14B9942F6F52F425080F8C11E0BB242BF986B42D76C26C20BA250C256FAFF4156854F4212235942085BAFC06489D9C100004C429C3E6EC2247B1541CC643FC38ED4A34214C4A142F25C8742420DA8C2A74EA6C1220CF0C24CCEB0425A9ECFC21D922B4352774DC2A0C48241A0C0CD3FD99C3D423DB2B742A8616FC1C278B842B8F616C34A889D42E38BB4420883A8C22CD075C2F03DB242AC60D4C19048E0C115C892C2B8C859425581AF42CD2141425CB007C2807E84C13627354248CE9241B434CDC274E819C26E24B9C29538824298AE14C135AEAC42FCA231C109729D422023EA406E88CAC2729F8DC28800CC40A27974C25D8F97C2AE4FCA42A97EB8C210E486C2B2930BC3C5CA9542A86E2FC2C029473F1647CEC240347EC2127559C2DAC38DC1E09CE1425DEA0443DE1BAE4147B00342D3497842ACAC8DC2AC30B54215F729C2FB4F7942780EA842D80F2D403436CD41840CAAC2C2603BC2211DD0C1B2218DC2947CA7C177D472428F241A42A7966842A64D97C2C0B9FF41C817B8C1682B0442F0398A42A841C1402EC2D3C2CC43D6C2BC41FAC2932C3D42D79A9DC130B49CC2"> : tensor<2x3x6x6xf32>
    return %0 : tensor<2x3x6x6xf32>
  }
}

