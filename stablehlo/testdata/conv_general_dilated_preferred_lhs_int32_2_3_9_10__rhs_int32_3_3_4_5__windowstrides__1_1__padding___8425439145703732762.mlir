// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xi32>, tensor<3x3x4x5xi32>)
    %1 = call @expected() : () -> tensor<2x3x6x6xi32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x3x9x10xi32>, tensor<3x3x4x5xi32>) -> tensor<2x3x6x6xi32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x6x6xi32>, tensor<2x3x6x6xi32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xi32>, tensor<3x3x4x5xi32>) {
    %0 = stablehlo.constant dense<"0xFBFFFFFF03000000FEFFFFFFFDFFFFFF010000000200000000000000000000000300000005000000FDFFFFFFFFFFFFFF030000000300000005000000FCFFFFFF000000000000000004000000FEFFFFFFFFFFFFFF0100000000000000000000000000000002000000000000000000000000000000020000000200000000000000FEFFFFFFFFFFFFFF02000000060000000100000000000000FCFFFFFFFFFFFFFF0000000003000000FBFFFFFF030000000500000000000000000000000000000000000000FEFFFFFF0200000003000000FFFFFFFF00000000FCFFFFFF01000000FEFFFFFF0100000001000000FEFFFFFF03000000FEFFFFFFF9FFFFFFFBFFFFFF01000000010000000100000000000000FDFFFFFF0000000006000000FDFFFFFFFDFFFFFF01000000000000000400000002000000FFFFFFFFFBFFFFFF01000000FDFFFFFFFDFFFFFF0000000001000000FEFFFFFF0000000001000000FFFFFFFF00000000FFFFFFFF01000000FDFFFFFF00000000FEFFFFFF000000000000000000000000000000000300000003000000FBFFFFFF010000000000000000000000FFFFFFFF0600000004000000FEFFFFFF000000000000000005000000FEFFFFFFFEFFFFFFFFFFFFFF00000000FAFFFFFF0000000003000000FEFFFFFF01000000FFFFFFFFFFFFFFFF00000000F9FFFFFF01000000FFFFFFFF020000000300000003000000FBFFFFFF020000000600000002000000000000000000000000000000FBFFFFFF0100000000000000040000000800000002000000000000000000000000000000000000000000000001000000000000000000000000000000FEFFFFFF01000000F7FFFFFF000000000300000000000000FFFFFFFF0000000001000000FEFFFFFF0000000004000000FCFFFFFF0000000000000000FCFFFFFF01000000FAFFFFFFFCFFFFFFFFFFFFFF030000000300000001000000FEFFFFFFFDFFFFFF0200000001000000FEFFFFFF06000000FDFFFFFF05000000FFFFFFFF00000000FAFFFFFF01000000FEFFFFFFFFFFFFFFFFFFFFFF0000000003000000000000000100000000000000FAFFFFFF00000000020000000400000001000000FEFFFFFF0000000004000000FEFFFFFFFFFFFFFFFFFFFFFF0200000004000000FFFFFFFF00000000FEFFFFFF00000000FCFFFFFF00000000000000000000000000000000FFFFFFFF03000000F9FFFFFF03000000FFFFFFFF0100000004000000FFFFFFFF0000000002000000FFFFFFFFFBFFFFFF020000000100000000000000040000000200000005000000FEFFFFFF020000000300000002000000000000000200000000000000FEFFFFFFFBFFFFFF020000000100000000000000050000000000000000000000FDFFFFFFFAFFFFFFFEFFFFFF00000000FDFFFFFF020000000200000001000000FDFFFFFFFBFFFFFF000000000000000000000000010000000400000001000000FEFFFFFFFDFFFFFF00000000FFFFFFFFFFFFFFFFFDFFFFFFFFFFFFFFFFFFFFFF01000000FEFFFFFFFFFFFFFF0000000000000000FFFFFFFFFCFFFFFF00000000FEFFFFFFFEFFFFFF00000000000000000100000003000000FCFFFFFFFBFFFFFF01000000000000000000000002000000FEFFFFFFFEFFFFFFFEFFFFFFFBFFFFFFFAFFFFFF01000000FEFFFFFF01000000FFFFFFFFFBFFFFFFFCFFFFFFFEFFFFFF02000000FCFFFFFF0200000000000000FDFFFFFF0500000001000000FFFFFFFF00000000FDFFFFFF0000000000000000020000000000000000000000FFFFFFFF0200000000000000FFFFFFFF050000000200000000000000FEFFFFFFFFFFFFFF03000000010000000000000000000000000000000000000004000000FDFFFFFFFBFFFFFF02000000FFFFFFFF020000000000000001000000020000000000000000000000FEFFFFFF02000000FEFFFFFFFBFFFFFF0200000002000000FFFFFFFF0500000002000000FFFFFFFFFFFFFFFF020000000000000002000000FFFFFFFF0000000000000000010000000000000000000000FEFFFFFF0200000001000000FCFFFFFFFDFFFFFF00000000FFFFFFFFFEFFFFFF00000000FDFFFFFF00000000FFFFFFFFFDFFFFFFFCFFFFFFFDFFFFFF00000000FCFFFFFFF9FFFFFF0100000001000000000000000200000001000000FCFFFFFF0000000001000000000000000000000007000000FCFFFFFFFDFFFFFFFFFFFFFF01000000FDFFFFFF020000000200000002000000FBFFFFFFFDFFFFFFFDFFFFFF0000000000000000040000000000000003000000FEFFFFFFFAFFFFFFFDFFFFFFFEFFFFFF00000000FDFFFFFFFBFFFFFF010000000000000002000000FFFFFFFF000000000200000000000000FFFFFFFF01000000FFFFFFFFFCFFFFFFFDFFFFFF040000000300000000000000FDFFFFFF010000000100000000000000FCFFFFFF01000000FEFFFFFFFEFFFFFF0400000002000000FEFFFFFF01000000FFFFFFFF010000000000000002000000FBFFFFFF040000000200000002000000020000000300000003000000FCFFFFFF000000000000000004000000FCFFFFFF01000000FEFFFFFF050000000500000000000000FFFFFFFF02000000FCFFFFFFFEFFFFFFFDFFFFFF010000000000000001000000000000000100000002000000FFFFFFFFFFFFFFFF0200000001000000FEFFFFFFFEFFFFFF02000000FBFFFFFF0000000005000000FFFFFFFF000000000000000004000000FBFFFFFFFBFFFFFF01000000FBFFFFFF02000000050000000100000004000000FFFFFFFF0300000003000000010000000500000002000000FFFFFFFFFFFFFFFF00000000020000000000000000000000FFFFFFFF000000000000000002000000FEFFFFFFFDFFFFFFFFFFFFFFFEFFFFFFFDFFFFFFFCFFFFFF000000000000000001000000000000000300000000000000000000000000000004000000FEFFFFFFFEFFFFFFFFFFFFFF00000000000000000000000000000000FDFFFFFF0000000000000000"> : tensor<2x3x9x10xi32>
    %1 = stablehlo.constant dense<"0x02000000FDFFFFFF01000000000000000600000000000000FEFFFFFF0300000001000000FEFFFFFF00000000FFFFFFFF000000000200000000000000FBFFFFFF0400000004000000FCFFFFFF0100000000000000FEFFFFFFFEFFFFFFFEFFFFFFFCFFFFFF00000000FEFFFFFF0200000001000000000000000500000001000000030000000000000005000000010000000000000000000000FEFFFFFFFCFFFFFF0300000000000000050000000300000000000000050000000100000000000000FAFFFFFF000000000300000003000000FFFFFFFF040000000000000000000000FEFFFFFF0300000001000000FEFFFFFF00000000FDFFFFFFFDFFFFFFFCFFFFFF0200000003000000FFFFFFFFFBFFFFFFFFFFFFFFFFFFFFFFFCFFFFFF020000000100000001000000FEFFFFFFFEFFFFFFFEFFFFFF02000000000000000500000000000000FEFFFFFFFFFFFFFF0400000001000000FAFFFFFF000000000000000000000000FCFFFFFFFEFFFFFF010000000000000000000000FEFFFFFFFFFFFFFF0000000000000000030000000000000000000000FDFFFFFFFEFFFFFF0000000000000000FEFFFFFF03000000FFFFFFFF0400000000000000FFFFFFFFFEFFFFFFFFFFFFFFFAFFFFFF0000000002000000FDFFFFFF010000000400000001000000000000000000000003000000FEFFFFFFFCFFFFFFFCFFFFFFFEFFFFFFFDFFFFFF0B000000FBFFFFFF000000000200000000000000FCFFFFFFFFFFFFFFFEFFFFFF0500000003000000FEFFFFFF00000000FCFFFFFF00000000060000000200000000000000FEFFFFFFFCFFFFFF020000000000000004000000FDFFFFFF01000000000000000100000003000000FEFFFFFF00000000FFFFFFFF01000000FEFFFFFFFAFFFFFF00000000050000000000000000000000000000000200000002000000FCFFFFFFFFFFFFFF0200000000000000FDFFFFFF01000000000000000100000004000000FAFFFFFFFEFFFFFF00000000"> : tensor<3x3x4x5xi32>
    return %0, %1 : tensor<2x3x9x10xi32>, tensor<3x3x4x5xi32>
  }
  func.func private @expected() -> tensor<2x3x6x6xi32> {
    %0 = stablehlo.constant dense<"0x1D00000013000000E6FFFFFFE5FFFFFF9BFFFFFF060000002200000075FFFFFF1C000000CBFFFFFF25000000B0FFFFFFFEFFFFFF4A000000FEFFFFFF210000000200000044000000260000002C0000003E00000010000000F9FFFFFF28000000B8FFFFFF11000000320000000D0000001500000024000000B8FFFFFF40000000F7FFFFFFF6FFFFFFEDFFFFFFCFFFFFFFECFFFFFFF4FFFFFFFCFFFFFF1A0000001E000000C2FFFFFFD5FFFFFFD9FFFFFF540000000C000000D1FFFFFF25000000D9FFFFFFFCFFFFFFCEFFFFFF280000000E000000E7FFFFFFB3FFFFFFFFFFFFFFD8FFFFFFF0FFFFFFE7FFFFFFDBFFFFFF9CFFFFFFF2FFFFFF32000000CAFFFFFFE5FFFFFFD2FFFFFF2F00000012000000CCFFFFFF470000002B000000ECFFFFFFEEFFFFFF3000000085FFFFFF2A000000D5FFFFFF2E000000DCFFFFFFBBFFFFFF1400000030000000840000000700000097FFFFFF8EFFFFFF74000000DFFFFFFF1D000000E9FFFFFFD1FFFFFFA2FFFFFFD6FFFFFF4B000000EDFFFFFF60000000C3FFFFFFAFFFFFFFD1FFFFFF040000002C000000390000008FFFFFFF0D00000003000000110000002E000000E5FFFFFF96FFFFFFD3FFFFFFEDFFFFFF6600000014000000DEFFFFFF0E0000002800000038000000FCFFFFFFF7FFFFFF0700000017000000BEFFFFFF0D000000C0FFFFFFD1FFFFFF28000000E3FFFFFF0700000073FFFFFFFCFFFFFF0A000000D9FFFFFFD1FFFFFF11000000190000006D000000C3FFFFFFCCFFFFFF53000000460000006A00000000000000F6FFFFFF1E0000002F00000017000000D8FFFFFF3E000000EAFFFFFF24000000DFFFFFFF0B000000220000004A0000000A0000004400000008000000540000002A000000D5FFFFFFF3FFFFFF400000000D00000027000000F8FFFFFF27000000EFFFFFFFDDFFFFFFDFFFFFFF150000003E00000057000000EEFFFFFF10000000DCFFFFFFF9FFFFFFACFFFFFFB7FFFFFFF2FFFFFF6A000000DDFFFFFFEBFFFFFF3D0000005600000090FFFFFFDEFFFFFF27000000D3FFFFFF3C000000D6FFFFFF8BFFFFFF4A0000001B0000009AFFFFFF8B000000180000003100000011000000B5FFFFFFB3FFFFFF010000000600000082000000ECFFFFFF71FFFFFF3D000000F5FFFFFF0400000024000000E0FFFFFF7EFFFFFFBFFFFFFF82000000E2FFFFFF7BFFFFFF17000000"> : tensor<2x3x6x6xi32>
    return %0 : tensor<2x3x6x6xi32>
  }
}

