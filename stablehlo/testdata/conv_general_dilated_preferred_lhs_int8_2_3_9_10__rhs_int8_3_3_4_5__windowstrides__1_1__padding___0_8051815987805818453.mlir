// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xi8>, tensor<3x3x4x5xi8>)
    %1 = call @expected() : () -> tensor<2x3x6x6xi32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x3x9x10xi8>, tensor<3x3x4x5xi8>) -> tensor<2x3x6x6xi32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x6x6xi32>, tensor<2x3x6x6xi32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xi8>, tensor<3x3x4x5xi8>) {
    %0 = stablehlo.constant dense<"0x0001FE0002050400FCFE030001FEFB000302010005FE000300FAFEFB04030300FC000100FD00000103FDFFFDFF0103FA020202FC00FA00FE01040500F80004FF0001FE01FEFD0102020100000000FBFE00050101FD01FF04FE02000202FC00FE00FD0004FF03FD00FE00040001FB01FEFAFDFE07FE02F90100FFFF0201000104040100FFFD000001020002050000FEFCFF060203FEFDFA00FF0003010100FE01FDFBFF010000040203FE02000100FDFFFCFF0205FB010000FDFDFF03FEFB0002FE0103FFFEFEFC000000000402FEFFFF05FFFD03FE06FC00FC01FFFCFF01FE01FDFEFE010100010400FF03FE0002FB00FD0100FF00FE02FF01FF04FE02FFFB0001FD02FE03FEFEFF0202FF020304FDFF0100FF0005000000FEFFFE01FF010000000002FE00F9000003000302FBFE03030103FEFF0502FE00FD0305FEFF0001FA0001FB0503FEFD0100FBFC00FEFEFDFE00FD04FF0200FD0103FD07010100FE02040005020005FFFFFA000601FE0003000403020301FB000200FD030102000401FC00FBFD02FC000300FC0001FFFFFF00FFF803020302FF030100010102FF00F901FC010003FCFCFEFCFFFDFC0200F901FFFEFF02000100FC000204FE00010300FFFE00FFFD01FA00FC02FC01030003FA00000000FBFCFEFCFB010400040003FB020100010102020701FEFAFF0000030004FC01FD020304FD0000FB02010000FEFC0000FDFA00010000FFFF000401FFFE06030300FEFF02FC00FDFFFF"> : tensor<2x3x9x10xi8>
    %1 = stablehlo.constant dense<"0x0503000103030103F9FE01FD0200FA000000FC040001FD07FF00020001F801FE0002FF0801FCFD00000000000105FF0100F9FC0201FFFA02FB0106FF0100020103FEFE020005FE0700FFFF00FF00050001FF0200FCFF0304040000FCFDFE03010001FD01FFFFFF0004020002FF04F9010102FEFFFE0000FEFE030100FD000003FE04010101FDFF040501FBFE03FCF800FF0302FE0000FE030203FFFE000600FEFEFA080000FFFDFE00FE00FFFF0002010400FFFF"> : tensor<3x3x4x5xi8>
    return %0, %1 : tensor<2x3x9x10xi8>, tensor<3x3x4x5xi8>
  }
  func.func private @expected() -> tensor<2x3x6x6xi32> {
    %0 = stablehlo.constant dense<"0x1500000062000000B3FFFFFF2B000000BAFFFFFF2B00000031000000CAFFFFFF58000000C5FFFFFF4B000000EAFFFFFF48000000FFFFFFFF1F000000BCFFFFFFECFFFFFFA0FFFFFF03000000DCFFFFFFABFFFFFFE0FFFFFF21000000D5FFFFFF1A0000005CFFFFFFFAFFFFFFADFFFFFFE0FFFFFF41000000D0FFFFFF1F0000000C0000001E0000003500000026000000E6FFFFFF420000003300000015000000A5FFFFFF0A000000F0FFFFFF87FFFFFF05000000CBFFFFFF47000000E4FFFFFFCBFFFFFFF9FFFFFFB9FFFFFFDEFFFFFF4E0000006E000000A0FFFFFF12000000D2FFFFFFE5FFFFFFC4FFFFFFEFFFFFFF1E000000D2FFFFFFFCFFFFFF3E0000003A000000E9FFFFFF21000000C7FFFFFFFEFFFFFF1D0000001F000000DCFFFFFFC3FFFFFFE4FFFFFF29000000130000006500000009000000EFFFFFFFEFFFFFFFCDFFFFFF91FFFFFF10000000FEFFFFFF3D00000005000000E5FFFFFFC7FFFFFFE2FFFFFF09000000DBFFFFFF06000000E0FFFFFF0B00000007000000EAFFFFFF0A00000035000000D8FFFFFFF2FFFFFF280000004A000000F2FFFFFF4600000001000000B6FFFFFFACFFFFFF30000000DAFFFFFFF8FFFFFF09000000F8FFFFFF0100000071000000BFFFFFFF61FFFFFF01000000DBFFFFFFA8FFFFFF1E000000B6FFFFFFBFFFFFFF2A000000B7FFFFFF080000003D00000058FFFFFF1B0000000F000000E2FFFFFF4400000037000000C2FFFFFF770000009800000003000000B5FFFFFF1E000000E6FFFFFF58000000C1FFFFFF380000008AFFFFFF8AFFFFFFEDFFFFFF00000000E0FFFFFF1C000000C9FFFFFF35000000FDFFFFFF0E00000025000000F3FFFFFFFFFFFFFFB8FFFFFF9A000000E6FFFFFF2A0000002D000000DFFFFFFF05000000FEFFFFFFE1FFFFFF740000002100000033000000E8FFFFFF4D00000039000000F6FFFFFFD0FFFFFFC6FFFFFFFCFFFFFFB4FFFFFF0E000000E0FFFFFFF1FFFFFFD5FFFFFFECFFFFFFB3FFFFFFFCFFFFFFE0FFFFFF1E000000DDFFFFFF02000000EFFFFFFFCAFFFFFF670000002B000000F7FFFFFF09000000BDFFFFFF4500000044000000FEFFFFFF33000000D8FFFFFFA2FFFFFF0F000000FDFFFFFF01000000B8FFFFFFCBFFFFFFD0FFFFFF8CFFFFFF12000000E6FFFFFFFAFFFFFFBAFFFFFF1A0000009EFFFFFF330000002C0000002800000060000000"> : tensor<2x3x6x6xi32>
    return %0 : tensor<2x3x6x6xi32>
  }
}

