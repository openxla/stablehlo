// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>)
    %1 = call @expected() : () -> tensor<2x3x3x2xf32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[o, i, 0, 1]->[b, f, 0, 1], window = {stride = [2, 3]} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>) -> tensor<2x3x3x2xf32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<2x3x3x2xf32>, tensor<2x3x3x2xf32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>) {
    %0 = stablehlo.constant dense<"0x44D187BF5975E3C02BC079C0ED07D83F749F95BFD6F57A3E7424FABFFD4DB2BF0D748B3F98B429C092804940475AF13C904D7D408547DB3E03109440081F3440BE3F5BC0ACA2A5C06D931340906D8F40E35825C01D94A2C0E85E3BC09A5A653E2416D3C0C38DB7408157A03F6B18AABF952400C0F06D3540BA73D440D7791B3F365F3EC05B0DA1C01E8E76404CC4B9BE19DA053FFD003D407A65D93F801C0FC01047F2C0420C2FBF792846BE1D17733F83F695BD7E66BA40599146C02E0010BFC7659F406D7FA8BF45FC3840DF8221C02F66A63FB0F04E40D15B21BF2173893FE7B7ACC00C1334C0B4AF4940E5E3F3BF15BEB83FC84F0040E4E65A3F8F2280BF826FC64062BDE53F49653DC0BEFEF63F0A36BBBF0AA44740CA8886C0B2A7BD3F660E29C047C183402A6C89C0E9890CC0527FE0BF15E168BFEE9B36BF17C5DBBFDAF168C0F1BF21C01BD8CFBFFD7B7540BED46DC06162774029759340BEB9BEBF9E3668C0109E4D408D0F3A40A3C67AC04D3E01401AA9D0C063481940B76844C0DC5F65402C4F3EBE40B1B940BA3DF9C0FF4000C042756B40CD997AC077089E400665F6BF8C6C4840AB578BBF1B3420C0CB2A1D40C2313B3E12FD87403B868ABF0BAEA9C058C5A3C0435765408F059B40599602BF2DFC893F94D439406BC246C08B0EB63FE11194BF55F6B93F49B7BD3EF8917240E0FB5D401673DEBFECC183C05364363FAD80C1C0499269C056339BC0EAEE8740FD2D713F7E6DA7405CB4263F5A3919BF914A11BECF331EC186DCDA3F6152C84043D4A6C01F12DDBF485911BC10B4BB404C9918406D81B040DD334CC0AA1F58C084E133C0249DA74078AEAA409F86F2BFB58DB0400E0AE0BF2BFA093F4ACE5FBEE661EF3FAFA1CA40AFA58FBE22F91340FF21033F9479FB3E2763DA3FFA913AC04792FF3F3AB45C3F6822B0BF13DFA83F6E41A8C01BD553405CF0ECBF4F743B405634743F0AB692BFA532A540CAB679BF3C3FDBBF6E78A140BBBF13C0A5EB17C0FEFA0AC053D9FCBF3A922B4094C905405248F84091B22ABFE3A92F40EEBAB93E0964C03DDDEC9BC04F82F73F40340DC079FC0A40471D023D72DAC13F1CE4D2BF65C7C6C0D8D632C0C7FA14BF49466BBF5022D0BEA63432BE464651C01F6720C0BA10AC3F108B7BBF45C353C07C6C50BF43C4863F64598BC0764272C09C4291BFCA7D29BF1B72533EB2045BBEF4FB48C0677014BE6875CFBFC18F47BF77A96F40538D7BC080074140A3EC2BC0DDCE52BF6644FCBF6EE7783FE6304ABF87BF33BF0A189BC095B298401F75813F9A5FC23F3AF942BFBB9CE240A7489EC0E6802DBEF92374BFD898963FBB9E403FB64F0DC0090EE23F6DA0AD40A82A86402BCAF4BFC22A01402A1313C1EAD174408F0A22C03D358CC0CD1FD5BEC78EA7C0D109ACBFD3EB2CBDB560F2BF21FD2ABF17913D4050FE72C0704E9A40F63FC83FB0DF04C06B97E5BF7A1F60402A90983F33FCB84007F1A740AD947FC0C936E93F7411FB3FD131D3BF002315BF19D66B40602B0B40EE25D7BE7041B43EFE1FFE3F109138C0CC10E73F34F2C44006B734C06A5508400F0AB9BF640794BF4E32E6BF33B43BC0D022783F3A483040060C22C0145C47BE345D85BF974A84C0488D00BE43648AC0CECD91C0D9E5D73FAE2CA04014AD2A3E45309ABE10A4F7C0800E7B3E4671B4BFB047A53EEFDFBA3F328504C09DDF1CC0B68BC43FC27A0A405527F7BF4860D13F82A664BE3B44224067220F40F8BD8FBEE4BFEA3D96F50DC02937C3405E8A9EC0AB6830C0959B2940E11B19C02C11624056E0E0C0D8DB1D3E77EDD7BF1460B63F3355C5BE4EB3343F29468DC07F2F423E1237C53F38684640635F0040CEC3063FFB641540B6136840DEFD53BF8BA3A9BF14A2C6404D4EA3400204EA3E1CF2123F3F9C93C08A5FA2C00CF0A8BFDE5364BF670DC13FB359A63F4A1C4BC00989B9BFC0201840C7BE6B40BE211940833A7FBEE0DBC1408103F9C0C9BE1F40BED81DC0ECEC0C40901C0BC01659C34050D482C08EEA7FC02DA6893FFBC42F4002169C40E8D3BD3EA9420E40BFB314BD889707C00093B13E9E9DE1BF7BFF863FD4D972BF5EC8FB3F1184A8BF052041C042D57C3FC5E1B4C0193848C053F374BE55394B3F464CCA3F92BFED3F73ED21C0AAC8DF3F977857C03B782640BADA3FBFEE7518BEF7E6903F8719DBBF6A6B3AC05107B8BC9F3786C073FFE6C05DC8D5C0EE4C54C0AF731BBFC245343FB175D83FDD971F3ED764A7408E0B18BF7FE073C0D0297ABFDC3CADBF2067ACBF7539F33D0B8988405FE22740867919409B92A13FE74513C0BD90EC3FB534803FADDB30C06709E43F69101F3EC55800C0EBD4443E841E344073D7DCBE41B3AD408165AC3E28B1D83C29DA8CBFA665CEBE5D9CECC03B6BA43F10684440F90C8E40A0846DC01D849F3F58C393403B40CCBC426CAA3FEA355F3E2E2EE14099880DC094C8A7C00F228C3FE88EE73F82A45040372F01404F080AC0745C1A402A4569409E93FEBEB52945BF4B50323E2D7598BD0B1B8ABF432D58C065F88640C9AC174091C37EC0B7D3B9C00C441D40F169DA40B70DA3C085CE003FC86715C0F76490BFED548EBF32238840DEDE343F72A096BE552213C0A32295C0852B09C064207F40A08E13BFA587D2C038B364C0CA1FD43F7B167440F8CDB740417B5840CAB19CC05FCC893FE3056B40978C823FBB61EDBF850A81C07F51BBC0BDB5A8BE22B053C091592040535457C01C4A69C0EC056B40B12B184078621A3FA31AB43ED8549DC0C54E4CC097851D405C0D76C06B110EC09E4A2ABF75B70E41491A3840B9C05E40E2E89E3DF15CAF40B62F983E69E7DB3F26DE823F2687453F6CC078BFE3C7BEBE325B79C0F15CA1C0363711C0C3A4B7BF9A63893F886D39C0B2EE9AC018BEEA3F601D03402B1AE03F757597BE2922EA3F367575C0074F1CC0CD63DDBEAF338BC0B85AB1BFD4B70A406DBADBBFC9687ABEF9EE2F3F0712EC3FDFEDA9407AEB0BC0B04073C056D35A402982B4C0439EC8BFFFAB5540"> : tensor<2x3x9x10xf32>
    %1 = stablehlo.constant dense<"0x871BBABEDC3A3B40553E09415F67113E66FBD8BE52EB38C0D9984A40CDC6F73F0C565CBFEE6001C0F076F6BE526E68406CDE8540CC6FA8C081CB953F11F2C0BFF34E8340D79B1BBEFC593A4086AF69BFC66FE4408C368E405F0C60407AB9CFBF0FA335407FC3223FCC6E883FD9CA91C0F4B01FBFBA8564C067D11D400E20D73EF436B63F430F1EBF112638401DE538C0CD60143E5F15F1C0887E4940203710C0E57047C028CA76C0FF0E62404A1541BF214077C018CF133DD6531F3F221676407B810B40EF3C7BC0AE6631C06A5618C01782513F73A672BD516EA140F9FD44404E87B7C0F1B3FF404F232FBF5485CE3FDFE2F9BD4D5AF03F4A933940BBF51F4004D6953DA0A0DF3FF518E43F07727AC08A86073F676D2040D665A3BF14C8FA3E0008003E6918C940FD252C3F8FE74BC085AF8F4067874EC025AE3BBFFAF1FD3E3A94DDC0A8F8313E65B79F3F627E92C0BF908CC080D6E8C0D59C893F4D05E63F8770BF40C8F1183F870637BF3026BA40A1CFF03FF04749C0363F8040D92A133F00E04CC0443692BF5BCD92BF8726323F148B8EBF7B32CB40B15D5D401A05D33FA432ABC0C7C8DF3D32E73DC0EDF428C011CA163F32CBAFC007BD0A4151AE40C0FA1870405274B0C07517FE3FA3B79BBEB2B060408D46AF4007DD2C3F804D01BF7FC012BF5D7587C0A4A631BF16E7B83F6D75CE3E120F0540F19FE4BE33589A3F61568BBF0A296B3FFF2D8AC0EFE7143E8A2406C0865EA63FD449453F5E72483F619C933FBB929ABF476D60BF256B4AC0D764103E0F1C49BF2DF9484008E3F73ED5431D40557951C00FE57240EFEC99BFCCA8DFBE44CC7CC0206E563EAF18C43D04BACD3F0D2CD43FEB7FC1BEBD786940A7DBB3C0ED02FCBFF7981A40F87BD9BF86CDE43FD9D5D7BF19A1A4C09F67B540C957F5BF8C52CE3EBF99A03F9FE49B3FBE60B4BF501575BF1F79C2BF799B6C40AA10A4BF2BE4DB4058B649C0C334B43E054141C08A6E0BC07670AF3D39394ABF"> : tensor<3x3x4x5xf32>
    return %0, %1 : tensor<2x3x9x10xf32>, tensor<3x3x4x5xf32>
  }
  func.func private @expected() -> tensor<2x3x3x2xf32> {
    %0 = stablehlo.constant dense<[[[[-95.5855865, -11.4063683], [-39.9471169, 37.0762024], [14.9044838, 118.892014]], [[-4.32391262, 56.2651291], [88.3947753, -12.7833405], [-156.560715, 98.9454193]], [[106.039658, -106.346199], [17.4612026, 29.0505123], [52.5977631, -5.40521336]]], [[[-40.9302826, 179.686569], [-14.4706345, 52.8698807], [2.86169434, 19.6195393]], [[30.6880188, -141.167252], [-40.575264, -1.05871201], [31.6745529, -79.0460815]], [[69.1415557, 82.6802673], [47.0121803, -44.0802956], [3.722490e+01, 36.657753]]]]> : tensor<2x3x3x2xf32>
    return %0 : tensor<2x3x3x2xf32>
  }
}

