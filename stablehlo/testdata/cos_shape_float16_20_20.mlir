// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.cosine %0 : tensor<20x20xf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xf16>, tensor<20x20xf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xf16> {
    %0 = stablehlo.constant dense<"0x3FBB08BF78370340EB3829C110418046BCC06B3F9C43A2AFC63A3741C7C77F3F2FC1EA422BB25EC09FC22A4737B9F62F27401DBF4845013A27C46440F6B746B75D37D3B9D4BD95C3D1B80F3DF2C42F40DE4380444C4033C12E3FE43CF43598C0733782C55F3B2246C241763D74434B3AE844D7C17D407D4061C476BFCFBBABC3623E2B440238014035C34647AAB595C1FA34E24284C4F844D1AE0EC49F3ABE423DC0C5C18E3C7C391F2E9A3E5C2960C1DE463FC6DD4488C1B7C66DAC88BCC2BFB242C343BF4565C560B8E1BCE5C33CBD9344A4AC5DC21A4116BFF4420B34B935A9C4ABB955AF22401A389DBB2529653C36B69537B7BE17B41D350D47E6BB293F8344CB3B4BBE8230D642F63F25C1C7C2E1408FC75CBBAEC11F3980C22E4668C422BDD03D6BBF2B3B874169C0E8BBE2B43C4029B5B740E52B27C502C47736F8402CBB8C4206A88C437A465940A932733DE9BD9DBCBD3E3EB96AB98741F13616BCB0BEC53CB74787C241BA21B9873F45BCAA3B0EC03540C63C7FC58CB9902CC94508BCFA41DEB75AB821439F41C8C19AC17D4217C063C3A1C21DB5B444E0BAA6434D43DCBDED3B5342773814C396BDA82C674087405AC2E037F441AC3864BD28411F3A13B1EBB92B4348C63A3AFA3F45C245446744CE42033EB73D0338BC344AB976BCD3B770BD7E42163855C45540163E6C3D0345F1C5ADC1A5C0DA3610BD75C6A73EC6C4AEC398C0AD3E19BD124017C34541D6405DAC9D335344FFBEBABD13C011C77238333ECE354341F7BD4AC16344E9BA73BBA04225C40EBB2E3C03402645E2287BC2683E683E9EC5790B694261BA41B912B7FAC1813E1039E245C438D0AF88C5AC44233CA33FE8C350AD7938163CC8BDD3BCDAC3864329456CBB7C48974166C4D32D8840CE41084270410E410D385C3F583E8DBC6A3E6A4024B89EB915C316C21E3D38C11CC19DB0574206C0A93FF941A2421237484685C2C5BB26412CC3DEC467BFD1406AC3B6BB373CCE44DE3AE4335C3D2D34EEB81DC14AB81A4186C31B45EB373E4624C16BB46C406643423B39411FC0C4C041BEBEBCE8C167BC18C84AC0EB3CA5362D3993C3A943203F0CC33BBC0F3C18C35BC4B03614379E38ECC0"> : tensor<20x20xf16>
    return %0 : tensor<20x20xf16>
  }
  func.func private @expected() -> tensor<20x20xf16> {
    %0 = stablehlo.constant dense<"0xF038F3B1253BBEB6893AC6BA8EBAD03BB8B97AB44EBAF13B4D39E3BAE62CC7B4D2BA9BBBDA3B9AB8E3BB18395C3AF03BBFB798B24F38DA3940B8ADB8083B303B2B3BF939442F5FBA983AD2346333F7B79FB9BFB25EB8DABA1DB37535743B50B9263BB739D638E93BBABB8832ABBAA6392A32CEBBFDB8FDB83DB5A5B47B3828BA60A625B8043BB0B629BB6338813B83BB9E3BA5BB42B20F34F43BE4B86A39CABB2CB8BDBBB336313AF73B17ADFE3B30BBAD3AFF3BCF3071BB443BFB3BC936C4B5D5BBE9B9E03A0B39D53A81358AB9263468B0FB3BFEBBA5BA61B28EBBBF3B7E3BAFAA133AF33B9CB7F93AA538FE3B4737683B1E3BE5AEBD3B983BC2396838F6B261B27F380299EC3BB2BB84B6BDBAC2BB1CBAA834D938A3BB6B3AF4BBF53BD2B48A34832F7AB4FF386FBBBEB86738A13B28B8963BAAB9FC3BD0362FB95B3B55BAFF38EEBBFF3B75BADA3B8AB8D43BA032F62D7D3644AF583A3D3A6FBB423B2D3875AEE9357030F1BBAD39693AE6B4B8379A380EB710B8E635A639273AFB3B073B4538E8BB0D3BD83A4CBB91BBC0BB8ABBF5BB4EB7D0BAE1BB983BBEA0393935BAFDBAC52E623800BCC93A60BB8D31FB3BB7B81CB9FFBB0D3BE4BBAD3A1533C3BAC539E63BE9393BBB003CB23993B600BCDBB6E2B4BBBB572C8830043BA73B503A0A37103BB732F5BBFB3AF1B57CB84F2AD632B8348A3BA2BB76B9473BCF34E13BE6ADCF2B21BA50B945AEAC342AB75CBBFFBAFFB9FB3BC63B0EB6ACB1703032B7AB39CC3A60257B3BFBBA172D08BB1EB53239C638E2BB4DB816390438BEB6C236FF3BF6BBE0A7E0A74A3A003CFCBB9739563A3B3BE8BB0FAB733A5E3B9F3AF13BD8392FA9173850B582B9F93BC83A2D380130B535AAB983BAED36CC382FBB86BBF1B4F83B1FB9C6BBF0BB4CBB8ABAFF3A41B4C1A3B73630A8C1B8F43A1C3A5FBBF6BB9934E5BAA9BAEB3BFFBBD4B666B5E7BBE1BB3B3B003CF2BB8438BFBA39BBEF306BB4F1B9C1BA9038E937E62D3B39C23B5333BB3B873AABBAE13AA5BA83BA21360A3BFE3BBBBAB23BC7B8CABAED38E7BA87B7CEB97F1F0336DCBB40373DB558B85B35523B623A64BA2DBAAFB26DBBDB3739385ABB97B5503B3B3BB43A38BA"> : tensor<20x20xf16>
    return %0 : tensor<20x20xf16>
  }
}
