// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x30xi16>
    %1 = call @expected() : () -> tensor<20x30xi16>
    %2 = call @integer_pow(%0) : (tensor<20x30xi16>) -> tensor<20x30xi16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x30xi16>, tensor<20x30xi16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x30xi16> {
    %0 = stablehlo.constant dense<"0x0200FEFF01000500FFFF00000500FAFFFEFFFDFF00000300FDFF0300FFFF010002000200FAFF03000100FEFF0200FEFFFFFFFBFF0300FDFFFDFFFDFF00000000FDFF0000FDFF0000000001000100010001000100FFFF04000400FAFF0100FFFF010006000100FEFFFEFF0100010000000100FCFF0100FCFFFBFFFFFF04000200FCFF02000000FBFF00000300FFFF020000000300FDFF01000000FEFF0000FDFFFFFF0400FEFF01000200FFFF00000000030000000100FBFF0000020003000000FDFF01000000FCFF0000FDFFFCFFFDFF04000300FCFFFFFFFFFF0100070002000200FEFF0000FEFFFFFFFCFF0100040000000100FFFFFEFF03000100FFFF02000000040000000100FEFFFFFFFEFF0000FEFF00000100FCFF080003000700FFFFFFFF03000400000000000100FBFFFFFFFCFF0100FFFF02000400FFFF000002000400FFFF0300FFFFFEFF0100010000000200030000000000FDFFFFFF00000100FFFFF9FF0000010001000000FCFF03000100FDFF03000500010005000100FAFF0200FDFFFFFF00000300FEFF040001000000FFFF000001000100FFFF060000000200FEFF02000100FCFF0000020000000000FFFF0700FEFF0100050001000100FFFFFDFFFCFFFFFFFFFF04000600FDFF00000000FEFF060000000000010004000400FCFF0300000001000100000000000000FFFF00000000FCFF0000FDFF04000000010000000700FEFF0000020005000000010001000200FBFF050003000200FDFF0500FBFF0A0002000200FCFF00000400FEFFFFFF0100FEFF0200FEFFFFFFFBFF010001000000FFFF0500FFFFFDFFFEFF0000FFFF01000400FFFF030000000200FDFFFCFF0200020005000300000003000000FCFFFCFFFBFF030004000300FDFFFDFF0000FDFFFFFF04000400FFFF0200FCFFFCFFFEFF00000400FEFFFFFF0100FBFFFEFF00000400F9FF0500FBFF0700FEFF0100FDFF030000000000FEFFFFFFFCFF0300FDFF00000500000000000000FEFF0000FEFFFBFF0100FEFF0000020000000100FDFF0100FFFF02000100FEFFFCFFFBFFFFFF0400010002000100FFFFFEFF02000000010001000400000001000000FDFFFDFF0000FEFF020004000100FFFFFDFF0000FFFFFDFF0100FEFF000000000300FFFFFFFF0300000000000000FFFF0000FEFF00000200FFFFFFFFFAFFFEFFFCFFFEFF05000100FFFFFFFFFFFF000006000200FEFF02000000040000000000FFFF000002000300FEFF00000000FEFF03000000FFFF00000200FBFF0000FBFFFAFF03000000FBFF01000000010000000000FDFF01000000000000000600020000000200FEFFFDFF0300FDFFFDFF0300FFFFFFFFFFFF0300FFFF01000300FEFFFEFF00000100FDFFFEFF04000100FEFF0400FFFFFFFF00000000000000000500F8FFFFFF02000000FFFF0000000000000000FEFF01000000030000000000FBFFFEFF0000FCFF010007000700F7FF01000000010002000100FBFFFFFF0100020000000300FDFFFBFF000001000000FAFFFDFFFCFF0100000003000100FEFF0000FCFFFBFF00000000FFFFFBFF03000100FDFF0100FEFF0200000001000400FDFFFEFFFFFF03000000FFFF0100000002000300030000000500FEFF02000000020000000000FFFF0100FEFF010000000000FCFF0000030001000200FEFF"> : tensor<20x30xi16>
    return %0 : tensor<20x30xi16>
  }
  func.func private @expected() -> tensor<20x30xi16> {
    %0 = stablehlo.constant dense<"0x100010000100710201000000710210051000510000005100510051000100010010001000100551000100100010001000010071025100510051005100000000005100000051000000000001000100010001000100010000010001100501000100010010050100100010000100010000000100000101000001710201000001100000011000000071020000510001001000000051005100010000001000000051000100000110000100100001000000000051000000010071020000100051000000510001000000000100005100000151000001510000010100010001006109100010001000000010000100000101000001000001000100100051000100010010000000000100000100100001001000000010000000010000010010510061090100010051000001000000000100710201000001010001001000000101000000100000010100510001001000010001000000100051000000000051000100000001000100610900000100010000000001510001005100510071020100710201001005100051000100000051001000000101000000010000000100010001001005000010001000100001000001000010000000000001006109100001007102010001000100510000010100010000011005510000000000100010050000000001000001000100015100000001000100000000000000010000000000000100005100000100000100000061091000000010007102000001000100100071027102510010005100710271021027100010000001000000011000010001001000100010000100710201000100000001007102010051001000000001000100000101005100000010005100000110001000710251000000510000000001000171025100000151005100510000005100010000010001010010000001000110000000000110000100010071021000000000016109710271026109100001005100510000000000100001000001510051000000710200000000000010000000100071020100100000001000000001005100010001001000010010000001710201000001010010000100010010001000000001000100000100000100000051005100000010001000000101000100510000000100510001001000000000005100010001005100000000000000010000001000000010000100010010051000000110007102010001000100010000001005100010001000000000010000000001000000100051001000000000001000510000000100000010007102000071021005510000007102010000000100000000005100010000000000000010051000000010001000510051005100510051000100010001005100010001005100100010000000010051001000000101001000000101000100000000000000000071020010010010000000010000000000000000001000010000005100000000007102100000000001010061096109A11901000000010010000100710201000100100000005100510071020000010000001005510000010100000051000100100000000001710200000000010071025100010051000100100010000000010000015100100001005100000001000100000010005100510000007102100010000000100000000000010001001000010000000000000100005100010010001000"> : tensor<20x30xi16>
    return %0 : tensor<20x30xi16>
  }
  func.func private @integer_pow(%arg0: tensor<20x30xi16>) -> tensor<20x30xi16> {
    %0 = stablehlo.multiply %arg0, %arg0 : tensor<20x30xi16>
    %1 = stablehlo.multiply %0, %0 : tensor<20x30xi16>
    return %1 : tensor<20x30xi16>
  }
}
