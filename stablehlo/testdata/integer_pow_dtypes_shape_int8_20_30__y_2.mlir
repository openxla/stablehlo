// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x30xi8>
    %1 = call @expected() : () -> tensor<20x30xi8>
    %2 = stablehlo.multiply %0, %0 : tensor<20x30xi8>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x30xi8>, tensor<20x30xi8>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x30xi8> {
    %0 = stablehlo.constant dense<"0x0203FE0000000500FF0001000000FF00020302FD0201FA000200FF00FF02FEFF03FE0000FDFEFAFEFFFFFF0400020004FF04FE00FFFEFF01FF0600FBFFFF02000605FF010100FF00020000FFFEFEFD000101FF000202FF00FF05FE00FA0001FF000501FBFD00000200FE000100FE0201FDFDFFFF03FE03FF01FF03FDFB04FDFEFC03FD0000FFFD04000000FE010600050000FC000000FF020900040400FF000000FF01000000FE000502FE0201FD0400FC00FEFEFEFE0304FC00FE01FE00FD0002FFFFFE00FB030003FF00FF0002FF02FF0105020502FA00000400010003020001F9020100FF00020302000003000000010201FE00FEFEFF00FFFCFBFD01FD02000504FD0102FDFE00FF0002040302FCFFFE02000101FFFF0005000000FCFC00FFFAFEFE0001FE0205FC00040200FEF9FE01FB00060202F8FE01FCFFFE0000000000000203FDFF010203FC01010201FDFC00FEFE03FF02FFFD040204FE05010000000002F800FD0204FFFD01FFFDFE02FB01FD0200010003FFFF0204000102FFFF00000200FDFD00000100FFFF05FD020000FEFF0301FD010200FF0000FF01030100FDFF01F9020000070003FD0101FD0001FCFD0004FD05000200FF02010002FE0001030302FFFD00FDFC0204FD000003FCFC0601FD0000FD02FC010100FD00FFFD03FD0005FF02040204FEFE010003FE00FF010102010200FCFFFC020201FE03010000FF0200FE010000FE020100FF00020000FA01010002020201FF0003FD03FFFFFFFFFDFD06FEFF00FF00FE050001000001030403FE00FE0300000100FEFC0600FF01FF0001010002FCFF01FE01000001040204FF00"> : tensor<20x30xi8>
    return %0 : tensor<20x30xi8>
  }
  func.func private @expected() -> tensor<20x30xi8> {
    %0 = stablehlo.constant dense<"0x040904000000190001000100000001000409040904012400040001000104040109040000090424040101011000040010011004000104010101240019010104002419010101000100040000010404090001010100040401000119040024000101001901190900000400040001000404010909010109040901010109091910090410090900000109100000000401240019000010000000010451001010000100000001010000000400190404040109100010000404040409101000040104000900040101040019090009010001000401040101190419042400001000010009040001310401000100040904000009000000010401040004040100011019090109040019100901040904000100041009041001040400010101010019000000101000012404040001040419100010040004310401190024040440040110010400000000000004090901010409100101040109100004040901040109100410041901000000000440000904100109010109040419010904000100090101041000010401010000040009090000010001011909040000040109010901040001000001010901000901013104000031000909010109000110090010091900040001040100040400010909040109000910041009000009101024010900000904100101000900010909090019010410041004040100090400010101040104001001100404010409010000010400040100000404010001000400002401010004040401010009090901010101090924040100010004190001000001091009040004090000010004102400010101000101000410010104010000011004100100"> : tensor<20x30xi8>
    return %0 : tensor<20x30xi8>
  }
}
