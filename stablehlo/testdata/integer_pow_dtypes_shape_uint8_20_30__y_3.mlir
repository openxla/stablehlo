// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x30xui8>
    %1 = call @expected() : () -> tensor<20x30xui8>
    %2 = stablehlo.multiply %0, %0 : tensor<20x30xui8>
    %3 = stablehlo.multiply %0, %2 : tensor<20x30xui8>
    %4 = stablehlo.custom_call @check.eq(%3, %1) : (tensor<20x30xui8>, tensor<20x30xui8>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x30xui8> {
    %0 = stablehlo.constant dense<"0x000004020104000202000103010100030301080700010203030001020003030300000301010202080207040200010103010102010205010401020100010004010201000102020001030101010102050001010202000101030200000104030200000306000207010203010501010100000101020100020102000602010100070302020002010405040000020506010101010000050003020303010301040601010401030006000403000102020304000101010100030104020000010104040100000401030304060103040101000103010102000305010002000801020302010304020204040002000101000001000503000100010004040501070003040103070101010104000302010203050301030700010205000203000204010100000002040301030000010002040302070004010000050103020501000402040206020101020003030101050101040002020200020201010002000101010101030405030104020403000203000300030201020501040501020202020701000302000100010206010002020601020501010200040000000204000101020502010700010001000002010102010201020203020200000101040100010102010201000002050301050001050103010102040304010101020203050204040300010201010400000202040003020100010002060200030202010200040101000502000002010200010203030201000100020202000003000002000001030200020301010101030100000202020002010100030300020001050204020200010102000103000000000203010100030000020003020103030002000303000400"> : tensor<20x30xui8>
    return %0 : tensor<20x30xui8>
  }
  func.func private @expected() -> tensor<20x30xui8> {
    %0 = stablehlo.constant dense<"0x00004008014000080800011B0101001B1B0100570001081B1B000108001B1B1B00001B0101080800085740080001011B01010801087D0140010801000100400108010001080800011B01010101087D00010108080001011B08000001401B0800001BD800085701081B017D0101010000010108010008010800D808010100571B0808000801407D400000087DD80101010100007D001B081B1B011B0140D8010140011B00D800401B000108081B400001010101001B01400800000101404001000040011B1B40D8011B40010100011B010108001B7D010008000001081B08011B40080840400008000101000001007D1B000100010040407D0157001B40011B570101010140001B0801081B7D1B011B570001087D00081B000840010100000008401B011B0000010008401B085700400100007D011B087D010040084008D808010108001B1B01017D01014000080808000808010100080001010101011B407D1B014008401B00081B001B001B0801087D01407D01080808085701001B080001000108D801000808D801087D01010800400000000840000101087D0801570001000100000801010801080108081B0808000001014001000101080108010000087D1B017D00017D011B010108401B4001010108081B7D0840401B0001080101400000080840001B080100010008D808001B0808010800400101007D0800000801080001081B1B080100010008080800001B0000080000011B0800081B010101011B01000008080800080101001B1B000800017D084008080001010800011B00000000081B0101001B000008001B08011B1B0008001B1B004000"> : tensor<20x30xui8>
    return %0 : tensor<20x30xui8>
  }
}
