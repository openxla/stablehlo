// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x30xbf16>
    %1 = call @expected() : () -> tensor<20x30xbf16>
    %2 = stablehlo.multiply %0, %0 : tensor<20x30xbf16>
    %3 = stablehlo.multiply %0, %2 : tensor<20x30xbf16>
    %4 = stablehlo.multiply %2, %2 : tensor<20x30xbf16>
    %5 = stablehlo.multiply %3, %4 : tensor<20x30xbf16>
    %6 = stablehlo.multiply %4, %4 : tensor<20x30xbf16>
    %7 = stablehlo.multiply %5, %6 : tensor<20x30xbf16>
    %8 = stablehlo.multiply %6, %6 : tensor<20x30xbf16>
    %9 = stablehlo.multiply %7, %8 : tensor<20x30xbf16>
    %10 = stablehlo.multiply %8, %8 : tensor<20x30xbf16>
    %11 = stablehlo.multiply %9, %10 : tensor<20x30xbf16>
    %12 = stablehlo.multiply %10, %10 : tensor<20x30xbf16>
    %13 = stablehlo.multiply %11, %12 : tensor<20x30xbf16>
    %14 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %15 = stablehlo.broadcast_in_dim %14, dims = [] : (tensor<bf16>) -> tensor<20x30xbf16>
    %16 = stablehlo.divide %15, %13 : tensor<20x30xbf16>
    %17 = stablehlo.custom_call @check.eq(%16, %1) : (tensor<20x30xbf16>, tensor<20x30xbf16>) -> tensor<i1>
    return %17 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x30xbf16> {
    %0 = stablehlo.constant dense<"0xF3C04E40B33F12C1843F3140B33F963EB3C0BDBF09C0F2C02340F1C0BA3FC5BE794064C0E4BF8BC08C3F7AC04FC015BF2E408C40DB3FB13F7F3F2DC0CC40ACC0183F7DC0164094BF14BE0F409E400DC088C0D8C0B4BF41C01F402A40973E06BF774016C033BF5DBE423F1C40324056C0A4C0C2403A3F64BF79402D40BABE7DC01EC00DC1283F6A4067C0F1BF7CC0CABFFC3F7A4087BFDABF5440B9BE6D3F7B40F23F8CC0503F633E9EC0D83F4CBE1EC0E63F833C92C03EBF04BE39BFB93E24BFDC3F8840C0408AC0A5C0633FB03EFBBFF73F72BF714076BFC83FFBBF62C04EC09F40D5C03A40EB3F133FA6BF8FBEA7C0F6C0943E3740973E3140B53F1540B1C02440A2BE09BFB6BF9040843F3B40FB3F27C013409E4081C024404C40A53FE73FE83FAB3FC3C041C06C3F494093BFF6BE3BC04A3F343E98C0B34040BE28C002BF01BFDBBF82C0D3C054C00B4088C09E3E92BF883F0E40ACC0E43F31C06A4034BCBA3FD33F8640FF3E91BF94BF55BF64C0EF3F5FC0354095C0B9BD903F67BE303FD6C016C078C0FC3E654099BF3CC0983F4E40F7C004407D3F1AC0853EA040D5BFCE3FA1BF824046C05FBF26BEFFBFAA3EA0BF86402CBFEA3EF13F0AC07FC0ACC04EC0E4BF8DBDA5C0D93EC140EE3F8F3B9DBF3840B93ECCC0BDBEB73F253F59BF0140D83FE73FA8BE94408140A8BF6C402940DDBF883D2E404EC0DCBF8B3F0C406E3E0440613F73BF00C0A8BF494029C066C0834038C04340B13EAABF333F76BF8440AEBEC340A2C092C01641F93F4EC0B4C0CE3E3CC08A3FFBBE8EC0413FD94080BF1EC15440CBC0F93DF3BF28C017BF42C0343FA0BF27C0B240D23F7B40864082C096BF0CBF98C0003E183FF2BF9FC0AEBFD73ED03F04BF2DC0AFBF9E4048C0134085400540C13F44C0803E5040AE3F5DBF06C0B93F82C08EC0373FB0BE1F4058C030BFAF4086BF54C048400CC0B9BF2441044011C01DC0114028BE9B3F4FBF84C0E03F2540CE3FEC3F80BE11C075400BC0D7C093404A3E463FB440693F39C0ECBF3840D0BBB3BE94409EBF403FAFBFDCC0F33F1ABF194006BFE0C099C02BC086C06740B7C0BE3F1ABE9F3FD1C02DC004BF9F3FE8C0ADBF2DC0F7BF9B3F33BF64BF45C014C0823FBF3E21C09EBF92BFB03FA640BABF31BF5A40723F69C008C035C0EA3F804083400EBE3EBF08BF2E40C6BE46BF39400DC0A5409BC076BECD40BE409CBDF03F213F8540C53F07BF304097C09FC07C40F53FF1BF143F89C0674061BF4BBF6440C540493D30BE6EC0E73F923F59C02AC057C01D406F3F9CC072C0A7C06CC091C043BFC53F9B3FD93E17BFBD40AC3F52BF3DC05FBFDCBFE1BE5A4094BFCE3FD93F973F124055BF3E3FBA3ED2BF17C0BCC02CC0CD3F1EC065BF91BE733F1DC0B74059C051408440ED3EFF3FDA40FCBF89BEBE3F90C0153FAE4085C01540D2C005C0CCBF3EBE643FC23E5240C4BF6240874054C04E40D13D37BFE33DF4BE7F40CB3F32407B3FAEC00EC0EC3DF03FB5C063C0C2BF0E3F3AC08A3F04408B3F5740BC3F7140ED3EC9BFECC00341CC3E8A3F1C401140FB3FD9BF88C0C83EA1C021412E40B34088C053406B4079C022407F4036404C404FBEFFC094BEDABF05C036403F40A0404AC09B3F613F4DC01F3F26C171401C403BBF1640924097C0E0BFD04012C0C0C08A40853E9040CD3F"> : tensor<20x30xbf16>
    return %0 : tensor<20x30xbf16>
  }
  func.func private @expected() -> tensor<20x30xbf16> {
    %0 = stablehlo.constant dense<"0x00800000C8200080C33C0000C820807F00809E9B00800080000000804D1D80FF00000080908A008044370080008024F100000000400EC321D53F0080000000805F6F008000003AB280FF000000000080008000803FA0008000000000807FDDFA0000008048E080FFDF5800000000008000800000CD5C10CA0000000080FF00800080008021660000008084850080B89578010000A1BAA18E000080FF9E460000140500808952807F0080A90F80FF0080BB09807F0080CFDA80FF29DD807F58E8C90D0000000000800080884A807FCD814C0394C4000022C3AC16CD8100800080000000800000D1074272A6A780FF00800080807F0000807F0000B51F00000080000080FF9FF8609F0000C33C0000CD010080000000000080000000002A2884091809082500800080CC460000C2B280FF00803855807F0080000080FF00809EFD49FE408E00800080008000000080807F41B3163A00000080900A0080000080FF4D1DA1110000807F25B43AB25FD000804F0600800000008080FFB03480FFC461008000800080807F000016AF0080DF2F0000008000008E400080807F0000DF90CE134DAA0000008029CC80FF0080807F14AB000002E4807F84050080008000800080908A80FF0080807F0000A106807F8EAC0000807F008080FFAF1EAA67A8CE0000A90F840980FF00000000A1A600000000498D807F00000080C98DE8370000807F00003C4B38C40080A1A6000000800080000000800000807F67A5486022C3000080FF00000080008000008B0200800080807F0080903880FF00801D59000080BF008000000080807FB8840080D5EF0080BF5F14AB008000003612000000000080E0B0C4F60080807F5F6F1485008048A3807F091343FC0080E7A2000000800000000000009D190080807F00004823C9CC0080A91D008000802F5E80FF00000080C4E100005DBB008000000080A99D0000000000800080000080FFDF2D08D300802F0C0000CE134C0780FF00800000008000800000807F0A5700000E4800804C87000080FF80FF000021ACD359E7A20080B80414EE0000DDFA0080008000800080000000804F1B80FF852B0080008043FC852B0080D1A300804C83DF2D48E010CA008000801E3E807F008021AC41B3442200004D9D43E1000094440080008000802B080000000080FFCFDA96F9000080FF0AD7000000800000008080FF0000000080FFDC05CD690000ED1721FA000000800080000014048485BA71008000003CCBA3D400000000807F80FF0080840941330080008000800000CF45008000800080008000804DD8ED17DF2D807FD5EF00008224B6D1008029CCC98D80FF00003AB2CE13280F553000005FD0CF5A807F36920080008000806C140080ADC980FF384400800000008000000000807F00000000788180FF4F1B00802471000000800000008000809C9480FF104A807F000071980000000000800000807F2FDE807F80FF0000231500004D4100800080807FDC05008000805F994D75008090380000E8370000421C0000807F109600800000807F903800000000CD01288F0080807F00800000000000000080000000000080000000000000000080FF008080FFA18E00800000000000000080DF2D3C4B0080056B0080000000000EDC0000000000802F8C0000008000800000807F00006C14"> : tensor<20x30xbf16>
    return %0 : tensor<20x30xbf16>
  }
}
