// RUN: diff <(stablehlo-opt %s.0_9_0.bc --vhlo-to-version=target=current --vhlo-legalize-to-stablehlo) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-opt %s --stablehlo-legalize-to-vhlo --vhlo-to-version=target=current -emit-bytecode | stablehlo-opt --vhlo-legalize-to-stablehlo) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.log_plus_one %0 : tensor<20x20xbf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0x98C0F7BFA6BF8D3F5640F24050C021BF43BE3C407CC0BC40233F354009BF673E81C02E40CEC0104087BF6C403640A63F9AC0A9C06F40CABF673FD33FF63E27BE1BC1DABF784092BF9940FC3E65C0E4BED5C08440F23FFF3F45BEB6BFA23F84C063C0ABBFA5C0103F7BBE74C0EDBE27402E3F5140EB4065BE7BC0E6BC0F40C0BF88403BC02E3F45C085C0F2BFF4BC94C095BF074068C0123E53C05F4052C077BF3140873D30C0E53F923EB23FD63FEABFD6BFA4BFD6C001C034C03FBF07BF883F5DC099C01B3F8E4012C04CC02F40FF3F153F763E8540B03FC440303EC14090C018C051BD96C0CE3FEDBF703F73C0D6BF8740953F3E4048BF0F406DBFD43EBCC0203F17413FBFA43E9A40D0408D4084C0CE400ABF93BF993F234057BE34C0A340F43F0440C53F93BE313F083F2AC0853F1740C63F0CC06A40354086C0D6C00840D5C063409CBE6CC05E3F793FA4406FC03EC013C044BFAD40DE3F2C3E1D405FBF6C4028C0ED3ED03F2D40053E8C3F2BC0664015406A40734087BE78BF4FBFDB3FE2BD4DC061BF264096C0CABF5640CCBFE9BF40402B408EBE11BF833E21406C3FB4BFF03FBC3E9A400D401840C2BF97C09C3E69BEEEBF28C04AC095C095409BC027C0B540E33FD9BFF43F933FDFBECFBF91C02E40983EC740FABF29C03EC014401D409ABFB1BE23C0C3BF2CBFA13EE2BF34C04CC0A7BEC9BEA6C03540F9BEB03FDCBFB9BFDB3FE13FFBBFD83F6AC0A0BF13C0AAC0FA3FB3BF843F1DC01DC0F73FAE3D75C0E53F4D40ECBFE7BF0FBF3EBD43C04740E240123D413FA6BF2940FF3DBCBE20C0B5BEB5404EC0D1BD76C0DC3CDABFB0BFA43EBD3FED3FBF3FD93DC9BEAF40C0C0D93F1BBF94406C4050404C403240374085406B3E9E4091C07C4098C093C0E5BC98BF3AC03B40B5C04A401BC0153F2540C03FA23E6AC0693FF83FDDBF164030C0B3C028402F402640213FB73F633F603FAD3F90C0AA3F7A40A3C081BF013F04BE89409BC0A4400BC0D03C7D403C3DEEBF56C0B04014C0A9C087407940043FEF3F044050C02C3F5DC04FBF51C072C06A4067BE0E4026C01DC01AC02240A7C051C019BE3DC072C0A8BF05BFAABFA93F0340D43F2EBD22C0CD404B4098C0"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
  func.func private @expected() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0xFFFFFFFFFFFF3E3FBC3F0940FFFF7EBF58BEAF3FFFFFF73FFC3EAC3F44BF503EFFFFA83FFFFF973FFFFFC63FAC3F553FFFFFFFFFC73FFFFF253F793FC93E36BEFFFFFFFFCB3FFFFFE13FCD3EFFFF17BFFFFFD13F883F8C3F5BBEFFFF513FFFFFFFFFFFFFFFFFE43E90BEFFFF1FBFA43F053FBA3F084082BEFFFFE9BC963FFFFFD43FFFFF053FFFFFFFFFFFFFF8BCFFFFFFFF913FFFFF083EFFFFC03FFFFF56C0AA3F833DFFFF833F803E5F3F7C3FFFFFFFFFFFFFFFFFFFFFFFFFAFBF40BF393FFFFFFFFFF23ED93FFFFFFFFFA93F8C3FEB3E5C3ED23F5D3FFB3F223EFA3FFFFFFFFF57BDFFFF763FFFFF293FFFFFFFFFD33F463FB03FC3BF963F26C0B13EFFFFF93E1640AFBF8E3EE13F0140D83FFFFF004046BFFFFF493FA23F71BEFFFFE73F893F8F3F6F3FADBE073FDA3EFFFF363F9B3F6F3FFFFFC53FAC3FFFFFFFFF923FFFFFC23FBABEFFFF203F2E3FE83FFFFFFFFFFFFFBABFEE3F813F1F3E9F3F03C0C63FFFFFC33E773FA83FFA3D3D3FFFFFC33F9A3FC53FC93F9DBE5EC0D4BF7F3FEFBDFFFF07C0A43FFFFFFFFFBC3FFFFFFFFFB13FA63FA6BE56BF693EA13F273FFFFF873FA03EE13F953F9C3FFFFFFFFF883E84BEFFFFFFFFFFFFFFFFDE3FFFFFFFFFF33F833FFFFF893F443F12BFFFFFFFFFA83F853EFD3FFFFFFFFFFFFF993F9F3FFFFFD9BEFFFFFFFF8FBF8C3EFFFFFFFFFFFFCABEFFBEFFFFAC3F2BBF5D3FFFFFFFFF7F3F823FFFFF7D3FFFFFFFFFFFFFFFFF8B3FFFFF353FFFFFFFFF8A3FA73DFFFF833FB83FFFFFFFFF51BF43BDFFFFB53F06400F3D103FFFFFA53FF03DEABEFFFFDFBEF33FFFFFDCBDFFFFD93CFFFFFFFF8E3E683F863F6A3FCE3DFFBEEF3FFFFF7E3F6EBFDD3FC63FB93FB73FAA3FAD3FD23F543EE43FFFFFCC3FFFFFFFFFE8BCFFFFFFFFAF3FFFFFB63FFFFFEB3EA33F6B3F8D3EFFFF263F8A3FFFFF9B3FFFFFFFFFA53FA93FA43FFA3E633F233F213F5B3FFFFF583FCC3FFFFFFFFFD13E0DBED53FFFFFE83FFFFFCD3CCD3F383DFFFFFFFFF03FFFFFFFFFD33FCB3FD53E873F8F3FFFFF043FFFFFD4BFFFFFFFFFC53F83BE963FFFFFFFFFFFFFA13FFFFFFFFF26BEFFFFFFFFFFFF3CBFFFFF573F8F3F7A3F32BDFFFF0040B73FFFFF"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
}
