// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.negate %0 : tensor<20x20xbf16>
    %3 = stablehlo.exponential %2 : tensor<20x20xbf16>
    %4 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %5 = stablehlo.broadcast_in_dim %4, dims = [] : (tensor<bf16>) -> tensor<20x20xbf16>
    %6 = stablehlo.add %5, %3 : tensor<20x20xbf16>
    %7 = stablehlo.constant dense<1.000000e+00> : tensor<bf16>
    %8 = stablehlo.broadcast_in_dim %7, dims = [] : (tensor<bf16>) -> tensor<20x20xbf16>
    %9 = stablehlo.divide %8, %6 : tensor<20x20xbf16>
    %10 = stablehlo.custom_call @check.eq(%9, %1) : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<i1>
    return %10 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0x893FA5C0D6BED240D83F39BE3A40304084BF8A4021C021C0063F724041BFB53D28401DC0BABFEABF7FBF443EA4BF4CBF64C09C3F3B3F2BBFEB3F0DC09D4080C0A23FF53F83C02240A8BF41C0B84011C084BFADBEACC0FCBF9A40363F863F37C0963F203F223F99407ABE6CBF934001C1293E8F3E94BF6D401240A6401A405BBF6DBE13BF8640A3C080405F3FBB3F05C023BF51C0953F71400940C240C4BF81BF854091BF40C0114145C004BF8CBFAC3F86C04B3FE5BEA23F773FD2BFA13FB840BE3F344008BF3DC08DC08C40B93F99BDDDBE354023C0C83E43BF72C0FEBF6C40EE3E414042408ABF5C408CBE0FC04840B7C01EC08540C53E86BF62BE634066C08840AA3D95BFC43D7FC0983F8C40B3BD84403740953F2B40CA3FF83E553F653F7A4009C031401A4027C0BDBFC0BF90C0683FA94015C08F4092C0C53E1640F7402CBF8E3F0D403D3F3E40CFBE0ABD0040ED3D67C0C4BC3BC0EEBFE6BE28409840BCC02BBF18409E3F253FC5BF863CC13FCDBF133FD33CACBF4EC0133EBA3F06C0C5BFDCBF6A3FE3C0443F92C00CC0783F4A408440844052400D400BC09CC005C02ABF033FBD400440DBBFAF3F1B3F0541C83FCF3F7DBCCC3FECBE0DC1003F9E40FE3FBCBFAFBF4BC08FBF9940B8BF85C0193EE43FB43FC33FB9BEAA3E803F5F40A73FAB3F1C3EAFBE033F7DBD073F9B3F9F4030BFA740EB3F613FA93E094034403FC0DA4003C0A63EBC40B1C0DC3F26C001BEB2C017BE1DBF02C00EC0833FE23FBDBE743F60C0874050C09CBF523FEFBF17C06CC01A3D9F40B9C0FB3F0FC095C0654023BE00C0D03F9A3F8FC02AC0FF3ECB403D40C93EA6BF51402740AF40813F11C00B3F2240E03DF2BFAEC03EC0A0BFE0BFFBBF8DC003408BC0953FC2C03DC0DEBDF240A84073BEF33F0D40253F8EBFA83F5FC0904083C0E240CC3F514001C0874001C09EBEE03F05C09340CCC00940D9C00ABFD93F29BE86BF784001C0F43F55C02D3F4C3F4B4066C088C085C005C052C0C53EB63F3740D33F72BF2D4017C0E13E743CCBBE4740733FA2BFBA3F33C0D63FAA3FF13F5F4000C0AF3FDFBF91BEBFBF3EC0A13F163FC13F1DC07EC01E404FC09E409640D5C058C00440233D2B40"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
  func.func private @expected() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0x3F3FBB3BCC3E803F583FEA3E733F713F873E7C3F993D993D213F7A3FA43E063F6F3FA23D423E0E3E8A3E0C3F5F3E9F3EE23C453F2C3FAD3E5D3FCC3D7E3F943C483F5F3F863C6D3F593E403D803FC13D873ED53E973BFC3D7E3F2C3F3D3F5D3D433F273F273F7E3FE03E923E7E3FA5390B3F123F753E7A3F683F7E3F6A3F983EE43EB83E7C3FC83B7C3F343F4F3FE43DB13E163D433F7A3F653F803F363E893E7C3F783E423D803F343DC03E813E4A3F753C303FC83E483F393F263E483F803F513F713FBD3E4C3D453C7C3F4F3FF63ECA3E713F953D193FA33EB73CF83D7A3F1E3F753F753F823E783FDD3EC73D753F583BA03D7C3F183F853EE43E783FDC3C7C3F053F753E063F963C443F7C3FF53E7C3F733F433F6F3F553F1E3F323F363F7A3FD83D713F6A3F8D3D3F3E3B3E343C363F7E3FB63D7E3F293C183F6A3F803FAC3E413F673F2D3F733FCD3EFC3E623F073FD83CFC3E513D0A3EC83E6F3F7E3F383BAD3E6A3F473F283F353E013F523F2C3E243F023F553E1E3D093F4F3FE03D353E1C3E373F593A2E3F293CCE3D3A3F763F7C3F7C3F763F673FD23DF83BE43DAE3E213F803F643F1D3E4D3F253F803F533F563FFE3E553FC53E1C391F3F7E3F603F403E4F3E253D7C3E7E3F443E7C3C0A3F5A3F4E3F523FD23E153F3B3F783F493F4A3F0A3FD53E213FF83E213F453F7E3FAB3E7E3F5D3F353F153F653F713F453D803FEA3D153F803F823B593F8E3DF13E7C3BED3EB43EED3DC93D3C3F5A3FD23E393FF13C7C3F193D6A3E323F093EB13DC83C023F7E3F4A3B603FC73D1B3C783FEC3EF53D563F453F3A3C863D1F3F803F733F193F5C3E763F6F3F7E3F3B3FC13D223F6D3F073F063E8E3B483D643E183EFC3D453C643F523C433F183B4C3DF13E803F7E3FE23E5F3F673F283F7E3E4A3FF53C7E3F863C803F553F763FF13D7C3FF13DD93E5A3FE43D7E3FDF3A653F953ABC3E583FEA3E853E7A3FF13D5F3F0E3D2A3F303F763FDC3C673C7C3CE43D143D183F4E3F733F563F8F3E6F3FB13D1C3F013FCE3E753F383F603E4F3F6C3D583F4A3F5D3F783FF53D4D3F183EDC3E3C3E483D483F253F523FA23D983C6C3F1B3D7E3F7E3FA93A073D643F033F6F3F"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
}
