// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<1x20xf32>, tensor<20x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.broadcast_in_dim %0#0, dims = [0, 1] : (tensor<1x20xf32>) -> tensor<20x20xf32>
    %3 = stablehlo.maximum %2, %0#1 : tensor<20x20xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %1) : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<1x20xf32>, tensor<20x20xf32>) {
    %0 = stablehlo.constant dense<[[-0.256615132, 0.888785362, 1.42897689, -2.33543134, -2.4146142, 4.02013636, -1.70369816, -4.02025843, 1.966869, -3.44891858, 4.5072732, 0.976669073, -0.296282768, -1.30539346, -0.325105578, 6.34426641, 2.57391453, -2.39309907, 0.864286423, -2.213099]]> : tensor<1x20xf32>
    %1 = stablehlo.constant dense<"0x17975540037A56C0D7D0D53FADCD90BFBB88DEBEA50B673F1A4B31C002AC253DD85718C0493E2740FD35BFBEA497C3C0D79ED8BFDDA385BFB2591E3FEED636BF3C52E2BF21CF68C0E5A4BEBDE7E3303F3AB58D3FA0B6863F089F7140D8F80940C220F33F69F729C09723973DAC2C04405CB614C04005E9C02BB6B0BFEEC4A0C09A6B134024051A4079412140D56834C0B101F6BFCE4FDFBFC7F79B405E58E3C0DBFA4F406B654DC09C2DD43C63F0134110BDB3C06B758D3FB117F1BF104B63BF39BE08BF635D45C02DA729C0B89DA13E2E9C6BBE319C224051E71CBF642AE83F15582ABEEA64E040501F9B4035336F3FD4A66F40272C873E09B93D4000E880C0910D70407D0D0B3EEFC2BABE606CA840F7E1C9BFEE3E80C098878A4007BC89C066E60640AC162BC0DFC08EC0F95E01C0567B2E4038F0A43F60D7013F9E79473E7E4EAD3FD1AD5ABF298992BD80010ABF9EBC0940811F87C0F8362F40B519E3400E0A474008FA823F8CA0DB3E3532FA3E687A9FBEDF4FC13F6B084DC08AB9C13F47A5C63FACC16E4038D7BDC077B042BF7C01A740925701C0567EBABD17E56740AAC6B73E31989A3F1D639F402E7170C079343E406B9D8AC0A0353CBF456FB5409FEBE53F4242F5BE71FF69401DA834C0CE3E643F319EFBBFB25F01C00FE949C02DD1F4BF754278C045D698BF08B3D2BC61F372C0ACDC743FDFA9D7BE481598C05C74DEBF6A5A28C0C2693D40360D5FBF53A93140A142983FF24D0540EDCE68404ED384BFE56204407EC4093E7A3F7CC03DC406C00C645B401EC4DEBF86CA273F20A305C07818CB406B97603F4F0F4B3E5C8D3AC038DEED3F8679DC4004305DBFD9C9B23E641ED93F0D8AC83E7B382DC0976400C061EE16C02399CEBE4ABD5940B154E6BE01F0D13F84B01840EEDD8DC01891FB3FEF7A13C0337DFC3E2E284CC03CE9A9405DB246BF9D591D3FEE9378409DFB38C0FAC2A83FC565983E856B9B40BC183F3F3AAD433FEBE3453F51A748C0569578C0B01D8840CBD0AABE869231C0954CB8BFCC0A67BF4CBD00403FF4B33E06DCC43F11AE67C0D45804C0529C27C081EBE7BEE7B785BFBCA43B3F51D158402E9482405F02ABC093FB2540F339284066E339C0F5724BBF630D5D3FEC8795C03D1E21BF32482F3EBAA3CBBF7F7255BF0FAD09C0BAFCBF3FA4D506BFC41DBFC0BCA45D40B1B506BF4C71383E53AF2440747560C0C8FC894015FB31BF03A933409634A14051502C3E8F8FD6BF1EB53A4003499F4024E181C01CC537BF484F194086145C405B9585409A91D43F4A692340C54D034024C71C40F1151640FD9CE13FDC66983FBA1A40BF106CBF40D36093403422A23F668A4AC07F99B6C00C9867405E4799C0CDB507C0A3A5853FDC4C2B40C673ADBFB029B33E578900BF538166BF60BAECBFC280133F782C48BFDA349940C8D5A43D24B57FC085549ABFDAFEEFC013204E405C5640BF03697F402124F8BCA799BCBE4398963E4B4D0AC0B77AA73F561310BD8CDFB3BF5252ABBFA3E4D73F583B3A40750CCA3E983DD33D025D2940609197C0018489BFD67EBF40C4819140196C35BEC5170EC064EE234042EC26C0D7D74C3F8A190640A9128CBE62CEE3BFAA4837BF24AA9B408A219EBE7B959D3F72A5123EA6E70B406EB64BC0D10D09C0A0B4A0C01F3FF53FAA6FB43F5935FBBDD0C8CA3F04E7303B42638AC0D2B4913F45CA3940BB09014085A75ABF0C73CC3D38259D3FD84FDB3EF47AAF3FBC23AFBFD575254085AB3C402341DF3E5B657EC04FA663402943473FE43BA2BFB41B82C007B5C83E2F1670BF98C9154017808B4018E7C24040367CC0A6FD9B40AF08C03EDF31524029D12FBFABEE19C0A7C2E5C029D797BF565DB13F06869640A452B33F592B3B3F541B09BF57AAC8BF14E53EC03D7CC1BF7062A73F56E878BFBA9221C09FD573C0A3C9604036CF2D40B8914040DD01CB3FC61822C0B40031C0860F8D40821D87BE9180C2C04A4385BFFAF9BC3E621F7440A1B3C6C097231BC0F72146407DDAC840930BAEBFD3197DBF5A15C13F656046BF3F0F423FA76A84BF20C5D93F664DD14097DCF9404888B63F293D69BF5543313ECB68B54005D734401F5C8740E632A8BF49A6B6BF7DCACBC07D0DBEC075CBB2BF50FF9FBF62D96AC0248B333FECF1C4BF933266BF1F1D1D3FBA7B763F0F866CBF20C82EC035FA0ABE1D464F4042E680BF09BA72C0521990C0F48718C031F722C042D1AC3FB33C91C0B2F64B40"> : tensor<20x20xf32>
    return %0, %1 : tensor<1x20xf32>, tensor<20x20xf32>
  }
  func.func private @expected() -> tensor<20x20xf32> {
    %0 = stablehlo.constant dense<"0x179755407087633FD7D0D53FADCD90BFBB88DEBEF5A48040C812DABF02AC253D5DC2FB3F493E2740953B9040FC067A3F60B297BEDDA385BFB2591E3F3B04CB4004BB2440892819C0E0415D3FE7E3303F3AB58D3FA0B6863F089F7140D8F80940C220F33FF5A480409723973DAC2C04405DC2FB3F15BB5CC0953B9040FC067A3F9A6B134024051A40794121403B04CB4004BB2440CE4FDFBFC7F79B406AA30DC0DBFA4F407087633FB7E8B63F63F013410A891AC0F5A48040C812DABF104B63BF5DC2FB3F635D45C0953B9040FC067A3F2E9C6BBE319C22403D74A6BE3B04CB4004BB2440EA64E040501F9B4035336F3FD4A66F407087633F09B93D40B57715C0910D7040F5A48040EFC2BABE606CA8405DC2FB3F15BB5CC0953B9040FC067A3F66E606402217A7BF3D74A6BE3B04CB40567B2E4038F0A43FE0415D3F9E79473E7E4EAD3F7087633FB7E8B63F80010ABF9EBC0940F5A48040F8362F40B519E3400E0A474008FA823F953B9040FC067A3F60B297BEDF4FC13F3D74A6BE3B04CB4004BB2440ACC16E40E0415D3F77B042BF7C01A7407087633FB7E8B63F17E56740AAC6B73EF5A480401D639F402E7170C079343E4015BB5CC0953B9040456FB5409FEBE53F4242F5BE71FF69403B04CB4004BB2440319EFBBFE0415D3F6AA30DC00F6383BE7087633FB7E8B63F08B3D2BC0A891AC0F5A48040DFA9D7BEF5A580C05DC2FB3F6A5A28C0953B9040FC067A3F53A93140A142983FF24D05403B04CB4004BB2440E5620440E0415D3F6AA30DC00F6383BE0C645B40B7E8B63F86CA273F20A305C07818CB406B97603F4F0F4B3E5DC2FB3F38DEED3F8679DC40FC067A3FD9C9B23E641ED93F0D8AC83E3B04CB4004BB244061EE16C0E0415D3F4ABD59400F6383BE01F0D13F84B01840B57715C01891FB3FF5A48040337DFC3E2E284CC03CE9A9405DB246BF953B9040EE93784060B297BEFAC2A83FC565983E3B04CB4004BB24403AAD433FE0415D3F6AA30DC00F6383BEB01D8840B7E8B63FB57715C0954CB8BFF5A480404CBD00403FF4B33E5DC2FB3F15BB5CC0953B9040FC067A3F60B297BEE7B785BFBCA43B3F3B04CB402E948240892819C093FB2540F33928400F6383BE7087633FB7E8B63FB57715C03D1E21BFF5A48040BAA3CBBF7F7255BF5DC2FB3FBAFCBF3F953B9040FC067A3FBCA45D40B1B506BF4C71383E3B04CB4004BB2440C8FC8940E0415D3F03A933409634A1407087633FB7E8B63F1EB53A4003499F40F5A480401CC537BF484F194086145C405B958540953B90404A692340C54D034024C71C40F11516403B04CB4004BB2440BA1A40BF106CBF40D36093403422A23F7087633FB7E8B63F0C9867400A891AC0F5A48040A3A5853FDC4C2B405DC2FB3FB029B33E953B9040FC067A3F60B297BEC280133F3D74A6BE3B04CB4004BB2440892819C0E0415D3F6AA30DC013204E407087633F03697F402124F8BCA799BCBEF5A48040C812DABFB77AA73F5DC2FB3F8CDFB3BF953B9040A3E4D73F583B3A40750CCA3E983DD33D3B04CB4004BB2440018489BFD67EBF40C4819140196C35BE7087633F64EE2340B57715C0D7D74C3FF5A48040A9128CBE62CEE3BF5DC2FB3F24AA9B40953B90407B959D3F72A5123EA6E70B403D74A6BE3B04CB4004BB24401F3FF53FAA6FB43F5935FBBDD0C8CA3F7087633FB7E8B63FD2B4913F45CA3940F5A4804085A75ABF0C73CC3D5DC2FB3FD84FDB3E953B9040FC067A3FD575254085AB3C402341DF3E3B04CB404FA663402943473FE0415D3F6AA30DC007B5C83E7087633F98C9154017808B4018E7C240F5A48040A6FD9B40AF08C03EDF31524029D12FBF953B9040FC067A3F60B297BE565DB13F068696403B04CB4004BB2440541B09BFE0415D3F6AA30DC00F6383BE7062A73FB7E8B63FB57715C00A891AC0F5A4804036CF2D40B89140405DC2FB3FC61822C0953B9040860F8D40821D87BE2217A7BF3D74A6BE3B04CB40621F7440892819C0E0415D3FF72146407DDAC8407087633FB7E8B63F5A15C13F656046BFF5A48040A76A84BF20C5D93F664DD14097DCF940953B9040FC067A3F5543313ECB68B54005D734403B04CB4004BB244049A6B6BFE0415D3F6AA30DC00F6383BE7087633FB7E8B63F248B333FECF1C4BFF5A480401F1D1D3FBA7B763F5DC2FB3F20C82EC0953B90401D464F4060B297BE2217A7BF3D74A6BE3B04CB4004BB244042D1AC3FE0415D3FB2F64B40"> : tensor<20x20xf32>
    return %0 : tensor<20x20xf32>
  }
}
