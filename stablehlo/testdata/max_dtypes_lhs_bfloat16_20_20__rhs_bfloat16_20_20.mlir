// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xbf16>, tensor<20x20xbf16>)
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.maximum %0#0, %0#1 : tensor<20x20xbf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xbf16>, tensor<20x20xbf16>) {
    %0 = stablehlo.constant dense<"0x4BBF6E400640C0402040EDBF8DC0DC3F6140593E8440424082C08AC0FD3F43C0ADBD77C02F3F9F3F98BF02C056404D3E3FBFDFC043402F40B03FDABE4D3E2A3E224091BFC83FB2BDB43F85BF6BC0663F54C08CBF973F82BF5FC01ABF884085C0ED3F49C06D3F4BC0B540B840873B64BF654040BFD2C0D53F3340CC3ECE3F3640323FC4BF023EEDBF33BF0740BA3F263F20400940A4C04F408E3F82BFE5BD94BF54C06DC08440E83F2440E0BF653E08C0DFBFD43F6640A2BE9A3F63406DBFF73E3BBF093FA5C02740C4BFD6BFAF40804031400C404EC0AD405D40C940CFC00C408DC0C7BF9040D1BF1240F13FD2BF06C008C02CBFE43FB6BF8EBF0DBFC1BE943F49BFB83E733F42C05040AABE6DBFE8C0AC3D40C004BE60C083BED64066BFFABD08C0903F133FC0407D4076BF5FC0DF3F8BBFC7BE9C40F33F0DC0AB40983F61C048C0BFBF2C40003F6F40754007BE59C07C40A4401F4038C0A53F6BBFEB40023F83C0A33F68BE3FBF183FC140C13FFDBFBB3FEEBFC63FF43F66BFC33EB840213FCE3E85C0C53F0B4083403EBEE83D2DC0963F15BF49C0C73D04BF4D3F54BF4740C93F9F3F82C00441E9406CC0B7C0C13F09BE9840BE3F09400E40ADBF5DC05EC0C4BE0FC06B40183F10C03BC00740BE4058C0B03E6EC0433F06BD9A3F4A3F94BFB83FD73F79406B409640803F0B41ADBE6DC069C04A401BC038BF50C088404A4002C1423DB8C003C04DC0603F553EEFBFFC3E0FC09740263F04405D40A9BF2AC02EC04C3F89C027C0A040E73F0D3D77BFAABD1F40BBBFD13FF540F5C0343F95BF36C0C2BF73C0DA408DBF8F407AC097BFD34050404BC02440DE3F6C3FE9C0A4C01DC065407F3F5BC083C03840F6BEC8BF2F40CCBF0840ADC0853F8BC09BC0D2BEB83FFE4032BF48407740944066C0AB4005BF0EBF68404EC082BF55BFEDBEB6BFAD3F3AC01BC04D4037BFA740A5BF6CC01A4013403D3F204012C1A0BF2FBF0AC07EC075C009C0A94085C066BEB13F8EBE51C06DC038C00DC04BC01B401DBF1140573FA3400C40AE4011BF373F224098BE53BF1E40A8C053C0C63F0840D5BF06C11C40944056C08D40DFBE87BF5D40544024C0E63F96BF4640A4BFB4BF84BE02C0"> : tensor<20x20xbf16>
    %1 = stablehlo.constant dense<"0xFABE1C3E64BF133ED44053402240D63FAEC03340A8C0AAC0A23F80C02ABF97C0C0402EC030C05BC083C0DE3F87BF2DC014BF4CBF43C0ADBF25C0944008C0ABC00EBF8F40913FBD3FE43E2641514096C0643F384004C09F3E81C022C0A340EABE93BFA0BFEEC0864066404C3FCDBF793FAD40963EE3BF38C014BFD940AA3F3DC0C0BFA2C0E03E863FA740063BE6BF443F8040D1BF7640BABF683EBD3F084022BF5240CEBF7A4010C019C09ABEE6BEED3B01BFADBEEABBBDBFF3BF064055BF5BBFADC09B3E4DC0B6BE41400A4039C0553FCA3F17BF21BF91BEC1C09C3F9EC03C3FB93FCBC084C0483F493F8940673FBCBF64407140893F17BF4BC09C4085BF2A3F30BFA2C0DC3E96BFC1C0C4C0DFBF694053BF48C083C053C0CCBF08C0263E1FC08BC0E9BFA0C007C085400640D8BF15C0AA3E30C0BCBF65BF8E40313F3040044014404ABF0540CABF633E48C031C0C2BFA63F334026C07BBF23C08DC051BF663C6AC0B0BE693FAFBFAB407540133FCFBF26C09E3FB6C07E40F0BF9A40163E3C3FCA3F28BF45C0AB4058C0D83F954001C0343F3840CFBF2BBE11C0F740AFBFF2C0CBBF053E5C40D3BF0840953F05406B40BF3FB140F13E6940463E3540BA3F6140E2BF2EC03CBF4E4090C0B63F54BFC9BF51BF01C0A8C029C0BA3F23C0683F71C0894017C0AD3FB73F49C0DBBF26BFD9C044BF2DC08C40F0BF61C0F6BF20C0F33FEEBFA2C091BEEEBE23BFB6BFAE3FC340C94083C0C8C041C006BE9EC06ABFA14019BF143D353E26C0E2BF8DBF77BECE404B40B43F40C08DBFAB407B3F06BDEABF56BF84400EBFE9409CBF1DC07AC03BBF2A4075BF33BEAAC0283F2E3FD1BF1BC07D3F8740404055C0B3BFFD3F3240573FF73E65C0ADC02F40563F064082C00340533F2B4083BF99BF0C402C3F97C00740C3BF6DC0FBBE0A3EBF408F40023F823F61C0A840EEBFC73FFE4052C0D73F26C00E4067C0CB4061C0DDBF2A409CBF564090C0CFC009C06FBEBE3EB9BF2EC03A405FBFDA3FB9BDFB3F8E3FAAC05E3FABC0A540563E823D25BF01C03DBF583EED3FF3C0A54055BE8440E0BFA540A0BF1D3F95BF063F133FB6BFF2BFA0BEE03E633EA3C04240A6C0B440F6C032405A40A33E"> : tensor<20x20xbf16>
    return %0, %1 : tensor<20x20xbf16>, tensor<20x20xbf16>
  }
  func.func private @expected() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0xFABE6E400640C040D44053402240DC3F6140334084404240A23F80C0FD3F43C0C0402EC02F3F9F3F98BFDE3F56404D3E14BF4CBF43402F40B03F94404D3E2A3E22408F40C83FBD3FB43F26415140663F643F3840973F9F3E5FC01ABFA340EABEED3FA0BF6D3F8640B540B840873B793FAD40963EE3BFD53F3340D940CE3F3640323FC4BFE03E863FA7400740BA3F443F8040094076404F408E3FBD3F084022BF5240CEBF8440E83F24409ABE653EED3B01BFD43F6640A2BE9A3F634055BFF73E3BBF093F4DC0274041400A40AF40804031400C4021BFAD405D40C9409EC00C40B93FC7BF9040483F12408940673FBCBF64407140E43F17BF8EBF9C40C1BE943F30BFB83E733F96BF5040AABE6DBF6940AC3D40C004BE53C083BED640263EFABD08C0903F133FC04085400640D8BFDF3FAA3EC7BE9C40F33F8E40AB403040044014404ABF2C40003F6F40754007BEC2BF7C40A4401F407BBFA53F6BBFEB40023F6AC0A33F693F3FBFAB40C140C13FCFBFBB3F9E3FC63F7E4066BF9A40B8403C3FCA3F28BFC53FAB408340D83F954001C0963F3840CFBFC73D04BFF74054BF4740C93F9F3F5C400441E940953F05406B40BF3FB140BE3F69400E403540BA3F6140C4BE0FC06B404E4010C0B63F0740BE4051BFB03E6EC0433FBA3F9A3F683F94BF8940D73F79406B409640803F0B41ADBE44BF2DC08C40F0BF38BFF6BF88404A40EEBF423D91BEEEBE23BF603FAE3FC340C9400FC09740263F04405D406ABFA14019BF4C3F353E26C0A040E73F0D3DCE404B401F40BBBFD13FF5407B3F343F95BF56BF84400EBFE9408DBF8F407AC03BBFD340504033BE2440DE3F6C3FD1BF1BC07D3F8740404055C0B3BF38403240573F2F40CCBF08402F40853F064082C00340B83FFE4032BF48407740944066C0AB4005BF0EBF68400A3EBF408F40023F823FAD3FA840EEBF4D40FE40A740D73F26C01A401340CB402040DDBF2A402FBF56407EC075C009C0A940BE3E66BEB13F3A405FBFDA3FB9BDFB3F8E3F1B405E3F1140A540A3400C40AE4011BF373F2240ED3F53BFA54055BE8440C63FA540A0BF1D3F1C409440133F8D40DFBEA0BE5D40544024C0424096BFB440A4BF32405A40A33E"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
}
