// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xf16>, tensor<20x20xf16>)
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.maximum %0#0, %0#1 : tensor<20x20xf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xf16>, tensor<20x20xf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xf16>, tensor<20x20xf16>) {
    %0 = stablehlo.constant dense<"0xC4A209201FBFBA3D1BC5B3404AC5063FEBC478C4AD427D3A2143CDC4EEC48DC569407AC3B935F23C28407F3EADB75FBC4F4215485EC345C223C54EC5174547405AC44141E5C30DC15C3F2A3CC5386142A8BEDB425C410B40F0B94C3EF7BD4DAD453C2A3CF0408BBC66C4E64029C494C140C468442DC0E041BF421CBE07422CC00FC30FC242BB6DC293C07C3FA044ED3E3F3E36B87C3D51BB1EADBBC41A403D4663BD5327DB416DC06B3C23C4453D6BB673362C412F3C88C527408FC26DBE1FC573BCE72BDFBD9E4005C53EBB6A3DC7C038AC06B858C3074165C0ECC0F0C23E449BB65FB9A34113BE2DBEC1391AB8673B10B2A3384AC73E3513C0FB3DA2BBE8437AC4A235FABB6DC2A3C446449BC22E4252BFED449DC0E744B1C00841FE385AB23DBF21B0CB460F4201BC5A2EB64695C44E4673BFC5BF21C1883B12C114406C405B41B3BDC0B6F93F4EAD4742AAC39F43634457C418BBE3C0FEB91CBA3F4016BAFBB9F53E30C5101A77B7DBC371AF153D58C0D245B33EC7B59BB53D416944FCB448C46FC2A3BE59459331E8BEF9C06CC0EE3C08BD192CBC4369B6513F093A5F3EA6C44531E8403CB743411B37E9B1E2BD183E6DC323C30BC2F042E836C7C24A457944DFBF71C0D2BD04BF7BC718BF90B9DCC570C276BECAC171BE04B5A3B44446C0398E37DC3FF4B0A6434C40304301C4BF42C0BDA4BCF8C408C3E13E46BB36C365BE64BF1E3FB3AFDAB4CAC6AFC5DCC1193BDCC5893F1BC4E33E31349DC40DC31741953D9BC12A34AB40294432BEA8C1A33CF2BC373E25425E24213C2B416A42AD371F41CCB4E93EBB445EBE3BC620C050C0C92EC544C64054442E3B2844C245B63B5E40C13F26BE8ABE9EC00EBCF1C1F9B021BFB3C4263C29400E3B2C4061C3D23E6244513F6644AFC13C38AFC45EC3D8440845253D22432144A03193398A41CDC02BB96A414FC3C23D77C0F6B4D9BDD13D58B22F4110BFEC417E38F6C00F3910C3D6BDEA414F452040FDBE1C3BA9C30B3F082A2B47DD38EBB8DDC33B40F632E635CC3F673B42C457C45D4234B9493E1BC135BF9238344053316332083D2CBE854619B3C038F7B12D44A0BD26BD19C31AC0E83D443CA839CB44E6BE74C2E0BE"> : tensor<20x20xf16>
    %1 = stablehlo.constant dense<"0x0DC1204293BD37B75F460A3F853C7FBA23C3EE37A73F81C323C490BDCA3D29286FC1BCC1CBBE92C30E3A85C445C5C938E9B7D245BB3EEFBDC44051447D3514C45B4155C4C138B33FBCBCD736AD46503AABC0383F30BD2B44D9B22144BE361FC098B9EEB8D33EE9425DC16142DBB97EB546BD1FC00E41F9C454442E4463BB00C33EC0F13D62B8E240CE2C35C20DC423C260C073B9CA40333936C3613E68C66BC480464141C54197406CBD02B9F7C582C04FB711C6DB3882312345153501BE75BD8642653DFEBEF4C33D4062433C3E6EBC3AC882B7A0C400B3644633BCF543294493BBA5459F4020BF84C66C3F5E41073F6A3F0B3887C3BDC1D2C5EEB364BDB32DE7B9C73E573404C0F33F7ABD67C12F36D3C0AD390943E94271C2F3404B39B8C3704422C19FC07C47B2C44DC1ECBC5C3B97C283340BC058C42948C2C5B9BC5EBC57B6914315C2E4A934C121BB7E4278427833A7C03DB71B4476BC4C3D0F40872DAD4035B869C1A63EB3C569C401BD4DBD97C43A441EC334414D40E535A1B969B5E338C3C23EBC92C1C42DBA3EFC4015BE1FC1261F50BC41B1EFBF244196C1B745FA3D23C1B440B73F53BE273CF634FBBD9EC1673D08B86BBE90BAA83B45B4CAC6F1C481C5DABC25BDC83F8D41D2BD87C58142AF367FC02931DF448C3F6F4136C0FD3859BE67B566C18A43F5B943398DC5EBC1DEC2DC4170C23EBEC6AD84BA6CC48C40664312430EC3903C2FC01D3A782448BFEEC12344D6C10E40A0ADD0C21FBFA63E72C28F448E44C6425E2E45445A3DFABE7EBE583C252D8944EEB61AB9CBC0C931533F13C067C6A538123589C0A5399C3C334097C0BB3C14C4813AE63F55BC5B41CF3FF8C22DC4CCBC7747B3BD4045363B89C3ECC40DBA0CBFAA3EF9411D34B4C17243A3389FBFE1C3393A1CC30EBEF5C0663F8840D5C10D4257BF9CC033C26BBF33C3F6C0F7B6F1C14DBCB240463AE14334BA1B3858C4A33AB9C202C97D3D52C1C7C211BCB243CCBF173DD83DB8B6A7C3A0C1AC42E2C6114797BFFEBB30C17D4437AE14C5093EF7C5A5C283BF43BB733D624234383BC6A3400637B1C0083A70BFB94240B8053EBF406A3E73428D3F41C0CDC19FC18B3CA9B874422A42E743"> : tensor<20x20xf16>
    return %0, %1 : tensor<20x20xf16>, tensor<20x20xf16>
  }
  func.func private @expected() -> tensor<20x20xf16> {
    %0 = stablehlo.constant dense<"0xC4A2204293BDBA3D5F46B340853C063F23C3EE37AD427D3A214390BDCA3D29286940BCC1B935F23C28407F3EADB7C9384F421548BB3EEFBDC4405144174547405B414141C138B33F5C3F2A3CAD466142A8BEDB425C412B44D9B22144BE364DAD453C2A3CF040E9425DC16142DBB97EB546BD68440E41E04154442E4407422CC03EC0F13D62B8E240CE2C7C3FA044ED3E3F3E36B8CA4033391EAD613E1A403D4680464141DB4197406B3C02B9453D6BB673362C412F3C82312345153501BE75BD8642653DDFBD9E403D4062433C3E6EBC38AC82B758C30741644633BCF5433E449BB6A545A34113BE2DBE6C3F5E41073F6A3FA33887C33E3513C0FB3DA2BBE843E7B9C73E573404C0F33F464467C12E4252BFED440943E744B1C008414B395AB2704421B0CB467C4701BC5A2EB6465C3B4E468334C5BF21C1294812C114406C405B419143C0B6F93F4EAD47427E429F436344A7C03DB71B44FEB94C3D3F40872DAD40F53E69C1A63E77B7DBC371AF153D58C0D245B33E34414D403D416944FCB4E3386FC23EBC59459331BA3EFC4015BEEE3C261F192CBC4369B62441093AB745FA3D4531E840B73F4341273CF634E2BD183E673D08B86BBEF042A83B45B44A457944DFBFDABC25BDC83F8D41D2BD90B98142AF3676BE2931DF448C3F6F414446C0398E37DC3FF4B0A6434C40304301C4BF42C0BDDC4170C23EBEE13E84BA36C38C4066431243B3AF903C2FC01D3A7824193BEEC12344D6C10E403134D0C21FBF1741953D8F448E44C642294445445A3DA33CF2BC373E25428944213C2B416A42AD371F41CCB4E93EBB44123589C0A5399C3C3340C544C64054442E3B2844C2455B415E40C13F26BECCBC77470EBC4045363B21BFB3C4263C2940AA3EF9411D34D23E6244513F6644AFC1393A1CC30EBED8440845884022432144A03193398A416BBF2BB96A41F7B6C23D4DBCB240463AE14358B22F4110BFEC417E38F6C07D3D52C1D6BDEA414F452040173DD83DB8B60B3F082A2B47DD38114797BF3B40F6327D44CC3F673B093E57C45D4234B9493E733D624292383440A3400637083D083A8546B942C038053E2D446A3E73428D3F1AC0E83D443C8B3CCB4474422A42E743"> : tensor<20x20xf16>
    return %0 : tensor<20x20xf16>
  }
}
