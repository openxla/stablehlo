// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xui8>, tensor<20x20xui8>)
    %1 = call @expected() : () -> tensor<20x20xui8>
    %2 = stablehlo.maximum %0#0, %0#1 : tensor<20x20xui8>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xui8>, tensor<20x20xui8>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xui8>, tensor<20x20xui8>) {
    %0 = stablehlo.constant dense<"0x03010002020001030401010002000003040104040102010002000201000303010300050104000000000001050202010003000003020100000106000402020204030302000100020003000300060500040001010304020007000501030A08020100010000010202040405010104000403030402010303040204040300030100020000060200020301060203000202000202030101030002050100000203010003030401020206070102060302020303020000040305050303000204010005000100020602020400050100010102010101010003050102010300000406020100040102010100050404010301050301020102050200030304010000010105000301020301010101020003020105010001040402000109030002010001030102020301060000020203030301000300070202010304030001020300020000020100020101070405000006020102060001010101030101030101000000000000020006030800030306020100010104010000040004070000020100030200000203020401000101000403010200040002010001"> : tensor<20x20xui8>
    %1 = stablehlo.constant dense<"0x00040400010501010304010102020104030000000104010000050002030001000104020204010500010001000602030106000301020200010002030201050100070100000303000205040003000000020103030104040200020104010402010800020002010201010400040200020200000402000202060405000102000101000201000000030002030103000303000202000100000204000201000200000B01000103010201000201000101000000020001010100040100050003030101010103000000070003040100050101030105040300040201030103030000030403000202020301040104000000050104020201000104020102010002020305000300020304040301020003030101020200030002030401010200020703010003020402050104030101010203000000000000000000000104020402020002030002030003040005000002000106030201010303030301000100000101010101000002060501080102000301020001000102030101020200010600000302040000010002050902030101010002020001070300"> : tensor<20x20xui8>
    return %0, %1 : tensor<20x20xui8>, tensor<20x20xui8>
  }
  func.func private @expected() -> tensor<20x20xui8> {
    %0 = stablehlo.constant dense<"0x03040402020501030404010102020104040104040104010002050202030303010304050204010500010001050602030106000303020200010106030402050204070302000303020205040303060500040103030304040207020504030A08020800020002010202040405040204020403030402010303060405040302030101020201060200030302060203000303000202030101030204050201000203010B03030403020206070202060302020303020001040305050303050204030105010103020602070403050100050102030105040303050202030303030406030403040202020301050404010301050304020202050204030304010002020305000301020304040301020003030105020201040402030409030202020703030103020402060104030203030303000300070202010304030104020402020002030102030103070405000006020106060201010303030301030101000101010101020006060801080306020301020104010102040104070200020600030302040203020402050902030403010202040002070301"> : tensor<20x20xui8>
    return %0 : tensor<20x20xui8>
  }
}
