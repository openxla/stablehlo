// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.minimum %0#0, %0#1 : tensor<20x20xi16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xi16>, tensor<20x20xi16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xi16>, tensor<20x20xi16>) {
    %0 = stablehlo.constant dense<"0x03000200030001000000FEFF020003000600FAFFFCFF000000000000FDFFFFFF00000000FFFFFEFF00000100FCFF0100FDFF0300FCFF00000000FCFF0000FFFFFFFF0100FEFF02000000FEFFFDFF0300FEFF0100040004000100FEFF0200FDFFFEFF00000200FEFFFDFF00000300FCFFFDFF010000000000000001000000FEFF0200FDFFFFFF010002000100FDFF03000000FCFF000007000000FDFF030002000400030000000100FFFF020004000300FEFF020000000400FFFF0000FEFF0100FEFFFDFF0000FEFF0000FEFF0400FEFFFCFF010000000300FDFF0000FEFFFEFF00000100FCFF00000600000006000400FBFFFCFF020002000400000004000200FEFF010003000000FDFF01000400FEFF0100FEFF0000FEFFFCFF0100F9FFFFFF0000FFFF01000000FBFFFEFF00000600FDFF0100FFFFFFFF00000000FEFF0000040000000000FEFF0300010003000100020000000000020002000200FBFFFBFF03000300FFFFFCFFFFFFFEFF0100010000000000020001000000FDFF0300FEFF00000000FEFF06000400000001000100000000000100000000000000FFFFFCFF0200FFFF0000FDFFFFFF0200FEFF01000300FFFFFDFF01000000FEFF020004000300FDFF0200000003000000FBFFFFFF0100FCFFFEFF0000000004000300FFFF000003000300FEFFFFFFFEFF00000100010004000300020001000000010000000000FCFFFDFF00000000FEFFFCFF07000100FEFFFCFFFEFF000001000100FCFF0000FDFF0000FBFF020000000000000000000000FFFF010002000100FDFFFCFF03000200FFFF02000000FFFFFBFF0000010002000300FFFFFEFF02000200FDFF040003000000FCFF0100000002000100FEFFFBFF010000000000FCFFFEFFFFFFFFFF0300020005000100000004000300FFFF020000000100FEFF000000000300FFFFFEFFFEFFFCFF0000FFFF0000010001000000FBFF01000000FDFF0000FEFFFFFFFBFFFCFF0300FFFF0000FFFFFFFF0000000002000200000000000200030003000000FFFF01000000FDFF00000100FFFF0000FDFF0000FFFFFEFF0000FBFF000000000000FFFFFFFFFAFF0300FCFFFCFF0600030000000000000000000600"> : tensor<20x20xi16>
    %1 = stablehlo.constant dense<"0x02000000FEFF00000000FDFFFFFF0000FFFFFEFF02000200FBFF0200FCFF0000FEFFFFFF0000FFFFFEFFFEFFFBFFFCFF0400FEFFFCFFFCFF0000010000000100F9FF040001000000000003000200FFFF0400000000000000FEFF040000000300FBFF01000400FCFFFEFF00000300FDFFFFFFFEFF0300FEFF0000060006000200FDFF0000FFFFFFFFFDFFF9FFFDFFFFFFFFFFFEFFFEFF0000FFFF01000400000003000200FFFFFFFF0300010000000300FFFF0300FBFF000000000400FEFFFEFF0400FCFFFDFF040005000300020002000200FFFF0000FBFF00000100FEFF000006000100FDFFFCFF0300FCFF040000000100FFFF0100FFFFFFFFFCFF0000FFFF03000600FCFF01000300FDFFFAFFFEFFFFFF01000600000001000500010000000600020005000000FCFF0000000001000000FEFF00000000FEFF050006000000030005000000000003000200010001000300FCFF0200FDFF0100FFFF00000000FEFF0000000001000200FBFFFEFF02000000FCFFFEFF000002000100000002000000FDFF010000000000FDFFFCFFFDFFFAFF000000000200FEFF020000000200FCFF00000000FFFF00000000FEFF02000300FDFF0700FDFFFBFF000005000400FDFF01000200FCFF000004000000FDFF0300FCFFFEFF02000100FFFF03000300FFFFFFFF020002000600020001000000FFFFFCFF0000FDFFFEFF0000FEFF0000FCFF02000000FDFFFFFFFAFF0000FEFF00000200FEFF00000000FCFF0100FFFFFFFF0100FBFFFFFF03000100010002000000FFFFFEFF01000300FBFF000004000300FFFFFCFFFAFF0600FEFF0000050002000000FFFF06000000FFFF000002000500FEFF0100FDFF02000100FDFF0300FEFFFFFF0200FEFF0300FDFF0300FFFF010000000300FFFF00000200FFFF010001000000FBFF010000000000FFFFFDFF0300FFFF010000000000020002000000FAFF0600FEFF0100010000000400FEFF0100000000000000FDFF0200FCFF0000FFFF0000FFFF00000000010003000000FEFF0000FFFFFFFFFFFFFCFFFFFFFDFF0000FFFF0000FEFF0000FDFFFDFFFEFF0400FDFFF9FF000000000000FBFFFCFFFEFFFBFFFEFF0000FFFFFDFF00000000"> : tensor<20x20xi16>
    return %0, %1 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> tensor<20x20xi16> {
    %0 = stablehlo.constant dense<"0x02000000FEFF00000000FDFFFFFF0000FFFFFAFFFCFF0000FBFF0000FCFFFFFFFEFFFFFFFFFFFEFFFEFFFEFFFBFFFCFFFDFFFEFFFCFFFCFF0000FCFF0000FFFFF9FF0100FEFF00000000FEFFFDFFFFFFFEFF000000000000FEFFFEFF0000FDFFFBFF00000200FCFFFDFF00000300FCFFFDFFFEFF0000FEFF000001000000FEFFFDFFFDFFFFFFFFFFFDFFF9FFFDFFFFFFFFFFFCFFFEFF0000FFFFFDFF0300000003000200FFFFFFFFFFFF010000000300FEFF0200FBFF0000FFFF0000FEFFFEFFFEFFFCFFFDFFFEFF0000FEFF0200FEFFFCFFFFFF0000FBFFFDFF0000FEFFFEFF00000100FCFFFCFF0300FCFF04000000FBFFFCFF0100FFFFFFFFFCFF0000FFFFFEFF0100FCFF0000FDFFFDFFFAFFFEFFFFFFFEFF0000FEFFFCFF0100F9FFFFFF0000FFFF01000000FBFFFEFF00000100FDFFFEFFFFFFFFFFFEFF0000FEFF0000030000000000FEFF03000100010001000200FCFF0000FDFF0100FFFFFBFFFBFFFEFF0000FFFFFCFFFFFFFBFFFEFF01000000FCFFFEFF00000000FDFF0000FEFF0000FDFFFEFF00000000FDFFFCFFFDFFFAFF000000000000FEFF0000FFFFFCFFFCFFFFFF0000FDFFFFFF0000FEFF01000300FDFFFDFFFDFFFBFFFEFF02000400FDFFFDFF0200FCFF00000000FBFFFDFF0100FCFFFEFF00000000FFFF0300FFFFFFFFFFFF0200FEFFFFFFFEFF00000000FFFFFCFF0000FDFFFEFF0000FEFF0000FCFFFCFFFDFFFDFFFFFFFAFFFCFFFEFF0000FEFFFCFFFEFF0000FCFF0100FCFFFFFFFDFFFBFFFBFF02000000000000000000FFFFFEFF01000200FBFFFDFFFCFF0300FFFFFCFFFAFF0000FEFFFBFF000001000000FFFFFFFFFEFFFFFF0000FDFF0400FEFF0000FCFF01000000FDFF0100FEFFFBFF0100FEFF0000FCFFFEFFFFFFFFFF00000200FFFF00000000FFFF0100FFFF0000FBFF0100FEFF0000FFFFFDFFFFFFFEFFFEFFFCFF0000FFFF00000000FAFF0000FBFF01000000FDFF0000FEFFFFFFFBFFFCFF0000FDFF0000FCFFFFFFFFFF0000FFFF00000000000002000000FEFF0000FFFFFFFFFFFFFCFFFFFFFDFFFFFFFFFFFDFFFEFFFFFFFDFFFDFFFBFF0000FDFFF9FFFFFFFFFFFAFFFBFFFCFFFCFFFBFFFEFF0000FFFFFDFF00000000"> : tensor<20x20xi16>
    return %0 : tensor<20x20xi16>
  }
}
