// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xf32>, tensor<1x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.broadcast_in_dim %0#1, dims = [0, 1] : (tensor<1x20xf32>) -> tensor<20x20xf32>
    %3 = stablehlo.bitcast_convert %0#0 : (tensor<20x20xf32>) -> tensor<20x20xi32>
    %4 = stablehlo.bitcast_convert %2 : (tensor<20x20xf32>) -> tensor<20x20xi32>
    %5 = stablehlo.compare  NE, %0#0, %0#0 : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<20x20xi1>
    %6 = stablehlo.compare  NE, %2, %2 : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<20x20xi1>
    %7 = stablehlo.or %5, %6 : tensor<20x20xi1>
    %8 = stablehlo.constant dense<0x7FC00000> : tensor<20x20xf32>
    %9 = stablehlo.bitcast_convert %8 : (tensor<20x20xf32>) -> tensor<20x20xi32>
    %10 = stablehlo.constant dense<-2147483648> : tensor<20x20xi32>
    %11 = stablehlo.constant dense<2147483647> : tensor<20x20xi32>
    %12 = stablehlo.and %3, %11 : tensor<20x20xi32>
    %13 = stablehlo.and %4, %11 : tensor<20x20xi32>
    %14 = stablehlo.compare  EQ, %0#0, %2 : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<20x20xi1>
    %15 = stablehlo.constant dense<0> : tensor<20x20xi32>
    %16 = stablehlo.compare  EQ, %12, %15 : (tensor<20x20xi32>, tensor<20x20xi32>) -> tensor<20x20xi1>
    %17 = stablehlo.compare  EQ, %13, %15 : (tensor<20x20xi32>, tensor<20x20xi32>) -> tensor<20x20xi1>
    %18 = stablehlo.and %3, %10 : tensor<20x20xi32>
    %19 = stablehlo.and %4, %10 : tensor<20x20xi32>
    %20 = stablehlo.constant dense<1> : tensor<20x20xi32>
    %21 = stablehlo.or %19, %20 : tensor<20x20xi32>
    %22 = stablehlo.compare  NE, %18, %19 : (tensor<20x20xi32>, tensor<20x20xi32>) -> tensor<20x20xi1>
    %23 = stablehlo.compare  GT, %12, %13 : (tensor<20x20xi32>, tensor<20x20xi32>) -> tensor<20x20xi1>
    %24 = stablehlo.or %23, %22 : tensor<20x20xi1>
    %25 = stablehlo.constant dense<-1> : tensor<20x20xi32>
    %26 = stablehlo.select %24, %25, %20 : tensor<20x20xi1>, tensor<20x20xi32>
    %27 = stablehlo.add %3, %26 : tensor<20x20xi32>
    %28 = stablehlo.select %17, %4, %21 : tensor<20x20xi1>, tensor<20x20xi32>
    %29 = stablehlo.select %16, %28, %27 : tensor<20x20xi1>, tensor<20x20xi32>
    %30 = stablehlo.select %14, %4, %29 : tensor<20x20xi1>, tensor<20x20xi32>
    %31 = stablehlo.select %7, %9, %30 : tensor<20x20xi1>, tensor<20x20xi32>
    %32 = stablehlo.bitcast_convert %31 : (tensor<20x20xi32>) -> tensor<20x20xf32>
    %33 = stablehlo.custom_call @check.eq(%32, %1) : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<i1>
    return %33 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xf32>, tensor<1x20xf32>) {
    %0 = stablehlo.constant dense<"0xDA75E6BF38384340CF916FBF395B48C0222BA5C0A36C7D40E40B6FC0A538FC3EBDE5DA3FAB8D50BFAFBAA6C0EA42A3C0FB5B04BE16B4D9BF114CBE40A93ABC3ED8BE1DBFE59D19C0392358C0B2AC1440CB9FEABFA5D61640F789B1BE63E712C012D980BE58D35CBFA2A7013F634C0FBFEC9C1540D81870C0CDDD2CBEA70E7A409E9C2F409CBD923FA33BED3ED31101BEBA69E7C0407B56407C1B8F4046ABFE3F80ED28BF0C9EAFBFE62B753E49739ABFFF420940D3710BC01279B83F5D89DEC07CF2BEC0FAEE1BBF2EAC52BF6D79D5C0477C274061E9B0BF1DFC0CC0B5A4C340158E57BFA20C3B3F40C5573F6A5098C0A1B51340B90B2C40EBEB833F00BC583FA925BD3DA61B22408C386DC086ED9340D43B7A3F99E50FC06667BE3E425427C0F5793FBFB85C7FC0C7428040204E4BBE77DE09407EC09E4087C2C7C05070583E9E94EE3E3C1A3AC0E82FAABFA23D4C3FAD4E9ABFB86490BF7CC655BFE5F907409C714640339AA4BF9FEA39C090B999408A3CA0C0A9978CC01C734B40901A1E3D77EB24C04208C340237A12C02D6317C16BDEBE3F5F9BD540DD71963F438452C0696017C0816FCEBFA6096D408E4B3B3F54CDA0C0A6A425407CFC46C025F70A4029666B3FE7AA2DC0A4CE7BBFAD7D903FC57D98C01886D93E665B04C0163880BFC6608540590E75BF5F4E9E3FE3232CC0923412BC316888408B7D8ABE7E1FAF4049F5EB3E8E4316C024EEB2BEE70A7940C42E27C0796FC7BFCF32EA3F764E793F41870A40356564402925263FB770CB407D8CD23D975ECD40027F3F400A31DB40477015407FE995C013FC7340447EF13E0FE666400B57EFBE6D0BE93F7EA5024018B891BF7787A2C0CE56403F169D3540F478A2BF30896C3FD7EB42BFA0B4D9C00B9DE13F63DD9DC00E5E40BD189B8DC070951BC01232A33E2EA96540CC7A2DC0C75FCBBE11AAACC0C6E43AC049BFFE3F45940440B41C96403F920FC0FA48D0BFF01597BFC19326C06710383F74A3E0BEE31CCC3F8F45DA3FB109B9407B1A2240BB501BBF92D0A5C04C70A93F0D3050C043470B403C9939BF18B0CD3F476BDDC0312AA53F4C5A994057A5713FD18A6640E969163D3810F53F14343F3C0F48833FF14E61BF084376BF34EF11BF7B1CB140723A3CBF650643406AB46EC0309D0C408B002EBF144E504027C210C117B023C00C878FBF2DAA57C01153A4C07473CD407897634052E82EC06496C73E31275AC033FF1DBEAA3249BF6AD170BF37525BC0574C5FBF30F809C156BFD03E865CC9C05ACBAABE93459E3F2E3705405480443EBFD5543EFB1AEF3E5F7F6A3FC6188A400D9FE0C070BD9C3F8C3C6EBE14A7383F8DDDC440932ADD3FE02A5CBF0C8F1440A87B40401B033C40535109C063908D3EBBCE9BBFA9B0653F90C6A53FB7172A406B5F80C0E3C08240516DBB3F92967CC0A8BDCABEB49A0A3F54352FBF4D8E4C40F94E0DC0F3DDDBC00FA9DA40D73167C09A998C3F21F30BBFEEDF9EC03DF7D4C0F9B1C5C04FEEC1BF0CC9A4BFA2318A3F6AB6B83E57C17E40631883403279B540AFCF5D40842A63BF88E9B9BF43D1A3BF1FFD98C07EF49740E1C22DC01C982E404A2A893FB8E84340C041293FEA218D3F50EC41C0F02269406F62544039D3853FD74A2EC0D3BE6C40C747C4BFBD5476BE64880EC0ADC42D40FBF57FBFD93224C069B677BE64E775C03DC651BFC617AE3FA22C2F403B0336BFD93ACABF278C00C0619928C0E4A39C40A240E93FCD64F7BFC5BF224041BB0EBF0A2464BF78468CC04C66823E23F18540DCDC5BC0E0DF553FFFB09A40C4BFC23FFC2D2DBFA64D68408D2249C00050033FA847D7405B7A443FF6562BC0C2BD12BF956049C0A98BF63FF3B51AC0E92C01C0824503BF4C7C7CC0AA52533E52E082BF426AB93F321BFABF07469DC0EC6AA43E6A371AC0BFE823C0E9BA15405CED8B40F9E30F40FE3EE7C0242B803E97A41F3DC3EC51C04C4B6FC0C14B85BF80CAE13F041BB3BEE9646AC01ABE01C1ACA2BC3F57EE8EBF329EAF3F40C7F03E339E8A3FC2CDA8C097ED7440E037683FC9D4AA3E0B8881C03E0C5640667DDEC0B8A58DBFD3BB3F3FFF1A0D404B0E463E0FE36E406B2B10C0F44EA9BFAFAEEE3EDAF446BF67AB2CBF7AF57BBF64F6FCBC95A10AC00631E94069E49F3D90D8C43FBC6B2540B5534040BB73A0BEA9E623C009B3BD40E80F083F1F14F5BFAD27513F6934D73F0FBFC4BF8E109C4049C0B43F6F1BB1C00430704081C0DB3E"> : tensor<20x20xf32>
    %1 = stablehlo.constant dense<[[-0.591697216, 1.01310813, -0.187177882, 0.943185508, 1.335199, 0.394654512, 2.13180828, 1.07401621, 0.223782241, 1.42752457, -1.01192188, -4.60137796, -2.3607235, -5.33613634, 2.01095176, -1.89033687, 3.90281153, 0.552069724, -0.547353327, -0.962656676]]> : tensor<1x20xf32>
    return %0, %1 : tensor<20x20xf32>, tensor<1x20xf32>
  }
  func.func private @expected() -> tensor<20x20xf32> {
    %0 = stablehlo.constant dense<"0xD975E6BF37384340CE916FBF385B48C0212BA5C0A26C7D40E30B6FC0A638FC3EBCE5DA3FAA8D50BFAEBAA6C0E942A3C0FC5B04BE17B4D9BF104CBE40A83ABC3ED7BE1DBFE49D19C0382358C0B1AC1440CA9FEABFA4D61640F689B1BE62E712C011D980BE57D35CBFA3A7013F624C0FBFEB9C1540D71870C0CEDD2CBEA60E7A409D9C2F409BBD923FA43BED3ED41101BEB969E7C03F7B56407B1B8F4045ABFE3F7FED28BF0B9EAFBFE52B753E48739ABFFE420940D2710BC01379B83F5C89DEC07BF2BEC0F9EE1BBF2FAC52BF6C79D5C0467C274062E9B0BF1CFC0CC0B4A4C340148E57BFA10C3B3F3FC5573F695098C0A0B51340B80B2C40EAEB833F01BC583FAA25BD3DA51B22408B386DC085ED9340D33B7A3F98E50FC06567BE3E435427C0F6793FBFB95C7FC0C6428040214E4BBE78DE09407DC09E4086C2C7C04F70583E9D94EE3E3B1A3AC0E72FAABFA33D4C3FAC4E9ABFB76490BF7BC655BFE4F907409B714640329AA4BF9EEA39C08FB99940893CA0C0AA978CC01B734B408F1A1E3D76EB24C04108C340227A12C02C6317C16ADEBE3F5E9BD540DC71963F428452C0686017C0806FCEBFA5096D408F4B3B3F53CDA0C0A5A425407BFC46C024F70A4028666B3FE8AA2DC0A3CE7BBFAC7D903FC47D98C01986D93E655B04C0153880BFC5608540580E75BF5E4E9E3FE2232CC0913412BC306888408A7D8ABE7D1FAF4048F5EB3E8D4316C025EEB2BEE60A7940C32E27C07A6FC7BFD032EA3F754E793F42870A40346564402825263FB670CB407C8CD23D965ECD40017F3F400931DB40467015407EE995C012FC7340457EF13E0EE666400A57EFBE6C0BE93F7DA5024019B891BF7887A2C0CF56403F159D3540F378A2BF2F896C3FD6EB42BF9FB4D9C00A9DE13F62DD9DC00F5E40BD179B8DC06F951BC01332A33E2DA96540CB7A2DC0C65FCBBE10AAACC0C5E43AC048BFFE3F44940440B31C96403E920FC0FB48D0BFEF1597BFC09326C06610383F75A3E0BEE21CCC3F8E45DA3FB009B9407A1A2240BA501BBF91D0A5C04D70A93F0C3050C042470B403B9939BF17B0CD3F466BDDC0302AA53F4B5A994058A5713FD08A6640EA69163D3710F53F13343F3C0E48833FF04E61BF074376BF33EF11BF7A1CB140713A3CBF6406434069B46EC02F9D0C408A002EBF134E504026C210C118B023C00D878FBF2EAA57C01053A4C07373CD407997634051E82EC06396C73E30275AC034FF1DBEA93249BF69D170BF36525BC0564C5FBF2FF809C157BFD03E855CC9C059CBAABE94459E3F2D3705405380443EBED5543EFA1AEF3E607F6A3FC5188A400C9FE0C06FBD9C3F8D3C6EBE13A7383F8CDDC440922ADD3FDF2A5CBF0B8F1440A77B40401A033C40525109C064908D3EBACE9BBFAAB0653F8FC6A53FB6172A406A5F80C0E2C08240526DBB3F91967CC0A7BDCABEB59A0A3F53352FBF4C8E4C40F84E0DC0F2DDDBC00EA9DA40D63167C09B998C3F20F30BBFEDDF9EC03CF7D4C0F8B1C5C04EEEC1BF0BC9A4BFA1318A3F69B6B83E56C17E40621883403179B540B0CF5D40832A63BF87E9B9BF42D1A3BF1EFD98C07DF49740E0C22DC01B982E404B2A893FB7E84340C141293FE9218D3F4FEC41C0EF2269406E62544038D3853FD64A2EC0D2BE6C40C647C4BFBE5476BE63880EC0ACC42D40FAF57FBFD83224C06AB677BE63E775C03CC651BFC517AE3FA12C2F403A0336BFD83ACABF268C00C0609928C0E3A39C40A140E93FCE64F7BFC4BF224042BB0EBF092464BF77468CC04D66823E22F18540DBDC5BC0DFDF553FFEB09A40C3BFC23FFB2D2DBFA54D68408C2249C0FF4F033FA747D7405C7A443FF5562BC0C1BD12BF946049C0A88BF63FF2B51AC0EA2C01C0814503BF4B7C7CC0AB52533E51E082BF416AB93F311BFABF06469DC0ED6AA43E69371AC0BEE823C0E8BA15405BED8B40F8E30F40FD3EE7C0232B803E98A41F3DC2EC51C04D4B6FC0C24B85BF7FCAE13F031BB3BEE8646AC019BE01C1ABA2BC3F56EE8EBF319EAF3F3FC7F03E329E8A3FC1CDA8C096ED7440E137683FCAD4AA3E0A8881C03D0C5640657DDEC0B7A58DBFD2BB3F3FFE1A0D404A0E463E0EE36E406A2B10C0F54EA9BFB0AEEE3ED9F446BF66AB2CBF79F57BBF65F6FCBC94A10AC00531E9406AE49F3D8FD8C43FBB6B2540B4534040BA73A0BEA8E623C008B3BD40E70F083F2014F5BFAC27513F6834D73F0EBFC4BF8D109C404AC0B43F6E1BB1C00330704080C0DB3E"> : tensor<20x20xf32>
    return %0 : tensor<20x20xf32>
  }
}

