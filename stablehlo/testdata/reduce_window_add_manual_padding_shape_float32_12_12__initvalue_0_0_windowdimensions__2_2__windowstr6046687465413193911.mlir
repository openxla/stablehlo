// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<12x12xf32>
    %1 = call @expected() : () -> tensor<12x12xf32>
    %2 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %3 = stablehlo.broadcast_in_dim %2, dims = [] : (tensor<f32>) -> tensor<f32>
    %4 = "stablehlo.reduce_window"(%0, %3) ({
    ^bb0(%arg0: tensor<f32>, %arg1: tensor<f32>):
      %6 = stablehlo.add %arg0, %arg1 : tensor<f32>
      stablehlo.return %6 : tensor<f32>
    }) {padding = dense<[[0, 1], [0, 1]]> : tensor<2x2xi64>, window_dimensions = dense<2> : tensor<2xi64>} : (tensor<12x12xf32>, tensor<f32>) -> tensor<12x12xf32>
    %5 = stablehlo.custom_call @check.eq(%4, %1) : (tensor<12x12xf32>, tensor<12x12xf32>) -> tensor<i1>
    return %5 : tensor<i1>
  }
  func.func private @inputs() -> tensor<12x12xf32> {
    %0 = stablehlo.constant dense<"0xAEDDAABFDD66BE3FD99CC3BF68DEB73E40C594C016A7823FCC8AF9BF16F31040C9E99140DEC4BFBF2B585ABD6B486040D4380340DD2FA54047305EBFE4DBBCC0495C864078E284BEDDF402C04D4DD140DCD6BC3F642ACE3FC8909FBE6BCBA1BF339384C0D2B7983F632C5EC0EBED8FC0A79149BFBF780AC0C7975BC0150D26BF5D46BF3F6A4246407EFBA5BE3CE73EC00BE49F40BCB346BFF075E83CE006303F0B76CEBECAF0AFBF6ECFCE3E86BBA6BFE80923C0505738BE6F9F5A40D3B24A3E03F0ABBF8E9EA2BF7EDE6C4024DB903ED366B540BE38A240008BEDBF873FA7C09045B7408F16B93F604A61404E0C933FAB903E3F7DC3D2C01A73764006141FC084EE85C072985040C783693F0D9AEC3E34B3B040CEE55C403A608440A68C74BFF13238409F13F73FF7758CBFF42DBEC019EE3540DD89D43F8D7784C0DB231B40263108C0F3F41940D319283E1BC9233F4E3483BF2361EFBD4EFFD73E8C2F4BBF0AC793C034253540E4E8B6402B2A65C0A98897BF9F30A4BF6DA99DBFC8B79ABFD639C3401F238ABF2DB7643EA0279DBDB76BFAC0F4B58D3DF7EAF33FA8D315405F64FBBE3C46C03F0CC38C404E1D6B404A26694089ACE9BFEA2F22C08C7F84C0F63D12C12EC7833E741733C0A8785B404B3E10BED7975D4012922440868826C06DE534C09090C93FC19092BFD2E572BF4D141EC0FDB21440066F5B3FEB794E407BE66EBFDCD921C002BBD5C048F6E63F8FE806C038BBB9BFC57AFDBE88560240654D013F985D6EBFD93E52C037B4143E1CB33A40F4335DBF04041AC058703FC0"> : tensor<12x12xf32>
    return %0 : tensor<12x12xf32>
  }
  func.func private @expected() -> tensor<12x12xf32> {
    %0 = stablehlo.constant dense<"0x93AEEB40551C88403C0BFEC0F5C6BFC0702A9F3E07034FC0B6E999402C736D41E1B8C440B44581BE770EF03FB6620F40086788402D03014004D36BC1BB9FDFC068FC7C3FDAD0FCC07E55D43E7CC90D411CB3F5400A5382403D3F9CC079E687C054A1A23F7DAC41C0CA1AE8C0A506A0C0285297C07F17D2C0704F9FC0C24740C076ACEE3F7A4EC040821F9D3E0F3C32C0BEA7CD3F6866D73F43669640008EC740FF5D0F41848D0F403264FFC0985B56C085438E40E83B0341C9860441A862AC3F864A07C150259CBE7B2CAB40102038BFA2FE1C41B052EC402DA8B6C0DE82CF40542C8141FBDE4841E936FB40D82F463E1F4C84BF188AF3BFE89BB5C0B8571CC172EE6440709ED83F58B8AEBE2FF6C84001041441348722412E117F401687A1BE90A76A406AA7913F6E31EDC0F23108C128CA2D406826C240E8E2D63EE5FD8EC0D7180CC08062623D6D79D1BF75A611BFEC4C7840F1040DBF379C66BEA80655C1A8B418C18A5628416038CC4064873AC0244CBABF30BC58406639B4406AC11D4012D9DA4026E6A6C066E6D0C0F476A9C1161D85C18CED10BF2C159C40F06DA44042A58A40C8F43E413CAB00419029893F82CB103F46867BC0364C0CC1969885C1117810C1C2C0233F70DB9640889AB24090F80FBEF8254BC0AAF89CC088354CBFA8F199C01A1AC2BF986A0DBF838F60BF739512BF028F84BF5A88713F565FAB40B85AB4BF38A847C1CF5B24C168EA97BF2BC663C0E919F9BF5F4EC53FE1A922406620DABE20EB86C096F348C05FFE43401F660340015151C02EBAACC058703FC0"> : tensor<12x12xf32>
    return %0 : tensor<12x12xf32>
  }
}

