// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.rsqrt %0 : tensor<20x20xf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xf16>, tensor<20x20xf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xf16> {
    %0 = stablehlo.constant dense<"0x74C47D4298BA2242DAC7802C92450AC892C56F42F0BD1FC7B13A4BBC27BEE2C090C14A4105B6003C06C04742533B063C17474F3C10446D4066473E35124505BE8EC4C442D53E3641CF4370C35B4038BA7E44A23FA8C6ABBFFB38F4386338F64013417CB1F63F1643E9BD5BBC363A76C60FC02CBD104240C2B3AAA7BF9B401AAFD5420C44CABCEA41F6413FBD7AC1EC3C0B4340BE18BD7D409DC29043224034B651B8EBBE28C08EC183C3AFC26CC1D3C2CDC19E2D5FB96EC096408CC26FC56E3BB5A5E9C24F3CE53AEDBC9D35454276BA493C16C58BB4D244A5389ABCFBC6623980BE6EBBB4416BB9B8C261BB1EC484445AC29A432A3C71C27CB87F430E3C693CECC1F8B8D3B68E38403D8040FAB9FBBB1BB90D449D383744DE408AC494C13D452444A6BDEBC025C003442CBF4435D5464D3D62C0CF3C3133B1B6C344D4B8E53FA946BA44FBB77DC1C344F33F2042F1C6A2B942BE033C253B8441AF42D8BC4F3DB639B3BC47C251C48D38E1B125BE5EC3163D9EB5693D4D40BBC15EBD21C13F405642A0C0123030B818BF7F3D27B3A13FCDB8DEB1C1C564BF4CC38A45C9420E4224C1A7BD1640AF44673E40B7B6BC0C407BC7E0390D3E25B7693EFB409BC24F41BAC4D435D3B2883ECBC564BC7940CBB38EBA22BCDF3EC434643C6E4582C45BC15EC39C40A0C0EE3CF43EB23FD5C2C9366A40623F48ADF6B7303F4D41C83BD8B4A1C446C1A7BE20BCB03578C53EC89E2C043BEA3DA844363EAE3DB6C02CC265C231444FBD0EC48BBD713D4140C44254C4BF38B7BFCAC4CDBCF13D4FC2E5393140183CEE407AB17132563F1E3487C087414F404DC323496E391843563F4F46FE44A6BF44C02DC06FC37CB89F451B475E3A1A3E9C337F3E16C1F1C294C4C0B491BD30C3E8C018C2A2BA774213C43D3B0EBEA2C3F5BF3D48FD41133DEA437E446BBF20437245D3B9E6C25B37C5C421401642E63FE24346C061C0DEBC73BC5B3D642B564105C219440242E03C1DC415BFDCC097C02630A0BF03C34BB926BE5AC23C3C223C11415BC5D341D53F6E36F23D693FC54662C4AD4049260EC5513C213E743EE7BBC53B60C6B23945C01C40FF3DBEBB87B3523DB9412A3D7F3A5D4077C2CEB5"> : tensor<20x20xf16>
    return %0 : tensor<20x20xf16>
  }
  func.func private @expected() -> tensor<20x20xf16> {
    %0 = stablehlo.constant dense<"0x00FE713800FE923800FE8B43C83600FE00FE763800FE00FE603C00FE00FE00FE00FEEC3800FE003C00FE84382E3CFA3B0336B53BF0376139E135FD3E1B3700FE00FE5A381F3AF5380D3800FE6C3900FE8D37CA3900FE00FE123D163D663D1439063900FEAB39403800FE00FE8A3C00FE00FE00FE983800FE00FE00FE463900FE5438F43700FEA738A23800FE00FE363B433800FE00FE573900FE1D38913900FE00FE00FE00FE00FE00FE00FE00FE00FE00FEC14200FE00FE483900FE00FE263C00FE00FEB53B4F3C00FEC13E853800FEBA3B00FE00FE4A37403D00FE00FEE03C00FE00FEBD3800FE00FE00FE00FE883700FE1B38D73B00FE00FE2238F23B9F3B00FE00FE00FE4D3DFC3A553900FE00FE00FEF437453DCB37213900FE00FEFD36DD3700FE00FE00FEFE3700FEF93E1F36F33A00FE4B3B384000FE553700FEB13934365C3700FE00FE5537AC39923800FE00FE00FEFE3B3C3CD138603800FEF13ABC3C00FE00FE00FE4D3D00FE00FE00FE183B00FEE13A743900FE00FE00FE7E397E3800FE9B4100FE00FED43A00FECB3900FE00FE00FE00FE00FECC365838993800FE00FE98396537523A00FE00FE9F3900FEAB3C823A00FE523A123900FEE93800FEA13E00FE433A00FE00FE5A3900FE00FE00FE1B3A543FA23BDE3600FE00FE00FE453900FE343B113AC53900FE243E6339E43900FE00FEF739EA380E3C00FE00FE00FE00FE00FEB63E00FE00FE7343453C943A6A376C3AB73A00FE00FE00FED13700FE00FE00FEDC3A7D395A3800FE323D00FE00FE00FE903A00FEA93C8739E83B183900FE7540E839E23F00FED038733900FEFE34DB3C3F38E8395F36293700FE00FE00FE00FE00FEBF3600367C3C7A3A1A40473A00FE00FE00FE00FE00FE00FE00FE00FE00FE733800FE353C00FE00FE00FE7F359F381B3B06388D3700FE3D38DB3600FE00FEE63D00FE92399638B139083800FE00FE00FE00FEEA3A2A44E63800FEE8379D38403B00FE00FE00FE00FE8E4100FE00FE00FE00FE00FEC63BDF3B073900FEB038B739503E903AE039263600FE3B39614600FEB33B763A4C3A00FE0F3C00FEBE3C00FE9539883A00FE00FEF03ABB380B3B713C6B3900FE00FE"> : tensor<20x20xf16>
    return %0 : tensor<20x20xf16>
  }
}
