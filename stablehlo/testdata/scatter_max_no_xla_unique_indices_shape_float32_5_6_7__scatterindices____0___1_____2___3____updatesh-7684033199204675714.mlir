// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = stablehlo.constant dense<[[[0], [1]], [[2], [3]]]> : tensor<2x2x1xi32>
    %1:2 = call @inputs() : () -> (tensor<5x6x7xf32>, tensor<5x2x2x7xf32>)
    %2 = call @expected() : () -> tensor<5x6x7xf32>
    %3 = "stablehlo.scatter"(%1#0, %0, %1#1) ({
    ^bb0(%arg0: tensor<f32>, %arg1: tensor<f32>):
      %5 = stablehlo.maximum %arg0, %arg1 : tensor<f32>
      stablehlo.return %5 : tensor<f32>
    }) {scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [0, 3], inserted_window_dims = [1], scatter_dims_to_operand_dims = [1], index_vector_dim = 2>, unique_indices = true} : (tensor<5x6x7xf32>, tensor<2x2x1xi32>, tensor<5x2x2x7xf32>) -> tensor<5x6x7xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %2) : (tensor<5x6x7xf32>, tensor<5x6x7xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<5x6x7xf32>, tensor<5x2x2x7xf32>) {
    %0 = stablehlo.constant dense<"0xD0AAC5BFAD9B00C0663A3340DC3BFCC02E7C4140D9B3D3BCB1F9EB3FF25437C0FA5A57C0BF483F3F30024AC0C5AF223F08890CC030D117BF02399DC081DDF4BFA8810DBF67D1C1404EF55240E83B1EC0AC344940D59FFC3F2BDF9E40AC2A0D404462CF3F2BFD1A3F0CECA5BF04E689BFCAF00BBFFD27AE3E25633DBFB7115D4082AD563FA02E82BFB838653F15FE8ABF8C319FC0468F43C081753640D074B9BFC7C201BF6679BCBFA8BF7DBFD65C9A40C90D44C0450C264090C928BF5406D1404591643E914DE3403A1FF8BFBF39833FAD8B8E3D493C7140E276F03E699CCD402DB1304046DB5FC076B150BF38FEC8C022000CC07A16DB405B5D8CC0796365407F6531C08A0B10C051A69D3EE4FA9CC064D3B2C09DDA12BEEF64814066DC60BFCA96513F5A27ECBF4C00D540A32ACD3F9D1A79BFB10188C0BBB5A5BF0F4C0440D7D54940E2F387C09F002BC068B78DBFE7C11C40C9897D4036D6534094EB0F3F644083BFA4C31640870559401FAAF4BF659B84BF5DFE39C095AE6C3F523EA03F4756D33FDA42584045008E40A8E7A33F32C3C33F3D881A4044CAFFC03BBA5340C3904DC0998FE2BFAECFA2403D28C93F06679240BDFE1C3F35C9BFC0BDC1F1BF91983CBEC31E49C0F037313F1250A33DF862CEBF370ABCBE7BA3FA3F142D8A40DAF7E240BB925B40B59A0D40F3782A3FA159B34039E6AABFCC159AC0680C51C01019AC40C004D2BFFC8B643E336C6CBF704AECBF4103B13FECC9FD3FBD4EF6BF913A52C01041973F8A79703F77BBC53EF3AC2740D1B9B24004F9E4BFA6C0A340BB0940407CDFDA3F69E894BE60F6933FD02121BF706946C089D8ACC0361B99C096A9F4404CD8E83EF62782401B7227BF82EBAEBFA23D3D3E00540BC01BE9A7C0C5D47F402B3ACC40CABEC8BE97E2813F94645AC090A18C3F2FE4AEBE932624405E85CA3C23D641C00BDB7D40C745313FA84BA63E95F15D3EA4E4E8BF6A147B40F234A4C0FF85F3C09443A93F22E12740DCFFA9C06EC789BF3680BAC0A0E834C0FCCC7B40AAED62C03CA0A9C06A59DDC0EEE5E6C08A106AC07ECDF2BD076E76C017E538BF345219BF7D3F34C041788EBFDD3292BF6364E03F08AE803FCACA0B40F3E097BF90C991BE444693BF200539C065924FC0EC468BBE4F850E40EAAE82C04A7D2A40A9EC45C0"> : tensor<5x6x7xf32>
    %1 = stablehlo.constant dense<"0xDB55393F8094173F1C26CCC0D5AE18BF261736C00982CBBF91653AC0738C75BF13C5B340DBB8643FABA6E23F93662C40CA8E164059A2AB3F0A1D3AC0DF2182C0C77835C0A86F584055978FC0AE70A23FB6AD54407AB618BFE1B9F63FC6016F40F9B58CC039EDBB40808C43C050E473C0924C2BC0CBCA014020601440BF8312C0E17584BFF4869CBF8B54B2BF64C06DC08FEEFC3FFC6C503FF7A9933F380A803EE85C8740081107400B13A33F3854C03F6C1B94C0FA15A440048F5340DCC083C05443163F0A118BC00CB7EEBFE969D33FD1EA4C40AF18B8BFA27B62BC233B94C0F0CCEEBF2964EEBFD264B8BFB87662C0616F16C04E7784C0B779474053D1BF400CF63A40A2628A4059070440F20FCC3CD6F5A63F4EFB9640B8849BBFD0D667C00F1607BF7DAC55C0594DA6C06450014033533CC035AF0040331F1440603437C0F78864BEA9584940B49F5BC0BFE29F3FD7D3C03F36957DBF84E9C9BF7DD487BFCDD2994082BAA23F0A28A53E18A068BE2E41AB3F37A944BEB4969040C4FBA0406476A3403C75993FA3F55D3EF22DB7BF05263AC061B1963F1C6A46BE5F4E8140C90BD63F54DCA3BFBE08B53F1361BC3F65BD9EBDCDE48ABFD6FDFEBF7CDF923EE5F0BFBEBE8FDC403F7426C0EB882D3FFEC3544025A4753D601E6F40102CBAC05B9D2F3F1B1CA6C0FB6B05C00FE6EF3FBE535C3FE9B282C0E4B70640B68F13C04126BB3FE4F2AC402D0C01407A85A03C107693401B40B8BF08F2ACBF057C31C074FB56BF355EEFBF11DCB3C030CBC9BF"> : tensor<5x2x2x7xf32>
    return %0, %1 : tensor<5x6x7xf32>, tensor<5x2x2x7xf32>
  }
  func.func private @expected() -> tensor<5x6x7xf32> {
    %0 = stablehlo.constant dense<"0xDB55393F8094173F663A3340D5AE18BF2E7C4140D9B3D3BCB1F9EB3F738C75BF13C5B340DBB8643FABA6E23F93662C40CA8E164059A2AB3F0A1D3AC081DDF4BFA8810DBF67D1C1404EF55240AE70A23FB6AD5440D59FFC3F2BDF9E40C6016F404462CF3F39EDBB400CECA5BF04E689BFCAF00BBFFD27AE3E25633DBFB7115D4082AD563FA02E82BFB838653F15FE8ABF8C319FC0468F43C081753640D074B9BFC7C201BF6679BCBFA8BF7DBFD65C9A4020601440450C264090C928BF5406D1404591643E914DE3408FEEFC3FBF39833FF7A9933F493C7140E85C8740699CCD402DB130403854C03F76B150BFFA15A440048F53407A16DB405443163F796365400CB7EEBFE969D33FD1EA4C40AF18B8BFA27B62BC9DDA12BEEF64814066DC60BFCA96513F5A27ECBF4C00D540A32ACD3F9D1A79BFB10188C0BBB5A5BF0F4C0440D7D54940E2F387C09F002BC068B78DBFE7C11C40C9897D4036D6534094EB0F3F644083BFA4C316408705594053D1BF400CF63A40A2628A4059070440523EA03F4756D33F4EFB964045008E40A8E7A33F32C3C33F3D881A40594DA6C03BBA534033533CC035AF0040AECFA2403D28C93F06679240A9584940B49F5BC0BFE29F3F91983CBEC31E49C0F037313F1250A33DF862CEBF370ABCBE7BA3FA3F142D8A40DAF7E240BB925B40B59A0D40F3782A3FA159B34039E6AABFD7D3C03F36957DBF1019AC407DD487BFCDD2994082BAA23F0A28A53E4103B13FECC9FD3F37A944BEB4969040C4FBA0406476A3403C75993FF3AC2740D1B9B24004F9E4BFA6C0A340BB0940405F4E8140C90BD63F60F6933FBE08B53F1361BC3F65BD9EBDCDE48ABF96A9F4404CD8E83EF62782401B7227BF82EBAEBFA23D3D3E00540BC01BE9A7C0C5D47F402B3ACC40CABEC8BE97E2813F94645AC090A18C3F2FE4AEBE932624405E85CA3CBE8FDC400BDB7D40C745313FFEC3544095F15D3E601E6F406A147B405B9D2F3F1B1CA6C09443A93F22E12740BE535C3F6EC789BFE4B70640B68F13C0FCCC7B40E4F2AC402D0C01407A85A03C107693401B40B8BF7ECDF2BD057C31C017E538BF345219BF7D3F34C041788EBFDD3292BF6364E03F08AE803FCACA0B40F3E097BF90C991BE444693BF200539C065924FC0EC468BBE4F850E40EAAE82C04A7D2A40A9EC45C0"> : tensor<5x6x7xf32>
    return %0 : tensor<5x6x7xf32>
  }
}

