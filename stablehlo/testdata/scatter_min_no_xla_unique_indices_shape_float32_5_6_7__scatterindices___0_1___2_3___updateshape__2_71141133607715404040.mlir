// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = stablehlo.constant dense<[[0, 1], [2, 3]]> : tensor<2x2xi32>
    %1:2 = call @inputs() : () -> (tensor<5x6x7xf32>, tensor<2x7xf32>)
    %2 = call @expected() : () -> tensor<5x6x7xf32>
    %3 = "stablehlo.scatter"(%1#0, %0, %1#1) ({
    ^bb0(%arg0: tensor<f32>, %arg1: tensor<f32>):
      %5 = stablehlo.minimum %arg0, %arg1 : tensor<f32>
      stablehlo.return %5 : tensor<f32>
    }) {scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [1], inserted_window_dims = [0, 1], scatter_dims_to_operand_dims = [0, 1], index_vector_dim = 1>, unique_indices = true} : (tensor<5x6x7xf32>, tensor<2x2xi32>, tensor<2x7xf32>) -> tensor<5x6x7xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %2) : (tensor<5x6x7xf32>, tensor<5x6x7xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<5x6x7xf32>, tensor<2x7xf32>) {
    %0 = stablehlo.constant dense<"0x22B6FEC05811C0C09F2CDA40CEBAAAC013F5913F6A397F3F144AD13F5116624009B1B53E2F5D46C0E4FC6ABF4DFF1B40140A86C08CCCBBC0B6652540FB935CBF6E238ABE4593AEBF8A41D3BE2DA6E8BF0351543F391091BFBF7820C0C2E50540CFE736407A63B5C0624D2EC10465D4BF6E2605C00BDA2A40CD0A70C0937D94C0C2CD6E3FFF472C400A118DBF8BC7DDBF6A8F3240F6775F40712C8C3FE08054C0A77F1E3F590017401D7FD3BF4A25BFC0B6334940CF7F773F1772C23EFEA91DC02A306B4088CD87C0105409C036656FC097C74140072937C014BECAC0DC566BC0C14733C0546B77BF6A31883E4B4A66C08B599FBFF5703540BFE15FBFCF7C8D3F2AF3A440C673983F12D99840253F5C3F463F68BFB149CA3EF5FAA040BB7CA53FD9D92640F666AFBF6B930D40BFDDCDBFFF67BDBF984C29C0504F10401AE70A40784A46C0F7E6364013310D3F4DE12440C7373640BFB078BE57300FBF2E28D6C005196CC0CC51EDBE42EF30405B0A97BF1A911540D6411140F6A241C02F1177BF0BF530C0CB5CBB3F10BD3FC00E5012405F7FD33EEADA5C404CF6FABE5ACC9A3E801315BF06F1A33E265C853FFE198B3F34FCC73F42F61440AA95A73F752032BF8894993F25E584C0A6350D3F6420F2C0000A4240B4F2CE3F6879FE3E14AA65C0F5491FBFBF6B0FC0188E9D4019820240607E39401405184085B74BBE6EC08D4004F72C407C213CC03972073D0A58DAC0102886C0557004401BEF603F5F40A1BF4CC415C00B3285BF55B71FC0E7C56DC0F0487C40D3EB51BF22C1EEBF4A194D3F46EFE7401E5ADAC047E13FBE3AB5AEC0C0AD1940E3F2EF3E17B31D40CA5B1B4180C33FC068E92CC0F793673F335D3DC0C2FDD33FF31AF6BD442C28C0C7E0A73F98D01BC0A2586F3F6E8CDA408627BA3FEB4C96BE9888393F392B0B405C936CBFF770C9BE03707DC02F21313EF86B3E3F0B9EA84019128C4020C03540A3A84DC01F8C4040F39D603F3A811140C8D68240103034BF59D9C9C040181A3E0A8C7EBF36D8A8BF8889AB3FC19D35401B678FBF2AD2383F44CB2FBF2C533DBF86D3AE406F819BBFF3A5AF3F9709133D84D604408CE7D0BFEBE605C0D0BA493F7B03F83F26B66BC0F7EFAD3F7FA863C030539D3FF0A9F03F154949C04CA1BFBE8D62BD3E6797E3C0D867AC3F"> : tensor<5x6x7xf32>
    %1 = stablehlo.constant dense<[[-2.18598247, 4.79178095, -4.87442112, 0.104973093, 1.62752092, 3.41967249, -2.48913503], [-0.661931038, -4.49794722, 5.82786179, 1.85921669, 0.984050512, 2.59858942, 4.04719067]]> : tensor<2x7xf32>
    return %0, %1 : tensor<5x6x7xf32>, tensor<2x7xf32>
  }
  func.func private @expected() -> tensor<5x6x7xf32> {
    %0 = stablehlo.constant dense<"0x22B6FEC05811C0C09F2CDA40CEBAAAC013F5913F6A397F3F144AD13F23E70BC009B1B53E42FB9BC0E4FC6ABF9B52D03F140A86C08CCCBBC0B6652540FB935CBF6E238ABE4593AEBF8A41D3BE2DA6E8BF0351543F391091BFBF7820C0C2E50540CFE736407A63B5C0624D2EC10465D4BF6E2605C00BDA2A40CD0A70C0937D94C0C2CD6E3FFF472C400A118DBF8BC7DDBF6A8F3240F6775F40712C8C3FE08054C0A77F1E3F590017401D7FD3BF4A25BFC0B6334940CF7F773F1772C23EFEA91DC02A306B4088CD87C0105409C036656FC097C74140072937C014BECAC0DC566BC0C14733C0546B77BF6A31883E4B4A66C08B599FBFF5703540BFE15FBFCF7C8D3F2AF3A440C673983F12D99840253F5C3F463F68BFB149CA3EF5FAA040BB7CA53FD9D92640F666AFBF6B930D40BFDDCDBFFF67BDBF984C29C0504F10401AE70A40784A46C0F7E6364013310D3F4DE12440C7373640BFB078BE57300FBF2E28D6C005196CC0CC51EDBE42EF30405B0A97BF1A911540D6411140F6A241C02F1177BF0BF530C0CB5CBB3F10BD3FC00E5012405F7FD33EEADA5C404CF6FABE5ACC9A3E801315BF507429BF2FEF8FC0FE198B3F34FCC73FBCEA7B3FAA95A73F752032BF8894993F25E584C0A6350D3F6420F2C0000A4240B4F2CE3F6879FE3E14AA65C0F5491FBFBF6B0FC0188E9D4019820240607E39401405184085B74BBE6EC08D4004F72C407C213CC03972073D0A58DAC0102886C0557004401BEF603F5F40A1BF4CC415C00B3285BF55B71FC0E7C56DC0F0487C40D3EB51BF22C1EEBF4A194D3F46EFE7401E5ADAC047E13FBE3AB5AEC0C0AD1940E3F2EF3E17B31D40CA5B1B4180C33FC068E92CC0F793673F335D3DC0C2FDD33FF31AF6BD442C28C0C7E0A73F98D01BC0A2586F3F6E8CDA408627BA3FEB4C96BE9888393F392B0B405C936CBFF770C9BE03707DC02F21313EF86B3E3F0B9EA84019128C4020C03540A3A84DC01F8C4040F39D603F3A811140C8D68240103034BF59D9C9C040181A3E0A8C7EBF36D8A8BF8889AB3FC19D35401B678FBF2AD2383F44CB2FBF2C533DBF86D3AE406F819BBFF3A5AF3F9709133D84D604408CE7D0BFEBE605C0D0BA493F7B03F83F26B66BC0F7EFAD3F7FA863C030539D3FF0A9F03F154949C04CA1BFBE8D62BD3E6797E3C0D867AC3F"> : tensor<5x6x7xf32>
    return %0 : tensor<5x6x7xf32>
  }
}

