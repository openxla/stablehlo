// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = stablehlo.constant dense<[[[0], [1]], [[2], [3]]]> : tensor<2x2x1xi32>
    %1:2 = call @inputs() : () -> (tensor<5x6x7xf32>, tensor<5x2x2x7xf32>)
    %2 = call @expected() : () -> tensor<5x6x7xf32>
    %3 = "stablehlo.scatter"(%1#0, %0, %1#1) ({
    ^bb0(%arg0: tensor<f32>, %arg1: tensor<f32>):
      %5 = stablehlo.minimum %arg0, %arg1 : tensor<f32>
      stablehlo.return %5 : tensor<f32>
    }) {scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [0, 3], inserted_window_dims = [1], scatter_dims_to_operand_dims = [1], index_vector_dim = 2>, unique_indices = true} : (tensor<5x6x7xf32>, tensor<2x2x1xi32>, tensor<5x2x2x7xf32>) -> tensor<5x6x7xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %2) : (tensor<5x6x7xf32>, tensor<5x6x7xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<5x6x7xf32>, tensor<5x2x2x7xf32>) {
    %0 = stablehlo.constant dense<"0xF24CD540416C59C0C88443BF63D40E3FA85BF2BF5D3C943F7982DE3FBF2542406F8A90C03ED5CD3C64871FBECE5A91BFB6F614BFF3F594BFA3991240879077C048FCA33FF99774BF758C1240B873E23F253366BE1E9F4C407FEDBC407041893FA1EAEABF138E6D400CDD0BC0AB00D1C0A648343F6E73B4C061203AC0C4D5A740CC4742C06D0871C0E2ADC3BE0476D6BFD8EDE23EBA1386C05152323FBEC371409A3CA23DC3D8A2C0A5A2673F87E34B400B82E03F3AB5DCBDE6BEBC3E3C60CD4066FBB3BF0860843F8748B4C0C81BBE400C431DBE94F34BC041079BC0362A6DC02F9096C0205A29C07A61F43FA36D0F400BAC8D3FA07C463F240594BE6570CA3FB1EA803E3BC72240E4601DC1F85DC7BF090D803E788FBB406F0897BEFC04BCBEA09093BF2043B2BFA52F9B3F83090DBF3537B73F1A3D943F19FA0CC186BF6A3EADD6D240E0A99840EF1B7840132E5F407E34C5C05A0EE2BEE2430E3FAF4EC840AA4B0D40AFFCDF3FCE556F4077738ABD2E1A12BF0AA25BBF405895C0713D56C029F8C6BE798FBDBF98DE5D401D3426C0821BE33F8674803F5ADB7B403045B1C06909A840721939C056D6283F82143BBFA19876BEC9088240F9ED3E3FCEECF7BFDFB7CB3F7371D63FF189A0BEB82E47BFF82CF3BFE5969EC0D7EABFBFE50E8A3F925C50C0FB90F03F3E0417C0DF92BB3F9E7A37BFE48E88C0C94A543FF62B35BFB26AB3BEA20A4840DA2069C0E3A376C0987905404002A4BFFD590CC0F076E43FDBE1E43D3ADA1E3F5E5A53BDE6BE244031D5C640894D3CBF6CA76EC0B6D711C0303D9240C20EBFBF0DFF9F3FBEEFCCBDDD3B0FC0864B3ABFE95EB5C09C84B6BFA67616C02826DF3F7901783F0BB23ABFAF1545C04FBE91C0FFEA90BFD62F843F9B38D2BFE3187F409DEE46409AF1F2BFE5A7B7BFAA7DC3BF943BB8C0324D4D40FCE7253FBE011641A20797405CAE1F407E634DC0DCB2AA3F77BDBDC0C52BDFBE815747BF82CF333F54550F3FD9DD5AC0C481DE40FC1F7FC0C018A240752CFDBF507DA13F184E99BEC11A88407F5F85C097376B404D723FBE16E174403AD8A43F8E38C93F34FBDFBFAAA086BFD33C8B4029C5AAC009A182C057D3613F7335FB3F13E1033F7519F7BF57F8A4BF391D0A3FC7C63AC0024847405F9C9CC009E30C3DFB0ACE3FE480743E"> : tensor<5x6x7xf32>
    %1 = stablehlo.constant dense<"0xD880D0BFEDF7B73ED49B00407500A4BF1BF84BBFE872704034C79940CA3BA53F213F4DBF345D47BF8194C73E5E2E0B3F0C95B3BF42F90540F26116400A26B3C0661942C0038FA340021D9EC04EF397BDF1FCFD3EF091B8BF4EFF8D3DBEC58E3F7BAC31C0D30CB9C01A04B2C0337F8EBED252AA3FA85269BF10271A3F33839C3F6446C8BFD47C80C0E860AC40E25C81409E2C84BD4C76E340DA1802C01DF963405439FE3E47C858BF3C2C61408230773FFF1A15BF62400BC0244B2AC00815E93F8E2DC03F8BFB0EC036D0A73F6646DCC0D73CDDBED700D7BFAAAAE5BFFEEF46C04D4622C01502A040B8FF04C0167D5F40DC9248BFA2D097C0DA01F73FCCC94040D55849C05D0B18BF787F8A405DD685C06E2D1EC0EAD78C3E46E325403E9FC2BFC336B8BE8DF3A3BEC914C2BDAEE782C0DDC403BF218C20C04C475FBE90E48D3F74800340AC3A803EC64E4DC03E215E4080AABB3F4A08823F54E243BEF1D971C0619527BF5CD9EF408DE0B3C0CF7609C0865C74BF34105140E554C03F2E907ABFCC33543F4EFA12C08E7FB240D1A3E6BC8B3187C00AB44B3F65EEFDBF790E393F1805A7C0577A15C09ADC49C0BE9C23C057FE07BDD63A3240E52CCDC07A53E3BFF3B03A3F95927DC006905FC0DA992440714B65C0519B9F3F5FAC17405DFB9FBF0006CE3E1B421D3EDFA27CC076951C4078E31BC031818AC04D35CCBEFF6DD93F4EC6B9C0B691E840ED773C402A3E863F1E98E23F42CC74C0FC8774BFA96A77400987AA3FC5F1BEC0DE51B0BE2127193F"> : tensor<5x2x2x7xf32>
    return %0, %1 : tensor<5x6x7xf32>, tensor<5x2x2x7xf32>
  }
  func.func private @expected() -> tensor<5x6x7xf32> {
    %0 = stablehlo.constant dense<"0xD880D0BF416C59C0C88443BF7500A4BFA85BF2BF5D3C943F7982DE3FCA3BA53F6F8A90C0345D47BF64871FBECE5A91BF0C95B3BFF3F594BFA39912400A26B3C0661942C0F99774BF021D9EC04EF397BD253366BEF091B8BF4EFF8D3D7041893F7BAC31C0D30CB9C01A04B2C0AB00D1C0A648343F6E73B4C061203AC0C4D5A740CC4742C06D0871C0E2ADC3BE0476D6BFD8EDE23EBA1386C05152323FBEC371409A3CA23DC3D8A2C0A5A2673FA85269BF10271A3F3AB5DCBD6446C8BFD47C80C066FBB3BF0860843F8748B4C0C81BBE40DA1802C094F34BC041079BC0362A6DC02F9096C0205A29C0FF1A15BF62400BC0244B2AC0A07C463F240594BE8BFB0EC0B1EA803E6646DCC0E4601DC1D700D7BFAAAAE5BFFEEF46C06F0897BEFC04BCBEA09093BF2043B2BFA52F9B3F83090DBF3537B73F1A3D943F19FA0CC186BF6A3EADD6D240E0A99840EF1B7840132E5F407E34C5C05A0EE2BEB8FF04C0167D5F40DC9248BFA2D097C0DA01F73F77738ABDD55849C00AA25BBF405895C05DD685C06E2D1EC0798FBDBF46E325401D3426C0C336B8BE8DF3A3BEC914C2BD3045B1C0DDC403BF721939C04C475FBE82143BBFA19876BEAC3A803EC64E4DC0CEECF7BFDFB7CB3F7371D63FF189A0BEB82E47BFF82CF3BFE5969EC0D7EABFBFE50E8A3F925C50C0FB90F03F3E0417C0DF92BB3F9E7A37BFE48E88C0C94A543FF62B35BFB26AB3BEF1D971C0DA2069C0E3A376C08DE0B3C0CF7609C0FD590CC0F076E43FDBE1E43D2E907ABF5E5A53BD4EFA12C08E7FB240894D3CBF8B3187C0B6D711C065EEFDBFC20EBFBF1805A7C0577A15C09ADC49C0BE9C23C0E95EB5C09C84B6BFE52CCDC07A53E3BF7901783F0BB23ABFAF1545C04FBE91C0FFEA90BFD62F843F9B38D2BFE3187F409DEE46409AF1F2BFE5A7B7BFAA7DC3BF943BB8C0324D4D40FCE7253F95927DC006905FC05CAE1F40714B65C0519B9F3F77BDBDC05DFB9FBF815747BF1B421D3EDFA27CC0D9DD5AC078E31BC031818AC04D35CCBE752CFDBF4EC6B9C0184E99BEED773C407F5F85C01E98E23F42CC74C0FC8774BF3AD8A43F0987AA3FC5F1BEC0AAA086BF2127193F29C5AAC009A182C057D3613F7335FB3F13E1033F7519F7BF57F8A4BF391D0A3FC7C63AC0024847405F9C9CC009E30C3DFB0ACE3FE480743E"> : tensor<5x6x7xf32>
    return %0 : tensor<5x6x7xf32>
  }
}

