// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = stablehlo.constant dense<0> : tensor<1xi32>
    %1:2 = call @inputs() : () -> (tensor<1x125xf32>, tensor<1xf32>)
    %2 = call @expected() : () -> tensor<1x125xf32>
    %3 = "stablehlo.scatter"(%1#0, %0, %1#1) ({
    ^bb0(%arg0: tensor<f32>, %arg1: tensor<f32>):
      %5 = stablehlo.multiply %arg0, %arg1 : tensor<f32>
      stablehlo.return %5 : tensor<f32>
    }) {scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [0], inserted_window_dims = [1], scatter_dims_to_operand_dims = [1]>, unique_indices = true} : (tensor<1x125xf32>, tensor<1xi32>, tensor<1xf32>) -> tensor<1x125xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %2) : (tensor<1x125xf32>, tensor<1x125xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<1x125xf32>, tensor<1xf32>) {
    %0 = stablehlo.constant dense<"0x83B114C022FE3640197FF8BF19502940ED8D32402771CBBE199573C0EB2F8CBCD2DB3DC067D5E93CFC6C6BBEE0A89D3EA1F4EA40D7103E40C7F7A13F342D93BFC076064038E0B14013D797405E92D8BFE77698406EAA1ABE95DF393F3ADC5B3E3AF13240232D3140CE5ED33FCAB2BE3E1FA0503FB2D9013FAB0B4E3ED1C1D5C02A2B88BFA2CEDEC00BFB26C03E500E4018B4674076DE8B3FB4CFA43E0B40BDC0BDB08B3F9A0B35C094632A3F16F5684022F7B5BE253C06C07B482DBFD57D4FC0427D2B3E38CFA0BE2267DCBF6FEF8A40C7E38E3E9FA4064016A323C06995C53EA911AEC06873E2409F71E23ECAFBF4BE86BEF93F55735BC09398133F16ACAABF5DFC803E99326840667BBA3F503783C0CACB3440F7024DBEC2349EBF35163FBF7472D3BE0AF8AC406FF0A23F73065EC06DF6B43FF46A9CC066D28CC083E05C409C56D9BE9C3FD3C0617846C0BE530C40964C1EC0E514A4C08D9076402D11A03EB240AB3F68A00240A55E1440948CB5C0FC3029BF807D83C052AB9CBF44A2C33FE75143409DC93EC0E003C540D2DD883F09492BC05A9CD740172F813FB0CAB6C08CB56CC01BF67D3F559D3F3FB5CC4A3F65710DBFEB3FDCBD694525C0C2DF71BF0B7EA7BF5DB69940CDB4723EB3C7D0BF596F81BFA88A05C053BBBC3F7BC688C056308ABF4B366E40742E0C406D5713C070CD43C0"> : tensor<1x125xf32>
    %1 = stablehlo.constant dense<2.53758121> : tensor<1xf32>
    return %0, %1 : tensor<1x125xf32>, tensor<1xf32>
  }
  func.func private @expected() -> tensor<1x125xf32> {
    %0 = stablehlo.constant dense<"0x2AA9BCC022FE3640197FF8BF19502940ED8D32402771CBBE199573C0EB2F8CBCD2DB3DC067D5E93CFC6C6BBEE0A89D3EA1F4EA40D7103E40C7F7A13F342D93BFC076064038E0B14013D797405E92D8BFE77698406EAA1ABE95DF393F3ADC5B3E3AF13240232D3140CE5ED33FCAB2BE3E1FA0503FB2D9013FAB0B4E3ED1C1D5C02A2B88BFA2CEDEC00BFB26C03E500E4018B4674076DE8B3FB4CFA43E0B40BDC0BDB08B3F9A0B35C094632A3F16F5684022F7B5BE253C06C07B482DBFD57D4FC0427D2B3E38CFA0BE2267DCBF6FEF8A40C7E38E3E9FA4064016A323C06995C53EA911AEC06873E2409F71E23ECAFBF4BE86BEF93F55735BC09398133F16ACAABF5DFC803E99326840667BBA3F503783C0CACB3440F7024DBEC2349EBF35163FBF7472D3BE0AF8AC406FF0A23F73065EC06DF6B43FF46A9CC066D28CC083E05C409C56D9BE9C3FD3C0617846C0BE530C40964C1EC0E514A4C08D9076402D11A03EB240AB3F68A00240A55E1440948CB5C0FC3029BF807D83C052AB9CBF44A2C33FE75143409DC93EC0E003C540D2DD883F09492BC05A9CD740172F813FB0CAB6C08CB56CC01BF67D3F559D3F3FB5CC4A3F65710DBFEB3FDCBD694525C0C2DF71BF0B7EA7BF5DB69940CDB4723EB3C7D0BF596F81BFA88A05C053BBBC3F7BC688C056308ABF4B366E40742E0C406D5713C070CD43C0"> : tensor<1x125xf32>
    return %0 : tensor<1x125xf32>
  }
}

