// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = stablehlo.constant dense<32> : tensor<1xi32>
    %1:2 = call @inputs() : () -> (tensor<1x50x3xf32>, tensor<1x3xf32>)
    %2 = call @expected() : () -> tensor<1x50x3xf32>
    %3 = "stablehlo.scatter"(%1#0, %0, %1#1) ({
    ^bb0(%arg0: tensor<f32>, %arg1: tensor<f32>):
      stablehlo.return %arg1 : tensor<f32>
    }) {scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [0, 1], inserted_window_dims = [1], scatter_dims_to_operand_dims = [1]>, unique_indices = true} : (tensor<1x50x3xf32>, tensor<1xi32>, tensor<1x3xf32>) -> tensor<1x50x3xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %2) : (tensor<1x50x3xf32>, tensor<1x50x3xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<1x50x3xf32>, tensor<1x3xf32>) {
    %0 = stablehlo.constant dense<"0x6B1989407E73C83F7BB620C0CE18FAC04F4F943E68B7EF3F1C592540CC3187C03B756CC0A33E1641F4C658C07CC18F408878643FA293B9BF6A725CBF5ED696BF3B94AF40A82B783F4EDDF1BF15075A3F9EAE5E40C94647C0A1AE48401F0758BF94EA4A3E726877C07D148E4024A7DDBE37AC11C0BF974D40A63215BFB9E6A0C0EFC76C3F27557840C4877EC0267D25408AFE8EC018080B40F24FD0C02E5F713F77B5A7C0EE26C33FA345D43FAC3D4040BB1559C019BC07C1151B01C065892EC0B7F76AC03BF3AFBF284420BF14AF5940E70780BF8E4CF4BF02320B401EE528C06DE72ABF7E983940D50D9C3FA90E283FEF64BD3FDEF590C072A0BE3F495A473FF4B8EC4031B89D4082AF663ED13EA0C008562E40861D973F54C40EC0E39BA540831B20C0A58B5C40ED2A05C0AE9E8FBF2A9E3F3FC9B48BBEC547EEBEB8EE3AC0EB022B3F771FDA405BDF93409A3784BF3AA046BE8F9EBBBFA5F9843E08D960406BFB8EBF38D195400EB51740E0463640163ED33E9DAD3B4012C8474029DB11C017B8AC3F6C96193F96D213BF97A1FE3F437390C05973B440AF9C6F3F8C0B76C0CDC634405046ADC09929A1C0F2EB653FB6F6104137B63BC0589C6440385DA0C01E6950BE39C1853F1CAAC8BFC9A9433FC0A80EBE271968BF9701C63F36168FC0FBFAA840140FA03F2BD63B40165147C058548D404CE7A5C0C96096BF7202A63E9DC77A3F64CC1D3FA6100EC0EB0F4B3F92060440E00D1D409FD761C001CABDBF01433B40FB69233F261927406F1B5D3F1AA8A6BF450DC23F6B5B96C08B08FEBF642E72BF974077C09E9123C08C661CC0A57A9CBFC3EFCE40"> : tensor<1x50x3xf32>
    %1 = stablehlo.constant dense<[[-3.75949955, -0.420995116, 1.385759]]> : tensor<1x3xf32>
    return %0, %1 : tensor<1x50x3xf32>, tensor<1x3xf32>
  }
  func.func private @expected() -> tensor<1x50x3xf32> {
    %0 = stablehlo.constant dense<"0x6B1989407E73C83F7BB620C0CE18FAC04F4F943E68B7EF3F1C592540CC3187C03B756CC0A33E1641F4C658C07CC18F408878643FA293B9BF6A725CBF5ED696BF3B94AF40A82B783F4EDDF1BF15075A3F9EAE5E40C94647C0A1AE48401F0758BF94EA4A3E726877C07D148E4024A7DDBE37AC11C0BF974D40A63215BFB9E6A0C0EFC76C3F27557840C4877EC0267D25408AFE8EC018080B40F24FD0C02E5F713F77B5A7C0EE26C33FA345D43FAC3D4040BB1559C019BC07C1151B01C065892EC0B7F76AC03BF3AFBF284420BF14AF5940E70780BF8E4CF4BF02320B401EE528C06DE72ABF7E983940D50D9C3FA90E283FEF64BD3FDEF590C072A0BE3F495A473FF4B8EC4031B89D4082AF663ED13EA0C008562E40861D973F54C40EC0E39BA540831B20C0A58B5C40ED2A05C0AE9E8FBF2A9E3F3FC9B48BBEC547EEBEB8EE3AC0EB022B3F771FDA405BDF93409A3784BF3AA046BE8F9EBBBFA5F9843E08D960406BFB8EBF38D195400EB51740E0463640163ED33E9DAD3B4012C8474029DB11C0A49B70C0AC8CD7BE8D60B13F97A1FE3F437390C05973B440AF9C6F3F8C0B76C0CDC634405046ADC09929A1C0F2EB653FB6F6104137B63BC0589C6440385DA0C01E6950BE39C1853F1CAAC8BFC9A9433FC0A80EBE271968BF9701C63F36168FC0FBFAA840140FA03F2BD63B40165147C058548D404CE7A5C0C96096BF7202A63E9DC77A3F64CC1D3FA6100EC0EB0F4B3F92060440E00D1D409FD761C001CABDBF01433B40FB69233F261927406F1B5D3F1AA8A6BF450DC23F6B5B96C08B08FEBF642E72BF974077C09E9123C08C661CC0A57A9CBFC3EFCE40"> : tensor<1x50x3xf32>
    return %0 : tensor<1x50x3xf32>
  }
}

