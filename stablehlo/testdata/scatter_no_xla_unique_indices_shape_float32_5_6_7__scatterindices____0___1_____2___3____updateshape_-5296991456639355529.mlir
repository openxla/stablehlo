// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = stablehlo.constant dense<[[[0], [1]], [[2], [3]]]> : tensor<2x2x1xi32>
    %1:2 = call @inputs() : () -> (tensor<5x6x7xf32>, tensor<5x2x2x7xf32>)
    %2 = call @expected() : () -> tensor<5x6x7xf32>
    %3 = "stablehlo.scatter"(%1#0, %0, %1#1) ({
    ^bb0(%arg0: tensor<f32>, %arg1: tensor<f32>):
      stablehlo.return %arg1 : tensor<f32>
    }) {scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [0, 3], inserted_window_dims = [1], scatter_dims_to_operand_dims = [1], index_vector_dim = 2>, unique_indices = true} : (tensor<5x6x7xf32>, tensor<2x2x1xi32>, tensor<5x2x2x7xf32>) -> tensor<5x6x7xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %2) : (tensor<5x6x7xf32>, tensor<5x6x7xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<5x6x7xf32>, tensor<5x2x2x7xf32>) {
    %0 = stablehlo.constant dense<"0xD4FE303E090CA8BFBD3A80C0D24742C0D5CBFB3E47592BC0F897283EDF7ABFC074D3893EC430F5BEDC74903EEB1E77405CA5393FDDFB7C3FEA4E083FADBE86C05AB785BFFC0F02BE9AA76AC0E2093240DCE089405D4B5D4016709A403909B4BFA9AC9640D1C3D9BF83796BBF9D9AEDBF0486B0BD55074FBC23A6554056F01CBF490BA8BE9B7ED33FCCE077BE4D49E33FC6D3513F52214D406582ACC0EBE683BFAF955BC07A370D4068BA153FED011A40580B8CC0D6B04DBFA039EDBFA2312FC082F821C059C4064063C50FC0C00416409748EDC092B7B03F34800640C1436C40C74682BD0655F3C038A14BC0DAD0153F4610353F73EF0340C7D77840456B1E3F9D12BD404C09AA3F6C2CE3BF124447C00CA2C3BD3CD09BC0D1F6DF3F57321ABFFD68964035C0DDBE5D5499C0315AE63F7212834026FBDA3F0A850540AF1A40C0BDD1B240D41C8B3FAD500AC02A578540066D904003CF78C0C6CAF73FFACAA0C09150853FBC04363F1E76B13FD68B603F879D8D3FC18D36BF35A622C0641119C17617C1BFD46EF8BE7F930EC11159E33F13FC5E407E81BEBE4D84B4BF69B1494188655E3C80618EBF242AB6BE391F544068CEE7401506973E4251CBBE0AD7753F3D3B4F3F27C2A3C0779189407B6B953F0ECCD9BF37BBB3C02D857A3F9FC9173F4D8FA4C03AFAAB3EB2B9C23E86DC36BFC7B5813F76D42AC0E57951C0755BAC3F1F228ABE7B8981C07033833E9BBEBD4052D86E406361503FD196BA3EDDF3953F2DF6724016F6DC4044FD08C006B14E40CDE6B13F323A2040F8FDD53F2F3DE73D096532BDFCCD0E40525C85403C055B40CA758BBEEF810BC063C48BC09E6A7EC0319D8840136406BF4393CC408A5F1E40D756EFBF96E8CBBFBC0E953E3FF80BBFFC910E40B02E143F7D5D9640D299CFBF387D94C0C9C5953F9A0FC63F7340C33D6BEB07C073E5A43EC617F1BF9E6E8F40317C214049334A40EF8D37C0D5B1D1C0E092044000382540D69FAA3E60FA583F3920C840C6BA994086C51C409D8A1AC038462D40D1CEE83DAA7CB33FEB9E8B40C5D8A53F0A6F46C04CD3DD3F91C664C031C0244032DC91404D48723EABB982408F5128C0B7947A3E972E07406578D3C0C46832BFA945C83FFBD667C017FB82BF26C0B6BF5BB2DC3F44D43040E198CD3F000EB6BF34525E40"> : tensor<5x6x7xf32>
    %1 = stablehlo.constant dense<"0xEFF724BF5C75F3BFEC951CC013173F40791B3BC07DBFD0C09C9F89407767A53FF414274053843D3F7E0E81C046B89EC0B80E953FF5512040AF3DDFBE435DA440272AB6BF09C9E83F8FEB40C0AA8AF63F5479DCBF35F925BF96ACAA3FD8AA14C0213EC5BD3632C53FD535ADC08D058D40F1A35EC0E8247EC0FD23A34060F74040D0ED0FC0AB599340FCC8293F40CB3F40C0207240161347BC9B32773FD5CE5040EE8872C0966597BF433D723CCA92DD3F002628BF6DC958C01ACF9FC0E66114C06EECD53EB96CE83F830688C03277EABF69B8FBBF54A121C0C459954068AC1D3FD35577C08F10843F2E375E3F54EC2DC0C7020940AC9BC83FFF4B083F7DB7B3BFAF6FE3BF36D465BF3C5F83C09E7400BF9F32B1BE08A892403AFCF7BFD1EBD340BFA03C402549A43BAF40713FB89E10C0C13819405C1055401779F63F71263DC059DF10406D1BAA3E7A48FD3CF67DE63F8549D4BFD903B84033B589BE64926BBE8AB7284019DB57C0658E40C051495C40DBB995BFD3261DC0F1547240CA603CC037F601C02D90A440CDC9B13F7CF08840A6F8FFBF239B2540870D6ABED1CD57C07004B8BDF21317C0745C8CC042E29C4055583740EE6B833DC628ECC00EA539BF5F9D9CC011E320BE077396C0E58A0E40912D63C08BE28BC00206D63FE122A4BFC5A28DC0AD2567401EDA82BF27A34840718282BEB686C63F135F6640E8BF4D3F7DF0DA407FD0E33DF60B9FC0651ED0BF980689BF516A0DC0C66C6D3E51EC803FB1755F3FC7C5F4BF966FDCBE610A92C0"> : tensor<5x2x2x7xf32>
    return %0, %1 : tensor<5x6x7xf32>, tensor<5x2x2x7xf32>
  }
  func.func private @expected() -> tensor<5x6x7xf32> {
    %0 = stablehlo.constant dense<"0xEFF724BF5C75F3BFEC951CC013173F40791B3BC07DBFD0C09C9F89407767A53FF414274053843D3F7E0E81C046B89EC0B80E953FF5512040AF3DDFBE435DA440272AB6BF09C9E83F8FEB40C0AA8AF63F5479DCBF35F925BF96ACAA3FD8AA14C0213EC5BD3632C53FD535ADC08D058D400486B0BD55074FBC23A6554056F01CBF490BA8BE9B7ED33FCCE077BE4D49E33FC6D3513F52214D406582ACC0EBE683BFAF955BC07A370D40F1A35EC0E8247EC0FD23A34060F74040D0ED0FC0AB599340FCC8293F40CB3F40C0207240161347BC9B32773FD5CE5040EE8872C0966597BF433D723CCA92DD3F002628BF6DC958C01ACF9FC0E66114C06EECD53EB96CE83F830688C03277EABF69B8FBBF54A121C0C459954068AC1D3FD1F6DF3F57321ABFFD68964035C0DDBE5D5499C0315AE63F7212834026FBDA3F0A850540AF1A40C0BDD1B240D41C8B3FAD500AC02A578540D35577C08F10843F2E375E3F54EC2DC0C7020940AC9BC83FFF4B083F7DB7B3BFAF6FE3BF36D465BF3C5F83C09E7400BF9F32B1BE08A892403AFCF7BFD1EBD340BFA03C402549A43BAF40713FB89E10C0C13819405C1055401779F63F71263DC059DF10406D1BAA3E7A48FD3CF67DE63F3D3B4F3F27C2A3C0779189407B6B953F0ECCD9BF37BBB3C02D857A3F9FC9173F4D8FA4C03AFAAB3EB2B9C23E86DC36BFC7B5813F76D42AC08549D4BFD903B84033B589BE64926BBE8AB7284019DB57C0658E40C051495C40DBB995BFD3261DC0F1547240CA603CC037F601C02D90A440CDC9B13F7CF08840A6F8FFBF239B2540870D6ABED1CD57C07004B8BDF21317C0745C8CC042E29C4055583740EE6B833DC628ECC00EA539BF4393CC408A5F1E40D756EFBF96E8CBBFBC0E953E3FF80BBFFC910E40B02E143F7D5D9640D299CFBF387D94C0C9C5953F9A0FC63F7340C33D5F9D9CC011E320BE077396C0E58A0E40912D63C08BE28BC00206D63FE122A4BFC5A28DC0AD2567401EDA82BF27A34840718282BEB686C63F135F6640E8BF4D3F7DF0DA407FD0E33DF60B9FC0651ED0BF980689BF516A0DC0C66C6D3E51EC803FB1755F3FC7C5F4BF966FDCBE610A92C08F5128C0B7947A3E972E07406578D3C0C46832BFA945C83FFBD667C017FB82BF26C0B6BF5BB2DC3F44D43040E198CD3F000EB6BF34525E40"> : tensor<5x6x7xf32>
    return %0 : tensor<5x6x7xf32>
  }
}

