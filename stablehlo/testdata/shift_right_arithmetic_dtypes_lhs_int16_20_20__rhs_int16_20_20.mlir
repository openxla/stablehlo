// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.shift_right_arithmetic %0#0, %0#1 : tensor<20x20xi16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xi16>, tensor<20x20xi16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xi16>, tensor<20x20xi16>) {
    %0 = stablehlo.constant dense<"0x0300FFFF0000FBFF0400FBFF0000010005000000010001000000FEFFFDFF0000FEFF03000000FEFF02000200FEFF000002000000FEFFFFFFFDFFFFFFFEFFFEFF0000FAFFFFFF000002000000FEFFFDFFFFFF000002000200FEFF0000FEFF0100FBFF00000A000100FCFFFDFF00000000FFFF0000FFFF0100FFFF0000F8FFFEFF0000FAFF0200FAFF0100FEFF010001000000FEFFFFFF000000000100FFFF00000000FFFF0000FFFF00000200000002000000FFFF0000FFFF0000FCFFFCFF0000FDFF0100FBFF010000000000020000000200FFFFFFFFFCFF0000FDFFFFFF000001000000FDFFFEFF030000000000FAFF0400FDFF0300FFFFFFFF03000000FCFF01000400020001000500FDFFFEFFFEFFFCFFFDFF030000000100FDFFFCFF030000000000FEFF0000FFFF00000100FEFF00000000FEFFFDFFFBFFFFFFFFFF0200FFFF0300000000000000FEFFFBFF000003000000FFFF00000000FFFFFCFF04000100FFFFFEFFFFFF000002000200040005000000FBFFFEFFFFFF0100FCFF02000200FFFF0000FFFFFDFF00000100FFFFFDFF000006000000FFFF02000200FEFF0000FEFF040000000400060000000000FFFF02000000FDFF00000200FEFF0000FFFF00000000F9FF0200FDFFFEFF0200FEFF0100FDFF00000300FFFFFEFFFEFFFEFF0000040002000800030004000000FFFF0500FEFFFFFF0000FFFFFFFF0800000000000500020000000100FEFF00000900FEFFFEFF0100FEFF00000000000003000200000000000100FDFFFFFF0400020004000100FFFF000002000300010006000600FBFF00000000FCFFFFFF010001000000FBFF00000600FFFF0800FFFFFCFFFFFF0200FEFF0400FBFFFFFFFFFFFEFFFCFF01000000FFFF05000000020003000300FEFF010003000000FFFF00000400FFFF00000100FFFF0400FDFF0100F9FFFCFF030000000000020002000200030004000200FFFF05000000FEFFFFFFFEFF0000FDFF0000000002000000FAFFFDFFFFFF0100020000000000FCFFFEFF00000100FCFF0000FFFF000000000000FFFFFFFFFEFF03000000FEFF0000FEFFFFFFFCFF0000FFFF0000FCFFFFFF01000300FCFF00000400FEFF0000FFFFFFFF"> : tensor<20x20xi16>
    %1 = stablehlo.constant dense<"0x000006000000FEFFFEFFFFFF0100FDFFFCFFFEFF02000200FFFF000000000200040002000700FEFF03000000FFFFFBFF030000000000FFFF02000000010001000100FEFF0200FEFF0100FDFF0000020005000300FDFFFDFFFFFF040001000000000006000000FCFF020000000000020007000200FDFF00000000FEFF0500FAFFFFFFFDFF0200FFFF00000000000001000000FFFF0000FFFF0000FDFFFFFF000000000200FFFF02000100FFFFFBFF030001000000FFFFFEFF030001000200FFFF040000000300000002000300FCFF0500010000000100FCFF0000060000000000FAFF00000300FAFF00000100FFFF04000000FDFF0000050001000000FEFF010001000000FAFFFDFFFBFFFBFF0000FEFFFEFF0600FFFF02000000FEFFFFFFFDFFFFFF030002000000FBFF0000FCFF0200000000000000FCFFFEFF01000100FDFF00000100FCFF00000000FFFF000001000100FDFFFDFF02000000FDFF0300060000000500FBFF01000000FFFF0000020000000300FFFF00000000FFFFFFFFFFFFFFFF0000FDFF0600000000000600FEFF0000FEFF0000FFFF000002000000FEFFFEFFFEFF00000000FFFFFFFFF7FF0100FFFFFEFFFEFFFCFF000000000100FFFF0300FCFF0300FDFF0100FEFF0000FFFF0200040000000000000003000700FFFFFFFFFEFF0000000002000200FCFFFFFF0000FCFF040000000100FDFF05000000030002000100000003000300000005000100040001000400FFFFFFFF010005000400FFFF0000000000000000010000000200000000000200FDFF0200FFFF00000200040003000100000000000400F9FF02000000010001000100FEFF0400FFFF000002000200FFFFFAFFFEFFFCFF00000100FDFFFDFF00000100FCFFFEFF0200FCFFFEFF01000500030000000100FEFFFDFF0100000004000100FBFFFBFF04000000FEFFFFFFFCFF0100FEFFFDFFFEFF06000000FBFF00000300020000000100FFFF0000FEFF0100060000000000000001000000000001000100040000000000FEFF06000500FDFF00000400FDFF05000000FFFFFDFF0300FDFFFEFF00000000FEFF020000000000FFFF0400000005000000FDFF030007000100000001000100"> : tensor<20x20xi16>
    return %0, %1 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> tensor<20x20xi16> {
    %0 = stablehlo.constant dense<"0x0300FFFF0000FFFF0000FFFF0000000000000000000000000000FEFFFDFF0000FFFF00000000FFFF00000200FFFF000000000000FEFFFFFFFFFFFFFFFFFFFFFF0000FFFFFFFF000001000000FEFFFFFFFFFF000000000000FFFF0000FFFF0100FBFF00000A000000FFFFFDFF00000000FFFF0000FFFF0100FFFF0000FFFFFFFF0000FFFF0000FFFF0100FEFF010000000000FFFFFFFF000000000000FFFF00000000FFFF0000FFFF00000000000000000000FFFF0000FFFF0000FEFFFFFF0000FFFF0100FFFF010000000000000000000100FFFFFFFFFFFF0000FFFFFFFF000000000000FFFFFFFF030000000000FFFF0400FFFF0300FFFFFFFF03000000FEFF00000400000000000000FFFFFEFFFFFFFFFFFFFF000000000100FFFFFFFF000000000000FFFF0000FFFF00000000FFFF00000000FEFFFFFFFFFFFFFFFFFF0000FFFF0100000000000000FFFFFBFF000001000000FFFF00000000FFFFFFFF00000100FFFFFFFFFFFF000000000200010005000000FFFFFEFFFFFF0000FFFF00000000FFFF0000FFFFFDFF00000000FFFFFDFF000006000000FFFF00000200FFFF0000FFFF040000000000000000000000FFFF00000000FFFF00000200FFFF0000FFFF00000000FFFF0100FFFFFEFF0000FFFF0000FDFF00000300FFFFFFFFFFFFFFFF0000040002000200000000000000FFFF0000FFFFFFFF0000FFFFFFFF0800000000000200020000000000FEFF00000400FFFFFFFF0000FFFF00000000000000000000000000000100FDFFFFFF0400000004000100FFFF000000000000010001000000FFFF00000000FCFFFFFF000000000000FDFF00000300FFFF0000FFFFFCFFFFFF0000FFFF0000FFFFFFFFFFFFFFFFFFFF00000000FFFF00000000000000000000FFFF000000000000FFFF00000000FFFF00000000FFFF0000FFFF0000F9FFFFFF000000000000000000000000000004000000FFFF00000000FEFFFFFFFFFF0000FFFF0000000002000000FAFFFEFFFFFF0100010000000000FCFFFEFF00000000FFFF0000FFFF000000000000FFFFFFFFFFFF00000000FFFF0000FEFFFFFFFFFF0000FFFF0000FFFFFFFF00000300FFFF00000000FFFF0000FFFFFFFF"> : tensor<20x20xi16>
    return %0 : tensor<20x20xi16>
  }
}
