// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xi8>, tensor<20x20xi8>)
    %1 = call @expected() : () -> tensor<20x20xi8>
    %2 = stablehlo.shift_right_logical %0#0, %0#1 : tensor<20x20xi8>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xi8>, tensor<20x20xi8>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xi8>, tensor<20x20xi8>) {
    %0 = stablehlo.constant dense<"0x08FE00020000FF02010000FC0001040002FBFD04000002FE0108FDFDFF04FE00FFFFFE0003FFFE010204FE000100000001FA0303050000FEFCFE00FF01FFFF00FDFF02FE02FD0001010003000001000004FEFF03020601FB0000FEFDFFFF0002FC03FF0002FA000300FF000300000002FEFC01FB000400000102040001FB02FBFDFCFBFF02FF03050401000000010000FC00FC01030201010000FCFF000000FE0000FFFE01FD03FFFB0205FEFDFEFC0000FA000302FF00FDFF020000F8FF00030000FF0100070000000004FFFF01FF040101FB050004FE05FDFD02FAFE0001FB00FFFF04FF050001FDFF00FD01FD0502FCFD00FF03000402FB000003FF0000FF000000020200000002000600FF0002FD00FF03FE0001030003FFFDFFF905FE0004FF02FFFE0200FD0500FFFDFC0104FFFD00FCFDFF00FE0400020100FCFFFD000000000200F7FEFC010402FC00FC02FCFCFE01FFFFFD00000200FE00FE07020000000300FF000104FB0100FC01000402FFFE0000FE000102FEFF02020102FFFF07000004FFFA00FC000002FD000101FE"> : tensor<20x20xi8>
    %1 = stablehlo.constant dense<"0xFEFFFFFF000004FC0303FDFBFC000001FF000104FFFAFF0001FA010000FA000000FC020200000701FE000102FA01FB00FF020503FE020001FCFD0003FBFCFF00FCFEFE0000FFFEFEFB01FCFEFE0000FE0000000002000202030301FE02FF01FC00FB00FFFDFD01FC00FB0000020000FFFFFD0003FDFEFF0001FE00000000000203F9FDFF000002F800FF01000002010500FD030702FF00FE00FD000001010100020000FE0102FE0500010300FEFC00FEFD00030200FE03FC0104FC000002FF0100020300FFFF0203010000FF040101FC00FE02020005FD000001FD03FF03FE0600FA000804FF02FEFCFF00FF03FEFE0100FDFF040100000204000205F700030002FCFF03000000FEFFFE0501FF00010400FF04040004FF00020200FE03000000FF00FD03000101FD02FEFFFEFDFD0100000200000401010002FE0002FD02000400000103FDFCFCFE03FE0000FEFF00F904FAFF0400FEFF0100FE0006000001000402FDFF00FA0002F9FD00FEFEFFFE000204FEFC00010500000001050104FB0002FB0700FCFF00FF0000010100FEFE01"> : tensor<20x20xi8>
    return %0, %1 : tensor<20x20xi8>, tensor<20x20xi8>
  }
  func.func private @expected() -> tensor<20x20xi8> {
    %0 = stablehlo.constant dense<"0x0000000000000F00000000000001040000FB7E00000000FE00007EFDFF00FE00FF003F0003FF010000047F0000000000003E00000000007F0000001F00000000000000FE02000000000000000001000004FEFF030006003E00007F003F000000FC00FF000000000000000003000000000000011F000000000000040001FB023E1F00000002FF00000400000000000000FC001F00000001000000FCFF000000FE0000FF00003F0007FB0100FE0000FC0000FA0000020000007F000000F83F000100001F0100000000000004000F007F0001003E0100000005FD7E001F000000030000FF000F0000000000000000000001FC00000F010004000F000000000000FF0000000002000000000000000000010F0000000F00000000003FFD001F05FE0000FF001FFE01000001000000000002FFFD00FCFD0F007F0400000100003FFD000000000000000000000002FC000002000F00000FFF0000000200FE00FE07010000000000FF00010100000000000000023F0F0000FE000002FEFF0100000000FF01000004000000000000017E0000007F"> : tensor<20x20xi8>
    return %0 : tensor<20x20xi8>
  }
}
