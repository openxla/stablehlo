// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xui8>, tensor<20x20xui8>)
    %1 = call @expected() : () -> tensor<20x20xui8>
    %2 = stablehlo.shift_right_logical %0#0, %0#1 : tensor<20x20xui8>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xui8>, tensor<20x20xui8>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xui8>, tensor<20x20xui8>) {
    %0 = stablehlo.constant dense<"0x02000401000000030404000300010102010004000004000503020106030304060301050605010603020401000100060101010201020003000005010202030002010202000400000404010402000201030305010302030104030100010600010401020501020600050100010003070301000301030200000301010201000003000301030003040101000002000202030203030300020303000000000206020000000002010102010200000703010004020003040700030002000401010204010302020002010006010100060401020001020006040000010301000201000105010000010001000001000201010404000401020001000204020000000000030301010300010000020000030303010104010001040203040402020505020300030303010100040105010101010002000205040600050001010000010000010201040100000100000300060401000303000201030301020400030000010100020204020303040002010201020004010002050301000103030001010002030200010303010300010002030303000001040200"> : tensor<20x20xui8>
    %1 = stablehlo.constant dense<"0x020301000001020000010102020502010202010301000402000404030007020002000102010103000200030003020201010204030004020102030006000307010101050404000500030308030101000401000206070200000301000102080001000502000108040100000201010402050703040401030702020101020101000100000501020001000302040105050001010103020001000202030005010002050203010207030301020100040200040100060300010501010A0303030002060200020002010001000104020200040101000404030101010208000301030405050003020301010301010104000005010001000101000507020103010005020000010100010202040204020403040005040101020300000303010104000102030202030501030101000304010302010201010101010308000300010208010005000201020002020401010102010101050102010301030405060103010300010203020000020100000001000401040601020000020201020104020103020301070501060201000200010104050000010103"> : tensor<20x20xui8>
    return %0, %1 : tensor<20x20xui8>, tensor<20x20xui8>
  }
  func.func private @expected() -> tensor<20x20xui8> {
    %0 = stablehlo.constant dense<"0x00000201000000030402000000000001000002000004000103000000030001060001020102000003000400000000010000000000020000000000010002000001000100000000000400000000000101000105000000000104000000000100010201000101010000020100000001000000000000000100000000000100000003000301000000040001000000000000030101010000020103000000000003020000000001000000000100000700000000010000000700000001000000000201000002000000000003010000010101000000020000000000000000000000000000000000000000000000000100010400000400020000000000000000000000000301000100000000000000000000000100000000010003040000010200020100000000000000000002010000000000000002020300020000010000000000000200040000000100000000030200000101000100010000000000000000000000010000000303010002010200020002000001010301000001000000000000000000000001000000010002010100000001020100"> : tensor<20x20xui8>
    return %0 : tensor<20x20xui8>
  }
}
