// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.sign %0 : tensor<20x20xf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xf16>, tensor<20x20xf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xf16> {
    %0 = stablehlo.constant dense<"0x2144CE343E46A0C23544103A343D3B4621B875360D3F02B71D3884C0FA410943974552BC3A449EB21BB7C04409AE2E410746CF35D74075C1D93A5B3C5C45BA3E224318BE5D2E7B40CB40FB40C1C4B3412F4431433BBF55C47F3CD2C20CBF11444EC08F3E454073350FBB414226C43BBB2641D2C56236903EADC0ADC36DC224BD053D45C5CA44A6BF3740594479C2C134883FC342A943693BD244DB44E2C1233CB8C3D6B87C4456C3D93C52C524433CC4F8B52FC5813F02C620B88343F439493CD8C123400C42E9C0CF447B358AC454C111C4C83E593FC73CAB35C83614C5FCB9CE3D78390BC2CFBE2843583F613F92BAA8BEAABCD943474391A6CBBC0E44714297B98EBD50C1C5BC2342E63B8AC5CE20453BDCBF7BC483B8603C1A42ABC079C362B417BE32C5A3BF29411441FDBCAB453043F23A31411141D6C5A9C0BB4446421040573F1EBAB6BEBCC236BEB53E63416D4361B777C1F238BE3EEE4008407BB8184538BAB2355C43993ADC4210BCD23FE241CC4102A1C7C400C1E441DAB78AC5D1C38DC026C1E4BE89BCDEC1A4BA87C2AA4463C2E23F9240E242A6C2D7B8B94080B02E410F4490C1DE3C223E1FC4BDB8FA3C593C9DC4D8BDC34580B6353DF33DEA3999BCD2C06C417A3847420740034544BF42B863BFEE3529BE74BF43BE10B7E3C1BF4406B95EB81848D4BA4AC20A437F42923C19BDE53C01380B40A6BA06B9563D7741F0BCF5C1764650364F3BA8BC3EC501BD8C330F42ADC0973E594249BEB04412C033AD0CC69D409CC2B0400EC10DB72529F7C0FF3C2EC13C3F2A4574C312C2C141AC3DE93E99BF91AD2E280136BB4190C445B88443CD3D1DC495C500452FC403363B3A1ABF5C3E39B83038634035400BBD57C58C3D2EC153BF15BBF839E5BC51BA3C470A42C63D353B8E44B8C442462641823CE6457E40ED3C1ABB22460D4757BEFA4047B7B0452DBD13C2E4BCE4BFA4BCFE3F23C4FD3A8C405C3641446C404741CD4015C11140C0C435C43D42B93A14BC44B259BD0E421A48593FF8C13A410132DE405FBF9D41F92777C1963C063F7C3DDCBC9E400638A944FFACAF4150BEE9B6F4412E46E1C24B3DCB3EE8B722449042BE3B4AC9D33F2C40183E1AC3"> : tensor<20x20xf16>
    return %0 : tensor<20x20xf16>
  }
  func.func private @expected() -> tensor<20x20xf16> {
    %0 = stablehlo.constant dense<"0x003C003C003C00BC003C003C003C003C00BC003C003C00BC003C00BC003C003C003C00BC003C00BC00BC003C00BC003C003C003C003C00BC003C003C003C003C003C00BC003C003C003C003C00BC003C003C003C00BC00BC003C00BC00BC003C00BC003C003C003C00BC003C00BC00BC003C00BC003C003C00BC00BC00BC00BC003C00BC003C00BC003C003C00BC003C003C003C003C003C003C003C00BC003C00BC00BC003C00BC003C00BC003C00BC00BC00BC003C00BC00BC003C003C003C00BC003C003C00BC003C003C00BC00BC00BC003C003C003C003C003C00BC00BC003C003C00BC00BC003C003C003C00BC00BC00BC003C003C00BC00BC003C003C00BC00BC00BC00BC003C003C00BC003C003C00BC00BC00BC003C003C00BC00BC00BC00BC00BC00BC003C003C00BC003C003C003C003C003C00BC00BC003C003C003C003C00BC00BC00BC00BC003C003C003C00BC00BC003C003C003C003C00BC003C00BC003C003C003C003C00BC003C003C003C00BC00BC00BC003C00BC00BC00BC00BC00BC00BC00BC00BC00BC00BC003C00BC003C003C003C00BC00BC003C00BC003C003C00BC003C003C00BC00BC003C003C00BC00BC003C00BC003C003C003C00BC00BC003C003C003C003C003C00BC00BC00BC003C00BC00BC00BC00BC00BC003C00BC00BC003C00BC00BC003C003C003C00BC003C003C003C00BC00BC003C003C00BC00BC003C003C003C00BC00BC00BC003C003C00BC003C003C00BC003C00BC00BC00BC003C00BC003C00BC00BC003C00BC003C00BC003C003C00BC00BC003C003C003C00BC00BC003C003C003C00BC00BC003C003C00BC00BC003C00BC003C003C00BC003C00BC003C003C003C00BC00BC003C00BC00BC00BC003C00BC00BC003C003C003C003C003C00BC003C003C003C003C003C003C00BC003C003C00BC003C00BC003C00BC00BC00BC00BC00BC003C00BC003C003C003C003C003C003C003C00BC003C00BC00BC003C003C00BC00BC00BC003C003C003C00BC003C003C003C00BC003C003C00BC003C003C003C00BC003C003C003C00BC003C00BC00BC003C003C00BC003C003C00BC003C003C003C00BC003C003C003C00BC"> : tensor<20x20xf16>
    return %0 : tensor<20x20xf16>
  }
}
