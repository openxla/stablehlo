// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xi8>
    %1 = call @expected() : () -> tensor<20x20xi8>
    %2 = stablehlo.sign %0 : tensor<20x20xi8>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xi8>, tensor<20x20xi8>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xi8> {
    %0 = stablehlo.constant dense<"0x00FE0000FEFF00FC030104FC0301FF000100010003FBFF03000108FC07FDFC00030202FF020104FBFC000004010102FE00FF00FE000201010102010200FFFEFCFEFF050202FE030200FF01FF0100040400FE00FEFD00FF0A02FF00000402FFFB00FC000000FE00FF00FF0404FD0002000003FF030202000202FF0000FF02FCFA000100FE0001FD0001FF020000FDFDFA00030006FE01FDFB06000305030000FB00FDFC0003000000FC01FF03000302FE0001FF0000010002FE0002FDFE0000FF0306FF00030000FCFFFE0206FFFF0200FDFAFBFEFFFD02FE03FE01040203FF01030702FF04FEFCFE02FB00FF000000020100FF00FE0800FEFB0002FEFC01FFFF00FF01FF00010001FF020300FB000201FF05FE07FCFD0305010300FEFE00FDFEFD0300FDFEFE03FC060302FEFEFDFC0203FFFF0000030300FD0103FB0202FD01FFFE02FFFDFF03FE0101FFFF000000050104FB010601010600FE01010002F900FF01020001FAFFFD010005FF01FE0201FF02FF00FDFFFFFD00030201FF00040200FE0001FF0000000004070400FDFD01"> : tensor<20x20xi8>
    return %0 : tensor<20x20xi8>
  }
  func.func private @expected() -> tensor<20x20xi8> {
    %0 = stablehlo.constant dense<"0x00FF0000FFFF00FF010101FF0101FF000100010001FFFF01000101FF01FFFF00010101FF010101FFFF000001010101FF00FF00FF000101010101010100FFFFFFFFFF010101FF010100FF01FF0100010100FF00FFFF00FF0101FF00000101FFFF00FF000000FF00FF00FF0101FF0001000001FF010101000101FF0000FF01FFFF000100FF0001FF0001FF010000FFFFFF00010001FF01FFFF01000101010000FF00FFFF0001000000FF01FF01000101FF0001FF0000010001FF0001FFFF0000FF0101FF00010000FFFFFF0101FFFF0100FFFFFFFFFFFF01FF01FF01010101FF01010101FF01FFFFFF01FF00FF000000010100FF00FF0100FFFF0001FFFF01FFFF00FF01FF00010001FF010100FF000101FF01FF01FFFF0101010100FFFF00FFFFFF0100FFFFFF01FF010101FFFFFFFF0101FFFF0000010100FF0101FF0101FF01FFFF01FFFFFF01FF0101FFFF000000010101FF010101010100FF01010001FF00FF01010001FFFFFF010001FF01FF0101FF01FF00FFFFFFFF00010101FF00010100FF0001FF0000000001010100FFFF01"> : tensor<20x20xi8>
    return %0 : tensor<20x20xi8>
  }
}
