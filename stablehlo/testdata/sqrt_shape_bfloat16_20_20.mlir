// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.sqrt %0 : tensor<20x20xbf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0xC4BF51406EBF64C05E40F3BFAABFFFBD89405840014016C0E53EA4C097BF8D400AC0133F1640C23EB340B5C008BF40C0F9BF7240B440F23F47408440B3BE154088BF79BF243FA540C4BF2C40A5C09DBF15C1DB4076BF8DC029C09F40D1BF36C051C02B4086BF0CC0C8BECABFA6C0D83FA2C0CEBFA4C03F4013C0054090C0C0BF463FCF3FE83C3C40D23E02C07E402740104007C09C3FF6BF0C4063403940D340C0BF85BF5ABFBE403BBF5A4016BFE5BEFDC03D40B33F58C038C02440A93F3CC0763FC740F1BF1F40B3BF383F90BE164084BD863FC9BF6540C2408C402FBDD9BF92C026C0C03F27BF1140873E3ABE0B3F7CC03E3F823F414093C05EC0213F29C0D4C0673EDFC07EC051BF213F40C0C940613E863DDCBF69402540AE40A4409C40A03F6FBF7BC0983F86403C401CC097C0AC3F11405FC0B03F73C009BE94BED9BFCD406D40AAC01FBE1740EDBF2040A5C06FBFA1C023C02F3E3EC0BD408BC037BFA83FE2402B3E0C408D40D1403940AE3F9D40854017C01E3FC03F95C0A03F84C0F93F4C3FD53E22BF21C03D3FB8BD0A40F2BF3C408ABE3240B4BFC84007C0A33F0BC1B740523F933FC93F55401DBD48BF2A3F0EC005C0EA40D53F93BFC13F94BE1FBFA3BF83BE52C032C03CBE573E10403FC029406340EF3F3EBF54C0463FC9BF7D3F88BF5C3E824050C0C93F08C007402040CDBE03C03E3FDDBF9EBF70BF3B40D53F26BFEBC0A640FD3FAE40BB3FDD3F49C060BE4AC051C068BF5BC0383F0F3FA63F823F7C3F04BF573D9440A2C092C0604028C0933FE4BF5EBDAEBF08BD51C0EFBFBBC079C010405EBF0BC09340464061C0B83F00405C3F333FA33FADC0E93E5F3F30BF11BE1840F33ED03ECB3F93BF764098C096C09EBF88BF29407CBFCAC037C09C3FC0BE5CBD3BC0A5C0A5BFB7C01840CCBDCC4032408240AABF0140ABBF16C0B0C0014066408B3FE53F463F40BF0F403F400DC0C23FCF3F4540E2BF7940E3BFC9C0913F5D4040BE8BBF253C0241733FAABE0F4030408DBF95BDD94022BED64002C0BD3F7C3CA63F08C06D4021BEDABFD33FCC3FB9BFA83FFFBFEC3E2240513DF1BFACBF0EBF5EBFDE3E9D3FA3C0A13E8A3FF53E1A3F4240A43F90BE8D40"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
  func.func private @expected() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0xC0FFE73FC0FFC0FFEE3FC0FFC0FFC0FF0440EB3FB63FC0FF2B3FC0FFC0FF0640C0FF423FC43F1E3F1740C0FFC0FFC0FFC0FFF93F1840B03FE23F0240C0FFC33FC0FFC0FF4D3F1140C0FFD23FC0FFC0FFC0FF2740C0FFC0FFC0FF0F40C0FFC0FFC0FFD13FC0FFC0FFC0FFC0FFC0FFA63FC0FFC0FFC0FFDD3FC0FFB93FC0FFC0FF613FA33F2C3EDB3F243FC0FFFF3FCF3FC03FC0FF8D3FC0FFBD3FF13FDA3F2440C0FFC0FFC0FF1C40C0FFEC3FC0FFC0FFC0FFDC3F973FC0FFC0FFCD3F933FC0FF7B3F2040C0FFCA3FC0FF593FC0FFC43FC0FF833FC0FFF23F1E400640C0FFC0FFC0FFC0FF9D3FC0FFC13F033FC0FF3D3FC0FF5D3F813FDE3FC0FFC0FF4B3FC0FFC0FFF33EC0FFC0FFC0FF4B3FC0FF2040F03E833EC0FFF43FCE3F154011400D408F3FC0FFC0FF8B3F0340DB3FC0FFC0FF943FC13FC0FF963FC0FFC0FFC0FFC0FF2240F63FC0FFC0FFC53FC0FFCA3FC0FFC0FFC0FFC0FFD43EC0FF1C40C0FFC0FF933F2A40D13EBD3F06402440DA3F953F0E400240C0FF493F9D3FC0FF8F3FC0FFB33F653F253FC0FFC0FF5C3FC0FFBC3FC0FFDB3FC0FFD53FC0FF2040C0FF903FC0FF1940683F893FA03FEA3FC0FFC0FF513FC0FFC0FF2D40A53FC0FF9D3FC0FFC0FFC0FFC0FFC0FFC0FFC0FFEB3EC03FC0FFD03FF13FAF3FC0FFC0FF613FC0FF7E3FC0FFED3E0140C0FFA03FC0FFBA3FCA3FC0FFC0FF5D3FC0FFC0FFC0FFDB3FA53FC0FFC0FF1240B43F15409B3FA83FC0FFC0FFC0FFC0FFC0FFC0FF593F3F3F923F813F7E3FC0FF6B3E0A40C0FFC0FFEF3FC0FF893FC0FFC0FFC0FFC0FFC0FFC0FFC0FFC0FFC03FC0FFC0FF0940E13FC0FF993FB53F6D3F563F903FC0FF2D3F6F3FC0FFC0FFC53F303F233FA13FC0FFFB3FC0FFC0FFC0FFC0FFD03FC0FFC0FFC0FF8D3FC0FFC0FFC0FFC0FFC0FFC0FFC53FC0FF2240D53F0140C0FFB63FC0FFC0FFC0FFB63FF33F853FAB3F613FC0FFBF3FDD3FC0FF9E3FA33FE13FC0FFFC3FC0FFC0FF883FEE3FC0FFC0FFCE3D3640793FC0FFBF3FD43FC0FFC0FF2740C0FF2640C0FF9C3FFE3D923FC0FFF63FC0FFC0FFA43FA23FC0FF933FC0FF2E3FCC3F673EC0FFC0FFC0FFC0FF293F8E3FC0FF103F853F313F473FDF3F913FC0FF0640"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
}
