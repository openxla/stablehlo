// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xi8>
    %1 = call @expected() : () -> tensor<20x20xi8>
    %2 = stablehlo.custom_call @check.eq(%0, %1) : (tensor<20x20xi8>, tensor<20x20xi8>) -> tensor<i1>
    return %2 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xi8> {
    %0 = stablehlo.constant dense<"0xFE04FF0100FEFE0004FC000001FF00020301040400FC03FD0005FC0200FC0100FCFE04FE0001FE020205FD030100FE000003020000FD010000FF010100FBFDFB0004FEFEFC04FB00FC0100030001FCFF01FC01000501FEFE0202FF010300FCFFFF0702FD01020000040001000000FFFF02000202FFFD06000000FFFF02FE0000FD05FF000004030001FEFFFC00FDFF0000030201010000FFFEFE01FD070201FE05040003FDFB0100FD0201030004FB0004040000FE0400FF01FFFC0001FCFFF900FFFC0303FAFCFE00030000FFFEFF0001000400FC00FF00F600FC0400060100FFFE0000FE0000000107000204FF000002000002FE000003FF0101FDFF0301FE000300FFFF01000103FFFFFA01FF0201050000000001040304FF04FE0001FFFF000200010000FC000001FFFC0002FF000007FC0003FFFE000100FD0006FE00040000FF00050103030300FFFA0300030205FA00FFF9FF000006FF00010003000402F6FEFC0405FDFFFF00FDFFFC0703FB0002FE03FE0401FE00FF010100020301FF000000FD0002F905FFFAFFFE02FF00"> : tensor<20x20xi8>
    return %0 : tensor<20x20xi8>
  }
  func.func private @expected() -> tensor<20x20xi8> {
    %0 = stablehlo.constant dense<"0xFE04FF0100FEFE0004FC000001FF00020301040400FC03FD0005FC0200FC0100FCFE04FE0001FE020205FD030100FE000003020000FD010000FF010100FBFDFB0004FEFEFC04FB00FC0100030001FCFF01FC01000501FEFE0202FF010300FCFFFF0702FD01020000040001000000FFFF02000202FFFD06000000FFFF02FE0000FD05FF000004030001FEFFFC00FDFF0000030201010000FFFEFE01FD070201FE05040003FDFB0100FD0201030004FB0004040000FE0400FF01FFFC0001FCFFF900FFFC0303FAFCFE00030000FFFEFF0001000400FC00FF00F600FC0400060100FFFE0000FE0000000107000204FF000002000002FE000003FF0101FDFF0301FE000300FFFF01000103FFFFFA01FF0201050000000001040304FF04FE0001FFFF000200010000FC000001FFFC0002FF000007FC0003FFFE000100FD0006FE00040000FF00050103030300FFFA0300030205FA00FFF9FF000006FF00010003000402F6FEFC0405FDFFFF00FDFFFC0703FB0002FE03FE0401FE00FF010100020301FF000000FD0002F905FFFAFFFE02FF00"> : tensor<20x20xi8>
    return %0 : tensor<20x20xi8>
  }
}
