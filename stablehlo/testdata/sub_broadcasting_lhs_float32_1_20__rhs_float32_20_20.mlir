// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<1x20xf32>, tensor<20x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.broadcast_in_dim %0#0, dims = [0, 1] : (tensor<1x20xf32>) -> tensor<20x20xf32>
    %3 = stablehlo.subtract %2, %0#1 : tensor<20x20xf32>
    %4 = stablehlo.custom_call @check.eq(%3, %1) : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<i1>
    return %4 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<1x20xf32>, tensor<20x20xf32>) {
    %0 = stablehlo.constant dense<[[-4.54899216, -1.00833368, -1.6699388, -3.83917975, -1.39953744, -1.7187531, -0.23613134, -2.34502339, -3.81695914, -5.88713694, -1.84146988, 1.98839545, -4.28107643, 0.0741336345, -3.61227131, 3.67890692, -1.28748453, -4.80131769, 0.435120285, -0.929729759]]> : tensor<1x20xf32>
    %1 = stablehlo.constant dense<"0xF0125BC09CD503C04FE182C0A8431CBE164D3C40B8AC1AC084E4D43FE420A73EEF2ADF3F7041BD3F035F11C0D78E9BBDCE0A13C025F4C4C097AD923FFBF45ABF350188BFF469A9BF0561E5BFEBAE3B3E83D8ACBF621188C0D732EBBF37ECAC3FCA61E33E973667BF314ED940A0B7B24098743ABF4EC42C3E5EFF59C01A4CCD3F2EF0083F6E96B4C0A8449240C7BB303FDD703B406A7C3540D69FCD3F24AD80BE17A569401BDA1EBF6FD39BC0F13BB33B9FDA1EBF2A23B1C0379EA2BE8C4861C0E16D0441BE5BFEBF54B78AC001E7D13EB94DEDBEC9D1A2C0985BE640DD80F83F6CF1CBBE1CE097C00333B53FABF515401D2CF8C01CC74E40250DF83E01C549C0B976B6BFE9350B409DDF664062FED3BF425F7EC0DC5B4240F9CB21C03BC2F8408335C83FDE5195BFF2B3D73EBBB91DC01332883E285BFF3F8D965840A3852BC09FEB0C401387DE3E6718B3BF22FC24BF28CC4D40CC025EC025BE9DC078816E40EBC56A40ADB74B40758D623F9967E6BFABD020BF4B3C1A40B7E4EF3CFFAF1AC0BB58A03D37113FC0016664C00E985640965FBF3FB8D481408E004CBFCA3EBBBFF7A04D3FBC72AC3F2C5A993F265B5840E85A30C0A2A2B13D7B585EC0A026B8BFCE412C3FB232F1BF7C15A7C0DFFF22400D08EBC08783ACBD15168DBFA722E5BF18075CC0318B8BC04FF8C2C04C160341F8A906BF108311C02A693140C20E9A3E1782163F29CC1BBF2424F23F6D530CC0BAE882C04BF64340D6D4413E5C0B82C0EE9D093F71CF3D409B4E66BFF1227640D5B33A40836A7DC0A37388409DE77540BD3D71404F0A56C05106DEBE9214374085A92E3F7C395BBFE37BC23FBD6135BDF1C5884008EB32401B4554C0D19399BF46C4583E9E2CBCC0EC372440460C6F40B929B73F27A0AFBE1CAFAB402944E1BE95EC93BF162E0A401CFB124015A4963F1CEAB33F26491FBFBF7583BF080484C0F0091A40F346AA3D0799F3BF6850C3BF663113C01F4DC7BEE5D98FC06FC9053FABC25B406F8E5B406111D3403CC92C405A55C2BF94936240915AA1BE23A9C53E02928ABEFACE2240DA8A963E49EF6F4094BD92BEAEF739C0AA8B0B400E2621BF609316C04BC9ED3F87AA08C0069303C0F5F30D40FB6A9A3F180037C0EC5B854092C357402B91863FB8E28BBEDD9D5640741B26BFBD96A43E5D5E6840A1667DC093B5633F184DCB403C270DC1D23DC540DDE53BC014464CC0116C16C030DFA9C045E53CC0F45C76409776C23F1CCD0AC09044D8C0152C99BEA8001AC07FBE17C0D9B91CBF247292C05A4131C0D8287DC029B0F13F61478B407AFAEE3E6E20E7BD1BCB924063EE8FC03513F2BFD81D373FC222464040D2364061877540A8701CC015ACBCBF33E919C08B217DBF2DB98C3F77CD3D40404F1EBF47F289C0B4B3433FA47608BF1FE14EC0A36896BEAD790D409C3A41C0DF9A85C06EA06340B2369D3F551A44C0BF792BC07CC338C086D91D4007C01DBFE3349640C10A3BBFC48823BF62A69DC094FE2C3D5429B73EA501FCBFC0ECE83F8A8AB4BFC2F183C0F3EDE040FB9A8FC021D627405655E63F98EEE2BF93FA9A40BE5BF93FC66516409A9718C0EA54B2BF26CB44BF92DCB13E04AD053F843F2A40B77CFCBDCBE567C0749FBD3FA52CA1C0FC2D45BFA3B72A40EC10B5BE0FAF2940ED2E7D405018B3403DE5A9BF90EC983CBA9E95BF6921A5BEE512D4BFB1DC2EC078CA13C0C6251E401254D2C0CA0270C0F4236CC04C35E2409D8126C0BB0213C03B0E3FBFF25896C0008DF23EF9CC603FA1C93D4017A7623F53D882BF16E565C01E448A40804721C055D7EFBE56C19D402688954091396FC09250C53F80DC9C4097453A4098D6A340936093BEE212FF3FDED15740A748EDBE671BE23EFC9180BFA9AB2FC06A14E4C0722F62BE3BD1A9C05765A3C0B313F33CF903BDBE5C4DC6BFB0C9BE3F0AD104BFB9555DC02E350EC09B513D404A7B2540200D8240B24C01C0F31527C0460515C0D13564C07BA285C0501CD63EDE7CAE408056A4C0F15E12BFCB00F03F1A61E4BD05C689C06242C5BF44C3EBBFF40C68C04A57B8BF68B1933F7018B33DDA51A84087AC8D3F88B38DC0E1BE813F324793C05DBA98C0CCEA99C0507736404FD4093F44A89740EF761FC08FBB69C0C623F8C0477D75BF6CEBE83FBC9AC140E859613F24502940CFC6B24005F6D73F437684BEDC0732BF1E9686C08CE986BF6F4A893E1DC23CC0BEA4713F263C72C065E4B9C0EFC5C3BF"> : tensor<20x20xf32>
    return %0, %1 : tensor<1x20xf32>, tensor<20x20xf32>
  }
  func.func private @expected() -> tensor<20x20xf32> {
    %0 = stablehlo.constant dense<"0x801F90BF249A863F57E21A40E4F06BC08EEF8AC0ACB2323F111EF3BFFAF82AC043EFB1C0C9B3EBC0F422DC3E561E0440B4E4FDBF7253C740204398C03A189140B05866BED0935EC085890E4040778EBF6EB64CC03A9A4F4048922B3E9D15A6C07EFCEBBF9DC950BF94DCE0C00EC2FDC0E9AB45C08FC9C1C07349C83F90DEC43E9A1C9AC0BCF5B64031EE02C144443F4081EB86C09A62F4C0D0ED95BF33AC2DBFF23103C11A90C6BE97C64C40BD0E76C0776D47BF4746744008E0A63D5E67963F258041C1FB9879C004941F40FE09CA3F715374C01631A540A9F92CC18F65DE3FE09F63BF802462BDFB017BBF5C7651C08A354D40D3A787C0ECE109C078C02FBF80ABD43CF63579C064FC75C0B05630BF3063213EAEC80EC152C52F3F4C21B9C0F50BBBC014CF9E3FF91281C07896C440D0D8C6BF2F7BD9C08ABD3CC0E409E03F2807D8C0D9B2B8BF9CA08ABE16764CC017AF93C07E05E03FC22F96402A4BC2C07D87EFC0A21F11C1027E2EC0AC757240FDC869C0B07D15C03D0F69C09A11C340D7D1AEBF266FE8BF821F8040600C89C03E69C1C0FD18A2C08E805FBFBA1518C043FA0CC06B3944C0B993B7BF0238B7C04EDC87BFF829BFC0ADFBD03F2F555B40CE869EC0E8AFFA3F08F7CD3FAEE6903FFAD4C14057F296C01AC8C43F89425C3F30378EBFD88D56402C888D40948340C11E9E5FBF0C0C0E3FF18540C0B55629C0CAF48CC0E8E9A8C0B6EC6EC0A6CA854040BB42BEB0373FC0C14C73C0F7C4F740429BE9BF1E8CF8C053D9AA3FD1D198C042EBEEC0F9E13C40C6E3BDC05ECEF5C0E167A5C08414D03F38404A3EB894A6C0B8F98FC03EFCA0C0961857C06617024042E208C16D2C2EC0C85297BE8F1E9C40D4E4BFBFE4208A3FE95E08C07C4695C0C65BBFC014522ABF401FE1C09A8C59C0B0BB79BE232E78C0E31722C0E86661C00E1FA7C0487AA8C0147F50BFF8A4C3408C03D6C0989C13BCE1C5DABFB58DA6408196813F932F8DC066C69D401AE6B9BFAE72FFC07C0B8EC0C24004C12E3FD1C0F014F33DD049A8C070D1A13D01CA2EC0CFF662C075E506C100AC08C0D45AE1BF76A57FC049B63E408F5DB9C05DDE8940755A883FB816D5C08A832440AA24903F528BD8C008BE0DC0A23F983F3E1B00C1CCAA98C0A24831C018E4173D5D59B6C032C24AC0D9ACC6C0811CAFC04054BE404675A5C0CAEDC8C0BEB6A6406E081FC06FFFD23F6C05CEBF14453240D71E8C40D67ACCBFBF729BC0921B4CC006D0D5BF8D7BAB4015B5B5BFE1E30A4000D1D43C991A4DC024C5A7BFD69A6D3F5C35BE409E6AC5C014E888C0628782C039AC72402EFEBBC020609BBE9DE214404E90D2BFB9A2F4C0CA5A77C0D433B0C0EE88B2BFA080983D98A42F3F70AE403F74715CC0430BD9C08599A8C0EA091E40E4A99C3F7FDF6FC0BA9F5340606254C012F3BB3FEDA8DD3F304C20BF6BC747C00A1C0AC0B610BEBF6AE2D53F6AC69B3F52C7C9C00F8848BFEA34CDC04D2FFD3E5865DABF6A078E3F6ABDBDC0CFBF0CC0B2427D40C439C3C0C007BE3F40D0023FB06856C0D0CF4C40768FEDC050A3AEBF6BDA573FF64516C169363DC006A380C00A3BBABF0021CFBB0E3573BF646115BF1E8037C04A44CFC07A71B8C04D16E43F94C8013F8870413F6828583F8CF3C8C0AA0A814034157CC0EE1D0CC1CF2BA5C06A8FCB3E452A92C0306D243E3478ACBFACAB0BC05795AA3FAC29173F8D422DC0A4498740A0C888BDE6A20CC04F910EC1BEE19240DAF4FDBFA708523FE0048B3F96214D4064990AC03689F8C01886E6BE086FBD3D68F674BF6388AAC0E49C593F34BA57C0598ACAC02C88CCC0CA1C604026BD78C084800BC11CC30CC1EAC3DEC0F1AD11404CC3C8C0431353C05F8649C0C92F4F403CE990BE219D03C0EB00F240E87635BF18FF413F12218340DD8CD9BFA0145EC0884A193EE5644DC0DFBB903EB8818E3FC227CCBF1D860DC1F7AA8DC061D804C076B010C08ED42B405C54A4BF84D4E740D0DE38402A06A7C05D90A0C027968640F48A7EC0F08838C07C7AC7BF58B7EE3EB8F2103EA032FC3D2DF05840E0A467BFE2109FC0CF2FBFC02C3FE3C06EAE613F809E163E568370BFC07B7D3FFC390741726F61400DE0F4C02082D3BD9D68B5C0C1AB03C005332940A2B3C240CD5538C0BC074EC0C29AF8C081E68EBF80B29FC0AB7516C1EE60F2C0B897CABFD6C32B40801D9ABDC266903FC25878C0AA1AD44055CF0EC0481982BFE6D0C7401989193F"> : tensor<20x20xf32>
    return %0 : tensor<20x20xf32>
  }
}
