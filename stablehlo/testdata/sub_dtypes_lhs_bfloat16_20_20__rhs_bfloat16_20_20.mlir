// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xbf16>, tensor<20x20xbf16>)
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xbf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xbf16>, tensor<20x20xbf16>) {
    %0 = stablehlo.constant dense<"0x0BC082C01A417D408ABE7440B13F8BBED6BE79C00EBF8C40613E4C3F90C081C0BBBFA23E3440194011C0AB3FA4405FC03D400E4097C0D23FBC40E44027404F400DBF54BFE5BF0F3FAA40B83F1CC075C0F8BFD53F7C40CF3F99C0A040B33E95BF404085C04EBF6F3F41BFCB3F7740C3BF8640DB3F3BBF4F3F0AC00A40AFBF5D3F0A3F3DBFC33F08C03CC065C04ABF73BFAEC0443FA6BFDD3F503ECA3F2C40AA3FF4BEF73E8FC007405C3F6C403F40964097C0BABFE140D4BF534017C0B23F494049C01CBF62C0554026C00D40A3C0AD3EA9BFCABE4E40C6BDF63E2B3F703F7C4015C070BF9440A640FEC0E1BD603F0240A73FE73E9AC092C057BF8D40A0C07B40FEBD44402DC062BF823FD1409AC0F23FFDBF2F409240C740733F97BF273FEDBF144020BE8E40B3BE5ABF04406CBF9A3F3CBF454006C0BF3E5CC05E3F3B3F164085C0D53F823F40C0244004C04B40374060BF30BF85C0CE3ED7BF06406AC0793F0640BAC0E43DF1BFE8BFA0BEFEBF12401740AFBF263FA9C064408F40AEC0BC3F67C0E9BF50C0FB3F14BF5040C23F8A3FB94007C0253F04409B40CE3E50408A40CC3F3BC021C09E4036BF22C0A9BFD040A1405DBFAEC0AA3F84C0213F6740863F1FC0A140B93F80C027407040243EFDBFA3BF66BF8DC0EAC0E73FBD3E2D40983FCFBF8A3F37BDBE3F8EC08F4074C0A740084043C0D73FEA3EBBBFB33D1A3E2940884041C0B23F66BF083E0940E93FB23EE1C039C07940E24045C0FFBF4DC00FC09DBF9A3D49409F3E28BED3BFC0C0CBBF8BC08B401240D5C0A440A14009BEE03EC43FF43FE8BF21C0FABE1BC04CC03D40C1406A3E7DBF3E404B40B04097BF3C3EA2BF07C09BBF5F3ECA408B406F4054C05CC006C088BF293F5540C33F27BFF33F2BBFC4BF78C0114046C006C01D3F04BF81BF843F534094C0F83EF040CBBFBD3F1DBFF33F394063BFE43FC0BF59BF2CC094BE62C012419E3F4A40F2BE984039C0DD4001BF1FBF07C0314019404240B340A1BF2B4051C001408FBE1D400140B8C07DBFAFC08AC09940A8402940C9BF6F408AC073C002C08EC06FBF69C06440ACBE8940DA3E70C0E440CCBFA1402A405DBFF3BF18C01BC001C08A40C43F73408D40"> : tensor<20x20xbf16>
    %1 = stablehlo.constant dense<"0x053F6A40CD40E43F5A40CDBFD93F1EBDA0BF9DC016400EC048C06A40ACBFB5408E3FAF40EA3E8DBF6540104053C056407C3D8B3F81BF3CBC443F94C0F73F70C0DFC008C0233F75BE36C05FC082BF04BFF9BFECBC994099402FBE12BF21C079BFB4C0B4BFD5BF1EC0364056C0B13FE8BE1DC0D0C0193FCCBF5BC0933F3DC0EE3F5B401840973FB3C0424042BF5FBE2EC04DC0B8BFDE401640844028C03D40144018C090BF7E40074096403AC0CEBF3C4030BFA8BEB740E0BE7F4052409B40A13ECD40FF3F76C06BC06C4016C087C07C3F0E40414030409F3F42C0C03F1F3EC14015BF25C0973FEA3F2C4054C013C0B2BFD83FFD3F8CBF8A4080C0D1BD183FCF3FB83F0840C3BF32402C40373CA0C0A040823E0D401D3FD13EDCBFE3BE81C075BE5C3FAFC030BE96BF2EBF4C40FEBFD43F634012C1D4BFFBBF273FBB40ACBF633F24C06640303FF23F0DC05840F0BF3E4097BF8E40833F61C0EFBF9C3F5BC05D40D8C023C13040D13FB53F943F8E40783FEC3FA4C0E5BFAF40063F2740D63E513F3DC0DC3E67BF8B40ED3E6FC034BF6E3F6040AE3FE3BF62C01ABE6E40D0C08DC036C0873F00408E40D23F88BEDA3F91C0CABF1BC0B03F96C09CBFEBBFB23FF0BF50BE41407CC0C53E83BEAFC0B7BF334013408740DABE5BBF17BE633FCA3E4ABF8B4080BD57C09AC050C018BF8B406CC0A93F12C1BBC03F40D4BFBEC0164075BFFDBE79408D3F343F61405CC0134136C0BB3FD7BFE43D89BF94C01DC03AC07240FD3F0C4049C085C0C6BF7B3FD8C0673FBC403740D1BFFC3F993FA24095C0673F19C05C408C3FC44089C0464071BF88C0B94094C079C03DC042C0803FE83F27BF203F36C099C056C02140A84086C0CB3FA33E8C40C93FE83F0A3F3A3EDFBFDE3F533F81C093C06EC0843E0A40EB3FB43F663F564011C020C01AC04F4084BF5ABF1EC0603F7BC099BF814084409240A43FC6409140AF403EC09EBFB9BBB0BFAF3F12C088BFDC4028BE08C124BFC03F3B404B407ABF02BF8FC0D53D46C08A402C40373E4EC086401CC09C4045407C40C53E873F864016C058BE25C02EBF86BF303E1F3E3B3F2F3F2FBFFE3FBE4040BE83BF913F024047BF2DC097BFD53F7ABFEEBF"> : tensor<20x20xbf16>
    return %0, %1 : tensor<20x20xbf16>, tensor<20x20xbf16>
  }
  func.func private @expected() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0x2CC0F7C04E400B406BC0AD40A0BE6EBE553F823F3AC0D340564037C04AC01BC124C0A5C017406040BBC06ABF0741DAC03940913F6EC0D33FA4403C412E3FE040CD40A63F1BC04C3F02419E40B6BF54C0003CD93F58BF4AC094C0B240374044BE0A4130C05C3F5A4066C09E401E4089BFD4400341AABF1A40A23F813FCB3F7FBF38C047C0B03E5E40BFC034C012BFE23F0FC00D4004C11EBF7BC0864088BE7CBFF33FCE3F07C1000075C0D3409340E03F81C090BFA83F9CBF30BFB4C05DC0354019C126C0A03EE040C9C0924060BF26BF62C05AC0F03EABBF614055BF483F06C0E0BFD23F5C4057402AC14D404B405B40C4BEC3BF6EC00EC14A409040B3C01440C8BF703F97BF6AC0D6BFD140403E47C00FC0083F7D40BA402B403CBF9640CEBFBA3FAA409440523F30BE90BF883FE8BE89C04341E0BE154083C09FC00540BA3FCCBFF7BFA83E9CC09840AEC0A240E0BD9C3EA4C0A6C07B40403E603F70BE1FC00E418C4029C061C04EC0BCBFCEC0A83F043F70401C402CC14240EE3FBBC0273F28BF10C016C018C085BFE0400E40183E12405EC01B40B340A04054C01C410C418E407EC090C0003F16C011C042C03041D440C83FDAC0C0403AC01E400E403B4012C00140AC408CC037401441CC3F99C064C0A4C07FC0CFC0FA3F04BF1440FD3FBFC0923F5440CA4098BFA24002C10E414E3FC240F14022C0483EC1400CC066409840DDC0943ECDBF58C0B240ECC04C4008C19BBF72400241C63FEC3E98BEC0C04DC007C0C9408F40B13F28C0403F1FC024C1BE3F7A400AC17C4000BD9140EEBE7B40C4BF3AC00AC17340B0C010C0E640803E9B403A40BE40C640904040C0563FF2BF3C3F64406440734068BFFE409DC070C0CFC028C094BF3240AC3F8C3F283EBFBF2040383FC04056C088C09CBFF6BFF4BF14C0B24008C0394088400EBF1540EE3F833FDA409E3E10C0B4C0ADC07EC0CFC001C16A4086408C40EFBEC44088C013410F3FF0C0F9BF34414240C43F2B408EC06A4030C0D040C4BEB24013C007C195BF10C008C1E740C03EE0BEB0C05640ACC000C1A03E87C0D23F3EC0944002BF84409CBE8EC0FA4065C068BF3640243E42C08DC0D2BF303FB04008BE9940C840"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
}
