// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xi16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xi16>, tensor<20x20xi16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xi16>, tensor<20x20xi16>) {
    %0 = stablehlo.constant dense<"0x04000000FFFF00000000FEFF020002000500F7FF0000FFFF040000000000FDFFFCFFFCFF01000000FFFFFEFF05000100FFFFFEFF0100040003000000FDFFFAFF00000000FFFFFFFFFDFFFCFFFFFF02000000FFFF00000400FDFFFFFFFEFFFFFF01000100050004000000FCFF00000400FDFFFEFFFFFF00000000FEFF0000FEFF0100FCFF030001000100FFFFFEFF0300FDFF0000FCFFFFFF040000000000FEFFFEFFFFFF0300FBFF0100FFFF0100040000000300FEFFFFFF0100FEFFFFFF0200FEFF010001000200FEFFFFFF00000000FDFF00000500000002000200FFFF0100FFFFFEFFFFFF000000000200FFFF0100FDFF0100FCFFFDFF0200FEFFFCFFFDFF00000100000000000000FDFFFDFF0000030000000000FEFF03000000FEFFFDFF0500000000000000FFFF0100FBFF04000200000000000000FFFF0100F9FF00000100000001000200FCFF0000020005000000040002000000020004000100FCFF010000000000FAFF010004000100FFFF0100FCFFFBFFFEFF00000400FEFF0000FEFF0100FDFF00000000FFFF0500FDFFFFFF0000FCFF030003000000FDFFFFFF04000000FFFFFDFFFFFF0100FCFF0200FFFF020001000100FFFF000000000000040006000000FEFF0100000001000000FFFFFCFF02000000FFFF02000100FBFF0400FFFF0300FFFFFAFF0000FEFF000001000100000002000000FDFF00000200FFFFFFFF0500FEFF0000FFFF03000600FEFF0000FFFF000000000100FFFF0400FFFF010003000300FAFF000001000200FFFFFEFFFCFF0000FCFFFFFF06000200FEFF0000FEFF010002000100FDFF0400F8FF0200FDFF0300FFFFFEFF0000FEFFFFFF0200FEFFFDFF04000100FFFFFFFFFFFF00000000FFFFFCFF00000300030000000300FFFFF8FF000000000000FDFFFEFF0400FEFF03000300FEFF0100010006000000050000000100FEFF0200020002000300FEFF00000200FDFF00000100FDFF0000FFFF0300FDFF000000000000FEFF00000100FDFF000002000600FDFFFDFF000004000100FDFFFCFFFDFFFFFFFFFFFDFF0000000005000100FEFF03000100FDFFFEFFFDFFFFFF0100FFFF0300020003000000FFFF0200FDFFFBFFFDFF"> : tensor<20x20xi16>
    %1 = stablehlo.constant dense<"0xF9FFFEFF0100FFFF000001000000FCFF000002000400080004000100FBFFFFFF030000000000FCFFFCFF0000FDFF0300FDFFFFFF000003000000FFFF00000000010002000300000000000700FFFF010001000200010003000000000000000500FEFF03000100FAFF0100000001000000FEFF00000000FFFFFDFF04000100FCFFFAFF000002000000FCFF00000000FFFF0100FDFF0300000000000300FAFFFDFFFEFFFDFF00000200FFFF00000300000001000500020000000100000001000100FDFF04000300020001000100FCFF02000300F9FF0000FDFFFCFFFCFFFDFFFAFFFDFFFDFF03000500040001000200FFFF030001000700020002000000FAFF030000000100FDFFFDFF0000FEFFFCFF04000200020001000000FFFFFDFF00000300FBFF0600FFFF0000FCFF0300FEFF000001000000010002000500010005000000010000000600FCFFFDFFFFFF00000000FEFF02000000FFFF0100FCFF010000000200FEFF0000FBFF0500FFFF01000600FEFF0100050001000300020000000300FEFF040002000000FEFF05000000040001000100FDFFFCFF05000200000006000200000000000000FDFFFFFFFCFF0000000001000500FDFF0500FFFFFCFFFAFFFFFFFFFF0300010002000300FDFF020001000400FCFFFDFF02000000FBFF0000FCFFFFFF000003000000FFFFFEFFFEFF00000200FDFF0200010001000000FAFFFEFF000000000600FDFF0300FFFF00000600FEFFFDFF060000000200FEFF01000200FFFF020000000000000005000000F8FF00000000010003000400010003000400030001000200FEFF0200FDFFFFFFFDFF0300FAFF000000000000FFFFFEFFFFFF0000FFFFFBFF0000FEFFFDFF00000200FFFF0400050000000200FCFFF9FF00000000FCFFFFFFFEFFFCFFFFFF00000000000000000100FCFFFFFF00000100000001000100FFFF00000100000000000000FFFF010002000200FCFF00000100FEFFFEFFFEFF0000FEFFFDFF0100FEFF0000FBFF0200FDFF04000100FEFF01000000FEFF020002000000FFFFFFFFFEFFFBFF0000FDFF000000000000FCFFFBFFFCFF0200FAFFFFFFFFFF0300FCFF07000000FEFF0000000000000000FEFF0100"> : tensor<20x20xi16>
    return %0, %1 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> tensor<20x20xi16> {
    %0 = stablehlo.constant dense<"0x0B000200FEFF01000000FDFF020006000500F5FFFCFFF7FF0000FFFF0500FEFFF9FFFCFF010004000300FEFF0800FEFF0200FFFF0100010003000100FDFFFAFFFFFFFEFFFCFFFFFFFDFFF5FF00000100FFFFFDFFFFFF0100FDFFFFFFFEFFFAFF0300FEFF04000A00FFFFFCFFFFFF0400FFFFFEFFFFFF01000300FAFFFFFF02000700FCFF010001000500FFFFFEFF0400FCFF0300F9FFFFFF0400FDFF06000100000002000300F9FF0200FFFFFEFF0400FFFFFEFFFCFFFFFF0000FEFFFEFF01000100FDFFFEFF0000FDFFFEFF0400FEFFFAFF070005000300060006000200070002000100FCFFFBFFFCFF0100FDFF0200FAFF0000F5FFFBFF0000FEFF0200FAFF00000000030003000000FFFF0100FCFF0100FEFFFFFFFEFF04000300FEFFFAFF0A00FAFF010000000300FEFFFDFF040001000000FFFFFEFFFAFF0000F4FF000000000000FBFF0600FFFF0100020005000200020002000100010008000000FCFFFFFF02000000FFFFFCFF05000000F9FF0300FBFFF6FFFDFFFDFF0200FEFFFDFF0000FDFFFBFF00000200FAFF0500F9FFFEFFFFFFFFFF0700FEFFFEFFFDFFF9FF02000000FFFFFDFF0200020000000200FFFF0100FCFF0400FAFF01000400060005000700FDFFFDFFFFFFFDFF0400FEFFFEFFF8FF06000300FDFF02000600FBFF080000000300FCFFFAFF0100000002000100FFFF03000000FFFFFCFF000008000100FFFF0500F8FF0300FCFF04000600F8FF02000200FAFF0000FFFF01000300FDFF020001000300FAFF0000FCFF02000700FEFFFCFFFFFFF9FFFBFF0500FFFFFAFFFDFFFDFFFFFF0400FFFF00000500FBFFFFFF03000300FFFFFEFF0100000000000200FFFF0200040003000200FFFFFDFF0100FCFFFAFFFCFFFEFF07000A00000003000300F9FF020004000100FDFFFEFF0400FEFF02000700FFFF010000000600FFFF040001000100FDFF0200020002000400FDFFFEFF0000010000000000FFFF020001000300FFFF0300FFFF0200FEFF0500FFFF0000FCFF01000800FCFFFDFF02000200FFFFFDFFFDFFFEFF01000400FDFF0300000005000100020008000500FBFF0400FEFF0000FEFF0300FCFF020005000000FFFF0200FDFFFDFFFCFF"> : tensor<20x20xi16>
    return %0 : tensor<20x20xi16>
  }
}
