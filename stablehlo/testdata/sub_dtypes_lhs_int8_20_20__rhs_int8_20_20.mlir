// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xi8>, tensor<20x20xi8>)
    %1 = call @expected() : () -> tensor<20x20xi8>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xi8>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xi8>, tensor<20x20xi8>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xi8>, tensor<20x20xi8>) {
    %0 = stablehlo.constant dense<"0x0301FE00070104FFFF0203FFFFFF00FC01030AFC0006FCFC00FFFEFC0202FEFFFE0203FD06000106000200FF0300FC00FE0100FD0304000400FB0700FFFDFE01FC01FB01FEFBFCFCFE00050000FD00FE000300FDF900000000FE0000000300FF01FF00FEFF0000050000FE0106FDFD03FD01FDFCFFFFFF0004FFFE0001FF0000FE0105000100FDFEFF01000201FBFCFEFF040400FEFC000100FEFD0106000505FDFEFE03FD0202FEFCFD00FEFF00FEFFFB01FE0000040000FD010000FB060101000302070202FEFE0001FE0003FE000002FF04FDFC0302FEFF02FDFF00FF00FD01000501FAFDFF0100FEFC0100FFFF000301020102FAFFFD000400000000000200FD0004000005FF000403FF00FCFB000200FD000000FD00FC01FC0000FF0001FD00FFFC00FF0105FD0300FF0000FEFC0002FC01FDFB000100010200FFFEFD00FEFC00FF000200FD020000FD0303060000FF04FF0001FC00FE0200030200000200030000010003FFFF0001060300030300FEFFFE00FF00FFFEFE00FD00000001FC030202FAFDFF04FB01FDFEFE030002"> : tensor<20x20xi8>
    %1 = stablehlo.constant dense<"0x0402FF030202FF040003FF0003FEFCFFFF04FF00FEFDFE01020000FF0000FC01FF00000106F9FDF80100FE00FBFD0203FFFF02FE02FF010500FEFD00010104000000FEFE0205020001010004000200FF0003FF0001FCFD00030002FEFF01020104020203FE0100FF00FFFEFF00FD00FB00FFFF000000030001FB00FDFDFD0300030301FFFC0204FFFFFEFB0001FD01FF000101FFFE04FD00FF0400000302040000010000FE00FFFDFE0000010000FF0006FE00010600FDFF000000FE00060000FFFFFA0705F603FBFD01FE01000000FD00000100FC04FD0401020103FE00FA01FF07FF0001FEFEFFFC00010101FEFDFF01FF0602010201FEFD06FEFD01FE0001FD00040002F90000FD0000010000FEFCFEFB00FBFEFE0100FFFB0302040401000600FFFF000501FEFFFF02FEFEFCFC0401010001FDFEFB01FEFE0102FA010200000401040002000100FFFC00FFFD03030104FE00FA000400000301FCFE00050000FF0002FD000304FC0002010300FBFC02FFFF0101FE02FCFCFD00040200FFF902FF00FF00FC040102010302FC02FDFB"> : tensor<20x20xi8>
    return %0, %1 : tensor<20x20xi8>, tensor<20x20xi8>
  }
  func.func private @expected() -> tensor<20x20xi8> {
    %0 = stablehlo.constant dense<"0xFFFFFFFD05FF05FBFFFF04FFFC0104FD02FF0BFC0209FEFBFEFFFEFD020202FEFF0203FC0007040EFF0202FF0803FAFDFF02FEFF0105FFFF00FD0A00FEFCFA01FC01FD03FCF6FAFCFDFF05FC00FB00FF000001FDF8040300FDFEFE020102FEFEFDFDFEFB01FF0006000100020600FD08FD02FEFCFFFFFC000304FE030402FD00FBFE040105FEF9FF0003050200FEFBFFFF03030100F8030101FAFD0103FE0105FDFDFE03FF020301FEFD00FDFF00FFFFF503FEFFFA040301FD010002FB00010101040800FD0CFB03030000FF03FE000302FF03FD00FF05FAFE00FCFC02FF06FC02F90601F9FF010204FEFB00FF0102010202FCFF01F8FEFF03FE0203FF02000103FDFC04FE0705FF030403FE00FCFD040405FD050202FC00FD06F9FEFCFBFF01F70000FD00FA0007FE04FE01020402F8FF01FC0000FD0500020301FE05FDFB00FEF8FFFB000000FC020104FD040603FDFFFB06FF0601F800FEFFFF070400FB02000400FE040000FB0300FF0500000807FEFF00FDFF01FE03020100F9FE000108FA040203FA01FB03F900FAFC02010307"> : tensor<20x20xi8>
    return %0 : tensor<20x20xi8>
  }
}
