// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xui16>, tensor<20x20xui16>)
    %1 = call @expected() : () -> tensor<20x20xui16>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xui16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xui16>, tensor<20x20xui16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xui16>, tensor<20x20xui16>) {
    %0 = stablehlo.constant dense<"0x0000020002000500010000000800040003000200010003000300030004000000030001000100050000000300050000000000000001000000060000000000010003000300050001000100020001000500050000000400050007000800010003000600010005000100000002000400000000000100010000000300000000000300010005000000000000000000000005000200040002000000000002000100010000000100000001000000030004000300030000000100010002000000050002000300000000000200050000000200010001000000030004000200030001000200020000000200020002000200020001000100040000000100030001000400000000000300030001000000020003000100040001000200000002000000010003000100010002000000030000000200010003000400010002000100000005000000010002000800060003000100050001000000020002000000010004000200000004000700000000000000050003000200030004000100010002000300030004000100000002000300000005000100010005000000020003000200010000000100030000000200000005000400010004000000010006000100000000000000000001000200000002000000030000000200020002000100030002000300000003000000030003000100040001000600000000000200060001000100030003000300020003000000000001000000030002000100000001000000010002000100050002000100040003000100000000000900000002000200000002000000040003000000000000000400000001000400000000000100040001000200010002000200020000000200000001000000020001000200020005000100020002000100030002000100000001000400000002000000010003000400050001000200040001000300010002000000000001000000030000000500040003000400040006000000000001000000000002000300050001000000000004000400030000000000000000000100060005000200020000000200000003000000010001000100020001000300000000000000020004000100040001000000030000000000010000000000"> : tensor<20x20xui16>
    %1 = stablehlo.constant dense<"0x0400010001000000020000000000010002000700010000000000010000000100060001000300040000000000000002000100010000000000010003000000020001000200000007000100070004000200020004000300040000000800050000000500020000000200040003000000050000000400000001000000000006000200000000000400020000000500060002000100050002000000020002000400010001000100000001000300000002000100030005000500050002000200040000000300000002000000010000000200030002000300000001000300040000000700010001000300030002000000040003000000020003000400040001000200030004000000010003000500010002000300030001000100000002000100010000000300060002000000020003000200030001000600000004000200000001000600000001000100000000000000040005000100010003000000010007000300010001000100000000000300000001000200000000000100020005000100000005000200010000000200010001000000000001000000060001000000020002000000000000000100040001000000020001000200010002000100020003000400000001000300030002000000060001000200020001000000010002000500040001000000010001000100030002000000030002000400000001000000000005000100050002000300020002000100000003000200030004000000010004000200000001000000000001000000000003000000010000000100040000000100000002000200000004000000010001000200010000000600030002000400010000000600010003000000000004000300020003000300030004000100010000000300000000000100010000000200000000000400060003000300000001000300000002000200020003000000000000000500030000000200030002000100000000000100000001000200030002000000000003000300050000000400010004000400010001000000010002000300050000000400010002000100020002000600000000000000030002000000010000000000000003000100000000000300000002000000"> : tensor<20x20xui16>
    return %0, %1 : tensor<20x20xui16>, tensor<20x20xui16>
  }
  func.func private @expected() -> tensor<20x20xui16> {
    %0 = stablehlo.constant dense<"0xFCFF010001000500FFFF0000080003000100FBFF00000300030002000400FFFFFDFF0000FEFF0100000003000500FEFFFFFFFFFF010000000500FDFF0000FFFF020001000500FAFF0000FBFFFDFF03000300FCFF0100010007000000FCFF03000100FFFF0500FFFFFCFFFFFF0400FBFF0000FDFF0100FFFF03000000FAFF010001000500FCFFFEFF0000FBFFFAFF03000100FFFF00000000FEFF0000FDFF0000FFFF000000000000FDFF0300020002000000FBFFFCFFFCFF0000FEFF0100020000000000FEFF0200040000000000FEFFFFFFFDFF03000300FFFFFFFF0100FBFF0100FFFFFFFFFFFF00000200FEFFFEFF01000200FDFFFDFFFFFF00000200FDFFFCFF03000200FEFFFBFF01000100FEFF01000000010000000000FFFF00000300FEFFFBFF000000000100FDFF0000FEFF0200FEFF0100FEFFFFFF00000400FAFF0100010007000600030001000100FCFFFFFF0100FFFF00000000FDFFFFFFFFFF0300060000000000FDFF050002000000030004000000FFFFFDFF02000300FFFFFFFFFFFF02000100FFFF04000100010004000000FCFF02000200FFFFFEFF0100030000000100FCFF04000400FFFF0300FEFF000004000000FEFFFDFFFCFF00000000FFFFFDFF00000000FDFFFFFF000000000100010002000000FEFFFCFF020000000200020000000100FFFF0600FDFFFEFFFEFF0600000001000300FEFF0200FDFF0100FDFFFEFFFFFFFFFF0300FFFFFFFFFDFFFDFF00000000FEFFFFFF0500010001000400020001000000FDFF0900FFFF02000100FCFF0200FFFF04000100FEFF0000FCFF0400FFFF00000200FFFF0000FBFF0100FFFFFEFF00000200FCFF0100FDFF02000000FDFFFDFF0000FEFFFFFFFFFF0100000001000200FEFF030002000000FFFF0100020000000200FCFFFBFF0000010005000000FFFF0400FFFF0100FFFFFFFF000000000100FBFF00000000030001000100030004000600FFFF00000000FEFFFDFF000003000500FEFFFDFFFBFF040000000200FCFFFCFFFFFFFFFF010005000300FFFFFDFF0000FEFFFFFF0100FFFFFFFFFFFFFBFF020001000300FDFFFEFF00000100040001000400FEFFFFFF03000000FDFF0100FEFF0000"> : tensor<20x20xui16>
    return %0 : tensor<20x20xui16>
  }
}
