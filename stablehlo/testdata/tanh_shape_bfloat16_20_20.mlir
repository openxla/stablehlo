// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.tanh %0 : tensor<20x20xbf16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0x05C1ADBFB44082BF0C3E09C08FC0E1BF24406E4033405CC03DC01B4012407840AB40A23FDB3F26C0624056C01DC0C83F8E40B53FC73F663F2DC08D4019C08BC0B6BF0340FDBF9040BF3DF33ECBC006404FC0F5C0843F0FC00E408FBF713F913F4ABF30BFDFBF58BF4C3F5B409A3F0A40D43FEB3E58C087C034BF3CC06540B5BF2A3FE83D8240E5BFA1BE9740E33F31C09E402040FFBFCF3F5F40CDC015BF5C3FF2BFBF40C73FA7BFDFC0803F37409E3FA3BF4A4009BF844009408C3E563F813F254049C0884048C0FA3FDBC017C0753F2A40F33F0440BE3F8B400F3E6F40823E343F7EBF15408D3F573FA73F92C087BF9AC074405B40343F084068BF86C04BC071C0804031BF98402040FF3F4DBF5040BEBF0640A5BF05C00640B2C0FCBF064091401E3F98C06ABF68C08CBF313F69BF1FBFE2C0A3BF5ABF053F163FB33E31C014C04B3F3DBF26C0C4C033406F40AABC23C07D3FB33FA43E433D86C05AC0864053BF86C0993FB93F1DBF84408E3E95BF8EBFC1400340A7BF05C0B44016408D40C03ED2BF31C01340B43D79BF98404AC08AC0D040D54080C0F0C0EEBD2B40E23F644070C0733FEDBF95C02AC0C940F83F6AC0774008C014C06DC0363EAE40FE3EB4C006C021C06C40CF3E10BF3640AA40B1C05FBECFBE7340AAC088C033C0AF3F9F4022C0333F73BF1FC003C00EC018403940ED3F40C05640C0BF08BF69C0D43F47C009408740ADBF9F3FA4BF9040813F5440CEC0AD3F5A4011C096BF52C087C02CC041BF20C0C03F1BC0753F473F16BFD3C0A8BD28C0C7BF7C4003C0A040A73F1F3E643E4E40B1BF1FC04AC02CC09BC078401140CEC0E5BD953F8740BF3FBB3FBC3E4DBFDE3E76BF82BF6F3F1FC06C40D83F1740FE3FD83F2B40E1BE87BFF03FD5BFD2BE8F4028BF28BF7CC08CBD7C4055BF93404540564006C1BFBFFF3FD73E33C08CC087BE34409340D2BF4AC0703F15C08540C73D28C0B440094001BE553F003F483F4F40A5BF9BBF24BF4D4026C0D73F66408AC022C037BFC4C0F33E02C0D53F2EC0F83FDBBFB23F3A3EFB3F3CC01B40703F4340A440FE3EA8BFFB3F3C409640193F2E4022C07CBF194021BF66C019C0F2BC463FAF4042C096407F3FCD3E"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
  func.func private @expected() -> tensor<20x20xbf16> {
    %0 = stablehlo.constant dense<"0x80BF60BF803F45BF0B3E79BF80BF71BF7D3F803F7E3F7FBF7FBF7C3F7B3F803F803F5A3F703F7DBF803F7FBF7CBF6A3F803F633F6A3F373F7EBF803F7CBF80BF64BF783F76BF803FBE3DE23E80BF783F7FBF80BF463F7ABF7A3F4EBF3C3F503F28BF19BF71BF30BF2A3F7F3F563F793F6E3FDC3E7FBF80BF1BBF7FBF803F63BF153FE73D803F72BF9CBE803F723F7EBF803F7D3F77BF6D3F803F80BF06BF323F75BF803F6A3F5DBF80BF433F7E3F583F5BBF7F3FFBBE803F793F893E2F3F443F7D3F7FBF803F7FBF763F80BF7BBF3E3F7D3F753F783F673F803F0E3E803F7F3E1B3F42BF7B3F4D3F303F5D3F80BF49BF80BF803F7F3F1B3F793F38BF80BF7FBF80BF803F19BF803F7D3F773F2ABF7F3F67BF783F5CBF78BF783F80BF76BF783F803F0D3F80BF39BF80BF4CBF193F39BF0DBF80BF5BBF31BFF43E073FAC3E7EBF7BBF293F21BF7DBF80BF7E3F803FAABC7DBF423F633F9F3E433D80BF7FBF803F2DBF80BF553F653F0CBF803F8A3E53BF4EBF803F783F5DBF78BF803F7B3F803FB73E6DBF7EBF7B3FB43D40BF803F7FBF80BF803F803F80BF80BFEDBD7E3F713F803F80BF3D3F74BF80BF7DBF803F763F80BF803F79BF7BBF80BF343E803FEB3E80BF78BF7DBF803FC43E03BF7E3F803F80BF5CBEC4BE803F80BF80BF7EBF613F803F7DBF1B3F3DBF7CBF78BF7ABF7C3F7E3F743F7FBF7F3F68BFF9BE80BF6E3F7FBF793F803F60BF593F5BBF803F443F7F3F80BF603F7F3F7BBF53BF7FBF80BF7EBF23BF7DBF683F7CBF3E3F273F07BF80BFA8BD7DBF6ABF803F78BF803F5D3F1E3E603E7F3F62BF7CBF7FBF7EBF80BF803F7B3F80BFE4BD533F803F673F663FB43E2ABFD13E3FBF45BF3B3F7CBF803F6F3F7B3F773F6F3F7E3FD4BE49BF743F6EBFC7BE803F13BF13BF80BF8CBD803F2EBF803F7F3F7F3F80BF67BF773FCB3E7EBF80BF84BE7E3F803F6DBF7FBF3C3F7BBF803FC63D7DBF803F793F00BE2E3FED3E273F7F3F5CBF56BF11BF7F3F7DBF6F3F803F80BF7DBF1DBF80BFE23E77BF6E3F7EBF763F70BF623F383E763F7FBF7C3F3C3F7F3F803FEB3E5DBF763F7F3F803F093F7E3F7DBF41BF7C3F0FBF80BF7CBFF2BC263F803F7FBF803F433FC33E"> : tensor<20x20xbf16>
    return %0 : tensor<20x20xbf16>
  }
}
