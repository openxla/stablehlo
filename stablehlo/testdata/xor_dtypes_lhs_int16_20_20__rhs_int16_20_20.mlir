// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.xor %0#0, %0#1 : tensor<20x20xi16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xi16>, tensor<20x20xi16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xi16>, tensor<20x20xi16>) {
    %0 = stablehlo.constant dense<"0x0100FFFF0300FEFF0000FFFF0400030000000100FEFF0300000001000500FFFF0100FCFF0000FEFF0000FFFF0100FFFF0500040001000400020004000000FDFF04000000FBFF00000000050001000200FFFFFFFF000000000300FFFF00000200FDFFFFFF0300FEFF00000400FEFF00000000FFFF03000000FBFF02000100FBFFFBFF00000000FFFF030004000200FEFF000005000000FCFFFEFFFCFF020001000400FEFFFFFF0300FFFFFBFFFFFF000001000700FCFF0100000003000300FEFF040000000000000001000300FFFFFFFF000003000000FDFFFFFFFDFF0100000001000000FEFFFAFF0000FFFF010002000000FBFF01000000FCFFFEFF0000030000000000020000000000FEFF030001000400FDFFFEFF0200FFFF0500000002000000FFFF000003000200FFFF000001000400FBFFFFFF00000000FEFF03000000FDFFFBFFFEFFFFFFFBFF00000000020002000300FAFFFEFF00000000FFFFF8FF00000100FFFFFFFF0300FFFF00000500020001000200FFFF02000000FEFF000000000300050006000400020000000100FEFF0100030002000000FEFF0100FFFF040004000400000001000000FAFF01000000020000000000FFFF0100010003000000000000000500FCFF0100020000000000010000000100010003000300FDFF03000100FFFF00000000040000000300FFFF0100030001000000FFFF000002000400FEFFFFFF0000FDFF0400FEFFFFFF0000F7FFFEFFFFFF000000000500FDFF03000000020002000400FAFF000000000100FDFFFCFF000000000200FFFFFAFFFFFFFDFF02000100030003000300040002000100FCFF000004000000FAFFFBFF0000FCFF01000000FEFFFDFF0000FCFFFEFF03000000FCFF0100FCFF00000300FDFF000001000200FDFF0100FEFF00000300FEFF0000000004000100000000000100FDFFFDFF0300FEFF0000FFFFFFFFFFFFFEFF00000100FDFFFEFFFFFF0000FCFF0100000002000000FAFF0000030003000000FCFF0100020001000000000003000200050004000200FCFF0100FDFF0000FEFF020000000500FCFFFEFFFEFF0000FBFF0400FEFFFFFF02000000FDFF0100FBFF0000000000000400FEFFFFFF"> : tensor<20x20xi16>
    %1 = stablehlo.constant dense<"0xFFFF00000100FFFFFEFFFDFF0500FCFFFDFF00000100000002000100FDFF0000000002000100FBFF0000000003000300FAFF00000000FEFF0400FEFF00000200030000000300FFFF0100FFFFFAFFFFFF0000FCFF0000020002000000FCFF000000000000010004000000FFFF0600FEFF05000400FCFF02000000FEFFFCFF01000000FEFF0000FEFF000009000100FBFFFFFF000001000600FFFFFEFF0500FBFFFFFF0000000000000000000000000600060006000000FFFF02000000FFFFFEFF0000FFFF03000100FFFFFFFF0300FEFFFFFF0000FFFFFEFFFDFF0300FEFF0100000005000500FEFFFFFF010002000200FDFF0100FFFF020000000000FAFFFEFF0100FEFFFDFF0000FBFFFEFFFDFF000004000400070000000100FDFF01000500FFFF0200FCFF0300000001000000FAFF0200FDFF000000000200000002000000FFFF0000FFFF0300FFFFFCFF000001000100000003000000020000000000FEFFFCFFFDFF0300FCFFFFFF00000000FDFF0100FFFF00000000040000000500010003000000FEFF0100020002000A0001000000040005000200FFFF0100FCFF0600FFFF0000FFFF01000000FEFFFFFF0000FFFF00000400FFFFFCFF02000200F9FF02000100FFFF0100FFFF010004000200FEFF020003000300FEFFFEFFFFFFFEFF0000FEFF020004000000FAFF000000000000FDFFFDFF010002000000040002000000020002000200FAFFFAFF0000FEFF00000600FFFF0000FEFF0100FEFF0200FFFF020006000500FDFFFCFF01000200FFFF0200000000000000FFFFFFFF00000100030000000300FFFF0000FBFF0500FFFF03000200FEFFFBFF02000100FFFF0000000000000000FDFF0400FFFF0000FBFF010005000500FDFFFFFFFEFFFDFF0300FEFF0000FFFF0000FFFF0000FFFF00000300FFFFFDFFFEFF0000FDFF0200FEFF00000000FEFF03000300000005000100FDFF03000000010003000000FCFFFCFF000000000000FDFF000001000000060000000000FFFF040000000000FFFF03000000050000000100010006000300FEFF0200FEFFFAFF02000100FEFF010000000200030006000500FCFF0300FEFF0000FEFFFDFF03000100020007000200"> : tensor<20x20xi16>
    return %0, %1 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> tensor<20x20xi16> {
    %0 = stablehlo.constant dense<"0xFEFFFFFF02000100FEFF02000100FFFFFDFF0100FFFF030002000000F8FFFFFF0100FEFF010005000000FFFF0200FCFFFFFF04000100FAFF0600FAFF0000FFFF07000000F8FFFFFF0100FAFFFBFFFDFFFFFF0300000002000100FFFFFCFF0200FDFFFFFF0200FAFF0000FBFFF8FFFEFF0500FBFFFFFF0200FBFFFCFFFDFFFAFFFBFFFEFF0000010003000D0003000500FFFF05000100FAFF010002000700FAFFFBFFFEFFFFFF0300FFFFFBFFFFFF060007000100FCFFFEFF02000300FCFF00000400FFFF03000100FEFFFCFFFCFF0100FFFF0300FFFF03000200FEFFFFFF010001000500FBFF0400FFFFFEFF03000000FDFFFAFFFEFF0200FCFFFEFFFAFFFDFF0100FEFFFFFF0000FBFF0000FEFF01000000F9FFF9FF0200FEFFF8FF01000700FFFFFDFFFCFF00000200FEFF0000FBFF06000600FFFF00000200FEFF010000000200FBFF0100FCFF0400FCFF0000030003000300F9FFFEFF02000000FFFF0600FCFFFCFFFCFF0300FCFFFFFF0000F8FF0300FEFF0200FFFF06000000FBFF010003000300FBFF0700060000000A000000FEFF050006000000FFFFFFFFFDFFF9FFFBFF0400FBFF01000100FEFF05000100FFFF02000400FFFF030003000300FAFF02000100FFFF04000300000006000200FEFF030003000200FFFFFDFFFCFF03000300FFFFFDFF04000000FEFF00000300FFFFFCFFFEFF00000200FFFF040000000400FCFFFDFF02000700FEFFFEFF01000000F1FF0100FFFFFEFF0100FBFFFFFFFCFF020004000700F9FF060001000200FEFFFFFFFCFF00000000FDFF0000FAFFFEFFFEFF02000200FCFF0300F8FF0100FDFF0200FEFFFEFFFFFF0200FBFF04000000FCFF010000000300F9FFFFFFFCFF050002000500F9FFFCFF0300FEFFFEFFFEFFFEFF0100FDFFFDFFFEFFFEFFFFFF0300FDFFFFFFFDFFFAFF0100FDFF0200FFFFFDFFFDFFFDFFFDFF0300FFFFFAFFFEFF030003000100FCFFFDFFFFFFFCFF0000010000000200FDFFFAFF0100030005000000FCFFFEFF060001000000FFFF00000200000004000300FDFF0700FEFFFEFFFCFFFCFFFAFF0700FDFF0000FFFF0000F9FF0700F8FFFAFFFEFF0300030001000500FDFF030001000600F9FFFDFF"> : tensor<20x20xi16>
    return %0 : tensor<20x20xi16>
  }
}
