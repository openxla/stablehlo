// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xui16>, tensor<20x20xui16>)
    %1 = call @expected() : () -> tensor<20x20xui16>
    %2 = stablehlo.xor %0#0, %0#1 : tensor<20x20xui16>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xui16>, tensor<20x20xui16>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xui16>, tensor<20x20xui16>) {
    %0 = stablehlo.constant dense<"0x0000000004000100050003000300000001000700030001000400000000000100000000000400030007000300020002000400000004000100020002000200040000000100010007000100060000000400040003000200000001000200000003000200010000000000000003000100020001000300020002000000020004000700020001000100010002000100000002000000020003000000000004000400010002000000000002000100000002000400000004000200040005000100010001000300000008000500000000000100000000000600050000000100000001000000010003000200030000000000030000000000000002000100000001000200020001000000000002000000000002000800030002000000030006000200000003000100020008000100010001000300000003000000020001000700000001000000030000000000020002000000060001000100070005000000000000000000030002000300000004000200010001000000000004000500030002000000010001000100000002000000010003000600020004000500010001000500000000000300010000000000020001000000000001000100000003000300030005000000010001000200000006000000010004000000030002000300000000000100010000000400000001000000010002000300000000000800010006000200010002000000010001000300020002000100030000000000030001000100040001000200040000000300000002000000030000000000010001000300010001000B00030007000100020000000100050003000000030006000000030001000000020001000000030000000200050002000100010008000100010000000100020002000300010000000300030006000200040004000000020005000000030000000000000005000100000000000100010001000300050001000300020000000100000009000000020000000100000003000100010003000000030004000100020000000500020004000200010001000400000001000200040002000400010003000000020000000700040002000100020000000000020002000200020002000000010001000100"> : tensor<20x20xui16>
    %1 = stablehlo.constant dense<"0x0100050003000600060002000000010002000500000004000000010001000200040001000300000000000100000000000200030002000000030000000100020000000100060002000200010001000200010002000400010000000000020005000100000003000600000003000300000002000300030000000200000002000000000004000100020001000100050003000400010005000300030000000200010000000100000003000000030002000400020003000100050007000100010000000100000000000000060000000400000001000000000000000500000006000000050000000200040002000300050004000200010000000300060000000100070000000600020003000100020002000100050004000500010004000100020002000400010003000300030003000000010000000200000001000100010005000500030001000200000001000100020000000300070004000300000002000200030000000200020000000600030003000000030008000100020003000100010005000000040000000000020000000000000003000200000001000400000000000000030000000300010005000000040005000400000001000400020001000100030007000000000000000100000003000400010001000200040005000000010002000100000004000600010003000000020001000300000000000000020003000200020002000300050001000100030001000000010008000100000004000200000005000300020002000100010004000100010000000400020003000200040003000300010000000200000001000000030002000300010000000200030002000100040002000300020000000300030003000400000001000100010001000400020003000600040000000300010000000100000000000000030008000000010000000300060000000200030002000300020000000200030003000400000002000200000000000000000002000000000000000300030000000100000000000000000001000500000000000100000008000000020002000000060000000100020002000300010002000700040000000000010007000400000002000000050002000300"> : tensor<20x20xui16>
    return %0, %1 : tensor<20x20xui16>, tensor<20x20xui16>
  }
  func.func private @expected() -> tensor<20x20xui16> {
    %0 = stablehlo.constant dense<"0x010005000700070003000100030001000300020003000500040001000100030004000100070003000700020002000200060003000600010001000200030006000000000007000500030007000100060005000100060001000100020002000600030001000300060000000000020002000300000001000200020002000600070002000500000003000300000005000100040003000600030003000400060000000200010000000100010003000000000002000700030001000200000000000100020000000800050006000000050000000100060005000000040000000700000004000300000007000200030006000400020001000200020006000100030005000100060002000100010002000000090006000600050002000200030002000100050003000B00020002000200030001000300020002000000060001000400050000000100020002000300010004000100020000000100030000000200020000000200010002000400040002000200000003000C000400010001000100000004000100040002000000030003000600020007000700010000000100000000000300020000000300030004000000040004000500000002000700010004000100020006000200000006000100010007000400020003000100040005000100000002000500000005000600000001000300020001000B0001000600020003000100020003000300000007000300000000000100000002000900000004000500000004000500000002000000010002000400010000000100070003000200090007000400020003000000030005000200000000000400030002000100020001000300010007000200010007000200020002000B00050001000100000003000300070003000300050007000600010005000400010002000500000000000800000001000500020006000000030002000300000007000100010001000300050000000B000200020000000100000001000100010003000300000004000000020000000500020005000700010001000500000009000200060000000400070003000100000002000400050000000600060000000000030005000600020000000000040003000200"> : tensor<20x20xui16>
    return %0 : tensor<20x20xui16>
  }
}
