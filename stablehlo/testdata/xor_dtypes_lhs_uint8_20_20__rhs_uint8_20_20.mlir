// RUN: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0:2 = call @inputs() : () -> (tensor<20x20xui8>, tensor<20x20xui8>)
    %1 = call @expected() : () -> tensor<20x20xui8>
    %2 = stablehlo.xor %0#0, %0#1 : tensor<20x20xui8>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xui8>, tensor<20x20xui8>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> (tensor<20x20xui8>, tensor<20x20xui8>) {
    %0 = stablehlo.constant dense<"0x03010100040300010401000100010400010104020203070003070200010300020101000200000100040202010204030108000202000000030202010301000102000003000003000101020405030101000101070104010100030004010600010201010200040403010104000203000301020101000200010200000101000001000006020308010101020503000101000201010901010102010200010405040102020004000201050100020000060401020000040004000405000003010200000600020102010002030402010400020004020103020000030103000102000101010200000101000300040001010205040203000201000102000203020301040200030002030001020304040102000006030601010001000204000003020001080203020400020501020101030006000101010104000203040003010001020000050100020406030205020305030002000101000001050104010106020103000100020001030101010002020201010101020301030205010002020100010200000005050304020004010504010100050300"> : tensor<20x20xui8>
    %1 = stablehlo.constant dense<"0x0101000104010204000100020004010004050201010302030102010503020000020700040104020102010202010100000504030400000702040103000200010003020000030100010200010206000002030001030101070700080003020403010100020203040402040202000100010000030000040001040101010200010300000000000801010503040302010001000404010000010403010400030205020001020303000302010501040605010006010102000200040204000702040102020301030702030100020202010200030001000102010404010003020202010205010400010001050601000400030003020302010001000900020400010103050000030200020300000608020302010200010203000505020401000103020100020001000201030102010200020400000203000400000103060300000304020301010600030202030100010004010202010601000A050201000200000200080101010100020300000403010405010102000005020201010104000203030004020101030303000205020102000106000106"> : tensor<20x20xui8>
    return %0, %1 : tensor<20x20xui8>, tensor<20x20xui8>
  }
  func.func private @expected() -> tensor<20x20xui8> {
    %0 = stablehlo.constant dense<"0x0200010100020205040000030005050005040603030005030205030502010002030600060104030106030003030503010D04010600000701060302030300000203020300030200000302050705010102020106020500060703080402040402030001000207000703050602020200020102020100060000060101000300010200000602030000000401010002000101020505080101000602030401070701030203020703020207000503040603050104010106000600000704000403060102040303020503030303060003050202030403010200010407000303030002000304030400000101060605000501010507000002030101010B0000070202000707000303000302020203020C030102010403070302000405000001000201020008000303040203060000000303020200010302010000020207060001000206020304000602070401010402020507010002000701000B000305010306020303080001030101010201010401030604000003020304010004000106020303020204020104060007020201030406010006050206"> : tensor<20x20xui8>
    return %0 : tensor<20x20xui8>
  }
}
